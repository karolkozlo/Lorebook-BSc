(function(e){function t(t){for(var s,r,o=t[0],c=t[1],l=t[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(s=!1)}s&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},i={app:0},a=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0b1d":function(e,t,n){"use strict";n("dab6")},"0b9d":function(e,t,n){e.exports=n.p+"img/manage-content-element-2.d457ed06.jpg"},"10f6":function(e,t,n){"use strict";n("4430")},1417:function(e,t,n){"use strict";n("c922")},1484:function(e,t,n){},"1cd1":function(e,t,n){},"1d2a":function(e,t,n){"use strict";n("683a")},"1d96":function(e,t,n){},2155:function(e,t,n){"use strict";n("f7bb")},"23b8":function(e,t,n){},2400:function(e,t,n){},"296d":function(e,t,n){},"29ed":function(e,t,n){"use strict";n("5fd2")},"2a18":function(e,t,n){"use strict";n("d541")},"2d83":function(e,t,n){},3319:function(e,t,n){"use strict";n("5d4e")},"33a6":function(e,t,n){},3402:function(e,t,n){},3772:function(e,t,n){},"391b":function(e,t,n){},"3a5a":function(e,t,n){},"3bdf":function(e,t,n){},"3eb9":function(e,t,n){"use strict";n("9f73")},"3edc":function(e,t,n){"use strict";n("6dd5")},"402b":function(e,t,n){"use strict";n("cbeb")},4192:function(e,t,n){},"41f7":function(e,t,n){"use strict";n("3772")},"435e":function(e,t,n){},"43d5":function(e,t,n){"use strict";n("cfb0")},"43ef":function(e,t,n){e.exports=n.p+"img/manage-content-element-1.f0e21097.jpg"},4430:function(e,t,n){},"44c8":function(e,t,n){},"456c":function(e,t,n){"use strict";n("720d")},4650:function(e,t,n){},"4ac7":function(e,t,n){},"4f4f":function(e,t,n){"use strict";n("5856")},5014:function(e,t,n){"use strict";n("a3a9")},"507f":function(e,t,n){},5376:function(e,t,n){"use strict";n("507f")},"56d7":function(e,t,n){"use strict";n.r(t);var s=n("7a23");const i={class:"main__content"};function a(e,t,n,a,r,o){const c=Object(s["J"])("lb-header"),l=Object(s["J"])("lb-toast"),u=Object(s["J"])("router-view");return Object(s["D"])(),Object(s["j"])("main",null,[Object(s["n"])(c),Object(s["k"])("div",i,[Object(s["n"])(l,{type:e.notificationType,message:e.notificationMessage,isOpen:e.isNotificationOpen,onClose:e.closeNotification},null,8,["type","message","isOpen","onClose"]),Object(s["n"])(u)])])}const r={class:"lb-header"},o={class:"lb-header__nav"},c={class:"lb-header__nav-left"},l={class:"lb-header__nav-center"},u={class:"lb-header__nav-right"},d={class:"lb-header__account-text"};function p(e,t,n,i,a,p){const b=Object(s["J"])("router-link"),h=Object(s["J"])("router-view"),m=Object(s["J"])("icon"),g=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("header",r,[Object(s["k"])("nav",o,[Object(s["k"])("div",c,[Object(s["n"])(b,{class:"lb-header__link lb-header__link--main",to:"/"},{default:Object(s["T"])(()=>[Object(s["m"])("Lorebook")]),_:1})]),Object(s["k"])("div",l,[Object(s["n"])(h,{name:"header"})]),Object(s["k"])("div",u,[Object(s["n"])(b,{class:"lb-header__link lb-header__link--account",to:p.setLink},{default:Object(s["T"])(()=>[Object(s["k"])("span",d,Object(s["M"])(p.setAccountLinkText),1),Object(s["n"])(m,{icon:"lb-user",size:1.5},null,8,["size"])]),_:1},8,["to"]),this.username?(Object(s["D"])(),Object(s["h"])(g,{key:0,icon:"lb-logout",size:1.5,onClick:p.logOut},null,8,["size","onClick"])):Object(s["i"])("",!0)])])])}var b=n("5502"),h=n("bc3a"),m=n.n(h);const g={production:"https://lorebook-server-j28lc.ondigitalocean.app/api",development:"http://localhost:8080/api"},O=m.a.create({baseURL:g["production"]?g["production"]:g.development,timeout:5e3,withCredentials:!0});var v=O;const j=async(e,t)=>{const n=await v.post("/login",{name:e,password:t}).then(e=>e.data).catch(e=>{throw e.response?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")});return n};async function y(){return await v.get("/logout").then(()=>!0).catch(e=>{throw e.response?new Error(""+e.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}const f=async()=>{const e=await v.get("/refreshToken").then(e=>e.data).catch(()=>{});return e};var _={name:"LbHeader",computed:{...Object(b["c"])(["username"]),setAccountLinkText(){return this.username?this.username:"Log In"},setLink(){return this.username?"/user":"/login"}},methods:{...Object(b["d"])(["clearUser"]),...Object(b["d"])("universe",["clearUserUniverses","clearUniverse"]),async logOut(){try{await y()}catch(err){console.error(err.message)}finally{this.clearUser(),this.clearUserUniverses(),this.clearUniverse(),this.$router.push("/login")}}}},k=(n("a2e7"),n("6b0d")),w=n.n(k);const D=w()(_,[["render",p]]);var C=D;const E={class:"lb-toast__message"};function L(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["h"])(s["d"],{name:"toast"},{default:Object(s["T"])(()=>[n.isOpen?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:Object(s["w"])(["lb-toast",r.setTypeClass])},[Object(s["n"])(o,{class:"lb-toast__close-button",icon:"lb-cancel-circled",size:1.2,onClick:t[0]||(t[0]=t=>e.$emit("close"))},null,8,["size"]),Object(s["k"])("span",E,Object(s["M"])(n.message),1)],2)):Object(s["i"])("",!0)]),_:1})}var I={name:"LbToast",emits:["close"],props:{message:{type:String,default:""},type:{type:String,validator(e){return"positive"===e||"negative"===e||""===e}},isOpen:{type:Boolean,default:!1}},computed:{setTypeClass(){return"lb-toast--"+this.type}}};n("4f4f");const x=w()(I,[["render",L]]);var P=x,S={name:"App",components:{LbHeader:C,LbToast:P},computed:{...Object(b["c"])("notifications",["isNotificationOpen","notificationMessage","notificationType"])},methods:{...Object(b["d"])(["setUser"]),...Object(b["d"])("notifications",["closeNotification"])}};n("b649");const T=w()(S,[["render",a]]);var N=T,U=n("6605");const z={namespaced:!0,state(){return{isNotificationOpen:!1,notificationType:"",message:""}},mutations:{notify(e,t){e.notificationType=t.type,e.message=t.message,e.isNotificationOpen=!0},closeNotification(e){e.notificationType="",e.message="",e.isNotificationOpen=!1}},getters:{isNotificationOpen(e){return e.isNotificationOpen},notificationMessage(e){return e.message},notificationType(e){return e.notificationType}}};var $=z;async function J(e){return await v.get("/universes/user/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function M(e){return await v.get("/universes/user/list/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function q({name:e,description:t,userID:n}){return await v.post("/universes",{name:e,description:t,userID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function B(e){return await v.delete("/universes/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function R(e){return await v.get("/universes/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function V(e,t){return await v.patch("/universes/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}const G={namespaced:!0,state(){return{universeID:null,universeName:null,userUniverses:[],universesFetchedFlag:!1}},getters:{universeID(e){return e.universeID},universeName(e){return e.universeName},userUniverses(e){return e.userUniverses},checkIfUserOwnsUniverse:e=>t=>e.userUniverses.find(e=>e.id==t.universeID),universesFetchedFlag(e){return e.universesFetchedFlag}},mutations:{setUniverse(e,t){e.universeID=t.id,e.universeName=t.name},setUniverseName(e,t){e.universeName=t},clearUniverse(e){e.universeID=null,e.universeName=null,e.categories=[]},setUserUniverses(e,t){e.userUniverses=t},setUniversesFetchedFlag(e,t){e.universesFetchedFlag=t},pushUserUniverse(e,t){e.userUniverses.push(t)},removerUserUniverse(e,t){e.userUniverses=e.userUniverses.filter(e=>e.id!==t)},clearUserUniverses(e){e.userUniverses=[]}},actions:{async fetchUserUniverses(e){try{if(e.rootGetters.userID){const t=await J(e.rootGetters.userID);e.commit("setUserUniverses",t),e.commit("setUniversesFetchedFlag",!0)}}catch(t){e.commit("notifications/notify",{type:"negative",message:""+t.message},{root:!0})}}}};var F=G;const A={namespaced:!0,state(){return{isCategoriesPopupOpen:!1,isUniverseElementPopupOpen:!1,isLinkPopupOpen:!1,isTagsPopupOpen:!1}},getters:{isCategoriesPopupOpen(e){return e.isCategoriesPopupOpen},isUniverseElementPopupOpen(e){return e.isUniverseElementPopupOpen},isLinkPopupOpen(e){return e.isLinkPopupOpen},isTagsPopupOpen(e){return e.isTagsPopupOpen}},mutations:{openCategoriesPopup(e){e.isCategoriesPopupOpen=!0},closeCategoriesPopup(e){e.isCategoriesPopupOpen=!1},openUniverseElementPopup(e){e.isUniverseElementPopupOpen=!0},closeUniverseElementPopup(e){e.isUniverseElementPopupOpen=!1},openLinkPopup(e){e.isLinkPopupOpen=!0},closeLinkPopup(e){e.isLinkPopupOpen=!1},openTagsPopup(e){e.isTagsPopupOpen=!0},closeTagsPopup(e){e.isTagsPopupOpen=!1}}};var H=A;const Y={text:"TEXT",list:"LIST",imageGroup:"IMAGE_GROUP",linkGroup:"LINK_GROUP"};var K=Y;const W={namespaced:!0,state(){return{contentElements:[],contentID:null}},getters:{contentElements(e){return e.contentElements},contentID(e){return e.contentID},config(e){return e.contentElements.map(e=>({id:e.id,type:e.type}))},getElementById:e=>(t,n)=>e.contentElements.find(e=>e.id==t&&e.type==n),getListItemById:e=>(t,n)=>{const s=e.contentElements.find(e=>e.id==t&&e.type==K.list);return s?s.items.find(e=>e.id==n):null},getListItemByOrder:e=>(t,n)=>{const s=e.contentElements.find(e=>e.id==t&&e.type==K.list);return s?s.items.find(e=>e.ordinalNumber==n):null},getLinkById:e=>(t,n)=>{const s=e.contentElements.find(e=>e.id==t&&e.type==K.linkGroup);return s?s.links.find(e=>e.id==n):null}},mutations:{clearContent(e){e.contentElements=[],e.contentID=null},setContent(e,t){e.contentElements=t},setContentID(e,t){e.contentID=t},removeContentElement(e,t){e.contentElements=e.contentElements.filter(e=>!(e.id==t.id&&e.type==t.type))}}};var Q=W;const X=Object(b["a"])({modules:{notifications:$,universe:F,popups:H,element:Q},state:{userID:null,username:null,email:null,isAuth:!1,tokenRefreshedFlag:!1},getters:{userID(e){return e.userID},username(e){return e.username},email(e){return e.email},isAuth(e){return e.isAuth},tokenRefreshedFlag(e){return e.tokenRefreshedFlag}},mutations:{setTokenRefreshedFlag(e,t){e.tokenRefreshedFlag=t},setUser(e,t){e.userID=t.id,e.username=t.name,e.email=t.email,e.isAuth=!0},clearUser(e){e.userID=null,e.username=null,e.email=null,e.isAuth=!1}},actions:{}});var Z=X,ee=n("a674"),te=n.n(ee),ne=n("b34f"),se=n.n(ne),ie=n("43ef"),ae=n.n(ie),re=n("0b9d"),oe=n.n(re),ce=n("c178"),le=n.n(ce);const ue={class:"main-page"},de={class:"main-page__content"},pe=Object(s["l"])('<div class="main-page__section"><h2 class="main-page__section-title"> What is Lorebook? </h2><div class="util__horizontal-line--black"></div><div class="main-page__section-content"><p class="main-page__paragraph"> Lorebook is an application designed to help writers create their own universes for books, movies, games etc. Creating an entire world can be a very difficult task that requires the collection of a lot of different information. Each universe can consist of many different elements belonging to different categories. These elements are often strongly connected with each other (e.g. locations with events or characters). Keeping all this information in plain text files and documents would be very inefficient for larger projects. It would be hard to maintain relationships between items. </p><p class="main-page__paragraph"> Lorebook is an application that will allow users to save all relevant items in a well-organized database. It allows you to create any elements, describe them, put them in appropriate categories and create connections between them. With Lorebook, you can also create your own stories in your universes. </p></div></div><div class="main-page__section"><h2 class="main-page__section-title"> What features does Lorebook offer? </h2><div class="util__horizontal-line--black"></div><div class="main-page__section-content"><ul class="main-page__ulist"><li class="main-page__ulist-item"> Create your own universes </li><li class="main-page__ulist-item"> Create characters </li><li class="main-page__ulist-item"> Create locations in hierarchy (city in country, country on a continent... etc.) </li><li class="main-page__ulist-item"> Create events with dates </li><li class="main-page__ulist-item"> Create your own element categories (eg: creatures, religions, items, magic systems) </li><li class="main-page__ulist-item"> Describe elements with texts, lists, links etc. on their pages </li><li class="main-page__ulist-item"> Tagging elements in a universe </li><li class="main-page__ulist-item"> Searching all elements created in universe </li><li class="main-page__ulist-item"> Write your stories with use of rich text editor </li><li class="main-page__ulist-item"> Use links to maintain relations between elements </li></ul></div></div><div class="main-page__section"><h2 class="main-page__section-title"> What new features will come in the future? </h2><div class="util__horizontal-line--black"></div><div class="main-page__section-content"><ul class="main-page__ulist"><li class="main-page__ulist-item"> Interactive maps with layers for locations </li><li class="main-page__ulist-item"> Images in content of universe elements </li><li class="main-page__ulist-item"> Character relations page (relations will be displayed as lists and graphs) </li><li class="main-page__ulist-item"> Timelines for events </li><li class="main-page__ulist-item"> Information about all links connected to a specific universe element </li><li class="main-page__ulist-item"> Tree view for hierarchy of locations </li><li class="main-page__ulist-item"> Support for other languages </li><li class="main-page__ulist-item"> Upgrade for rich text editor </li></ul></div></div>',3),be={class:"main-page__section"},he=Object(s["k"])("h2",{class:"main-page__section-title"}," Instructions ",-1),me=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),ge={class:"main-page__section-content main-page__section-content--instructions"},Oe=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Log In to your account "),Object(s["k"])("li",{class:"answer__olist-item"}," Go to user page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create New Universe" button '),Object(s["k"])("li",{class:"answer__olist-item"}," Enter title to input (description is optional) "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create" button '),Object(s["k"])("li",{class:"answer__olist-item"}," You should see newly created universe on list of Your Universes on User Page ")])],-1),ve=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Move your cursor over the title or description "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["m"])(" If you see this half-transparent, blurred background, it means, that this text is editable. "),Object(s["k"])("img",{src:te.a})]),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("strong",null,"Double Click on this text."),Object(s["m"])(" You will enter in edit mode for this text. You can change the text. "),Object(s["k"])("img",{src:se.a})]),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to save the text, click on green button or use Ctrl+S shortcut. "),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to cancel changes, click on red button. ")])],-1),je=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Creating new category "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Manage Categories" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Enter the name into input (Name should be unique to the universe) "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Add new category" button. Now you should be able to use new category ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," Changing category name "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Manage Categories" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Click edit button next to category name. You will enter in edit mode for this category. "),Object(s["k"])("li",{class:"answer__olist-item"},' Change text in "Name" field, then click "Rename" button ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," Deleting category "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Manage Categories" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Click red remove button next to category name, then confirm action. ")])],-1),ye=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create Element" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Enter title for new element (description is optional) "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["m"])(" Select type (category) of new element "),Object(s["k"])("ul",{class:"answer__sublist"},[Object(s["k"])("li",{class:"answer__sublist-item"},' If type is "Locations", you can choose parent location. '),Object(s["k"])("li",{class:"answer__sublist-item"},' If type is "Events", you should set date. ')])]),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create Element" button ')])],-1),fe=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," How to create new content element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the Universe Element Page "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("div",{class:"answer__olist-item-content"},[Object(s["k"])("span",null,"Click button for adding new content elements"),Object(s["k"])("img",{src:ae.a})])]),Object(s["k"])("li",{class:"answer__olist-item"}," Click on type of content element you want to create ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," How to move content element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the Universe Element Page "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("div",{class:"answer__olist-item-content"},[Object(s["k"])("span",null,"Move cursor over the content element. You will see new buttons on the right"),Object(s["k"])("img",{src:oe.a})])]),Object(s["k"])("li",{class:"answer__olist-item"}," Click on available chosen button ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," How to delete content element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Move cursor over the content element "),Object(s["k"])("li",{class:"answer__olist-item"}," Click on red delete button with trash icon ")])],-1),_e=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Search" button in top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Write text to search bar (optional) "),Object(s["k"])("li",{class:"answer__olist-item"}," Choose one or more categories in select (optional) "),Object(s["k"])("li",{class:"answer__olist-item"}," Add some tags (optional) "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("div",{class:"answer__olist-item-content"},[Object(s["k"])("span",null,"Click search button with magnifier icon (next to search bar)"),Object(s["k"])("img",{src:le.a})])])])],-1),ke=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Create link in content of universe element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe element page "),Object(s["k"])("li",{class:"answer__olist-item"},' Create "Link Group" in content, if you don\'t have one '),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Add new link" button in link group. It will open popup '),Object(s["k"])("li",{class:"answer__olist-item"},' Follow next steps in "How to use popup to create link?" ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," Create link in story chapter "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the chapter page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Add new link" button on left side panel. It will open popup. '),Object(s["k"])("li",{class:"answer__olist-item"},' Follow next steps in "How to use popup to create link?" ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," How to use popup to create link? "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Select type (category) of the element to be linked "),Object(s["k"])("li",{class:"answer__olist-item"}," You will see search bar and list of elements belonging to selected category "),Object(s["k"])("li",{class:"answer__olist-item"}," Click on list item to select it. "),Object(s["k"])("li",{class:"answer__olist-item"}," Write description (optional) "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create link" button ')])],-1),we=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Adding new tags "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to universe element page "),Object(s["k"])("li",{class:"answer__olist-item"}," You can see tag section in left side panel. Enter text to bottom input, next to green plus button "),Object(s["k"])("li",{class:"answer__olist-item"}," Click green plus button to add tag ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," Managing used tags in universe "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Tags" button in top navigation. It will open popup '),Object(s["k"])("li",{class:"answer__olist-item"}," You can see list of all tags used in Universe. You can search them with use of search bar. "),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to delete existing tag, click red button with trash icon next to tag name "),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to edit extisting tag, click blue edit button. You will enter edit mode. "),Object(s["k"])("li",{class:"answer__olist-item"},' Change name in the input, then click "Rename Tag" button ')])],-1),De=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Create Story "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to universe main page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Stories" button (next to "Elements" button) '),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create new Story" button. It will open popup for you '),Object(s["k"])("li",{class:"answer__olist-item"},' Enter the title and descripton, then click "Create" button '),Object(s["k"])("li",{class:"answer__olist-item"}," Popup will close. You will see your story in the list. Click on name to enter the story page ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," Create Chapter "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to story page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create new Chapter" button. It will open popup for you '),Object(s["k"])("li",{class:"answer__olist-item"},' Enter the title and descripton, then click "Create" button '),Object(s["k"])("li",{class:"answer__olist-item"}," Popup will close. You will see your chapter in the list. Click on name to enter the story page. You can change order of chapter with arrow buttons. ")])],-1);function Ce(e,t,n,i,a,r){const o=Object(s["J"])("lb-accordion");return Object(s["D"])(),Object(s["j"])("div",ue,[Object(s["k"])("div",de,[pe,Object(s["k"])("div",be,[he,me,Object(s["k"])("div",ge,[Object(s["n"])(o,{title:"How to create universe?"},{default:Object(s["T"])(()=>[Oe]),_:1}),Object(s["n"])(o,{title:"How to edit titles and descriptions of universe, stories, chapters and universe elements?"},{default:Object(s["T"])(()=>[ve]),_:1}),Object(s["n"])(o,{title:"How to create and manage new categories?"},{default:Object(s["T"])(()=>[je]),_:1}),Object(s["n"])(o,{title:"How to create new elements?"},{default:Object(s["T"])(()=>[ye]),_:1}),Object(s["n"])(o,{title:"How to manage content items of Universe Elements?"},{default:Object(s["T"])(()=>[fe]),_:1}),Object(s["n"])(o,{title:"How to search universe elements?"},{default:Object(s["T"])(()=>[_e]),_:1}),Object(s["n"])(o,{title:"How to create links to universe elements?"},{default:Object(s["T"])(()=>[ke]),_:1}),Object(s["n"])(o,{title:"How to manage tags in universe?"},{default:Object(s["T"])(()=>[we]),_:1}),Object(s["n"])(o,{title:"How to create stories and chapters?"},{default:Object(s["T"])(()=>[De]),_:1})])])])])}const Ee={class:"lb-accordion"},Le={class:"lb-accordion__activator"},Ie={class:"lb-accordion__activator-right"},xe={key:0,class:"lb-accordion__activator-subtext"},Pe={key:0,class:"lb-accordion__content"};function Se(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",Ee,[Object(s["k"])("div",Le,[n.isTitleEditable?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("h3",{key:0,class:"lb-accordion__title lb-accordion__title--static",onClick:t[0]||(t[0]=(...e)=>r.toggleContent&&r.toggleContent(...e))},Object(s["M"])(n.title),1)),n.isTitleEditable?(Object(s["D"])(),Object(s["h"])(o,{key:1,value:n.title,width:"100%",onOnSave:r.changeTitle,maxLength:n.maxLength,customClass:"lb-accordion__title lb-accordion__title--editable"},null,8,["value","onOnSave","maxLength"])):Object(s["i"])("",!0),Object(s["k"])("div",Ie,[n.subtext?(Object(s["D"])(),Object(s["j"])("span",xe,Object(s["M"])(n.subtext),1)):Object(s["i"])("",!0),Object(s["k"])("div",{class:"lb-accordion__activator-button",onClick:t[1]||(t[1]=(...e)=>r.toggleContent&&r.toggleContent(...e))},[Object(s["n"])(c,{icon:r.toggleButtonIcon,size:2},null,8,["icon"])])])]),a.isOpen?(Object(s["D"])(),Object(s["j"])("div",Pe,[Object(s["I"])(e.$slots,"default")])):Object(s["i"])("",!0)])}const Te={class:"lb-editable-text"},Ne={key:0,class:"lb-editable-text__cancel-button"},Ue=["maxlength"],ze=["maxlength"],$e={key:2,class:"lb-editable-text__save-button"};function Je(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",Te,[Object(s["k"])("div",{class:Object(s["w"])(["lb-editable-text__content",n.customClass]),style:Object(s["x"])(r.setWidth)},[a.active?(Object(s["D"])(),Object(s["j"])("div",Ne,[Object(s["n"])(o,{icon:"lb-cancel-circled",size:1.22,onClick:r.deactivate},null,8,["size","onClick"])])):Object(s["i"])("",!0),a.active?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("pre",{key:1,class:Object(s["w"])(["lb-editable-text__text",r.textClass]),onDblclick:t[0]||(t[0]=(...e)=>r.activate&&r.activate(...e))},Object(s["M"])(n.value?n.value:n.noContent),35)),Object(s["U"])(Object(s["k"])("input",{class:"lb-editable-text__input",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.editedValue=e),maxlength:n.maxLength,ref:"input",onKeydown:t[2]||(t[2]=Object(s["V"])((...e)=>r.saveWithShortcut&&r.saveWithShortcut(...e),["ctrl","stop"]))},null,40,Ue),[[s["Q"],a.active&&"input"==n.type],[s["P"],a.editedValue]]),Object(s["U"])(Object(s["k"])("textarea",{class:"lb-editable-text__input","onUpdate:modelValue":t[3]||(t[3]=e=>a.editedValue=e),maxlength:n.maxLength,ref:"textarea",style:Object(s["x"])(`min-height: ${n.minHeight}px;`),onKeydown:t[4]||(t[4]=Object(s["V"])((...e)=>r.saveWithShortcut&&r.saveWithShortcut(...e),["ctrl","stop"]))},null,44,ze),[[s["Q"],a.active&&"textarea"==n.type],[s["P"],a.editedValue]]),a.active?(Object(s["D"])(),Object(s["j"])("div",$e,[Object(s["n"])(o,{icon:"lb-ok-circle-fill",size:1.22,onClick:r.save},null,8,["size","onClick"])])):Object(s["i"])("",!0)],6)])}var Me={name:"LbEditableText",props:{value:{type:String,default:""},type:{type:String,default:"input",validator(e){return["input","textarea"].includes(e)}},width:{type:String},customClass:{type:String},maxLength:{type:Number},minHeight:{type:Number,default:150},noContent:{type:String,default:"No text"}},emits:["onSave"],data(){return{active:!1,editedValue:this.value}},computed:{textClass(){return this.value?"":"lb-editable-text__text--no-content"},setWidth(){return this.width?`width: ${this.width};`:""}},methods:{activate(){this.active=!0,"input"===this.type?this.$nextTick(()=>{this.$refs.input.focus()}):"textarea"===this.type&&this.$nextTick(()=>{this.$refs.textarea.focus()})},deactivate(){this.active=!1,this.editedValue=this.value},save(){this.$emit("onSave",this.editedValue),this.active=!1},saveWithShortcut(e){83===e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.save())}},watch:{value(){this.editedValue=this.value}}};n("456c");const qe=w()(Me,[["render",Je]]);var Be=qe,Re={name:"LbAccordion",components:{LbEditableText:Be},emits:["changeTitle"],props:{title:{type:String,required:!0},isTitleEditable:{type:Boolean,default:!1},maxLength:{type:Number},subtext:{type:String}},data(){return{isOpen:!1}},computed:{toggleButtonIcon(){return this.isOpen?"lb-down":"lb-right"}},methods:{toggleContent(){this.isOpen=!this.isOpen},changeTitle(e){this.$emit("changeTitle",e)}}};n("3eb9");const Ve=w()(Re,[["render",Se]]);var Ge=Ve,Fe={name:"MainPage",components:{LbAccordion:Ge}};n("d987");const Ae=w()(Fe,[["render",Ce]]);var He=Ae;const Ye={class:"chapter-page"},Ke={class:"chapter-page__side-panel"},We=Object(s["k"])("h2",{class:"chapter-page__side-panel-header-text"}," Links in Chapter ",-1),Qe=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Xe={key:0,class:"chapter-page__side-panel-links"},Ze={key:1,class:"chapter-page__side-panel-no-links"},et={class:"chapter-page__side-panel-bottom"},tt={class:"chapter-page__main"},nt={class:"chapter-page__main-header"},st=Object(s["k"])("label",{class:"chapter-page__main-header-label"},"Description",-1),it={class:"chapter-page__main-content"};function at(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-chapter-link"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-editable-text"),d=Object(s["J"])("rich-editor"),p=Object(s["J"])("link-popup"),b=Object(s["J"])("chapter-link-popup");return Object(s["D"])(),Object(s["j"])("div",Ye,[Object(s["k"])("div",Ke,[Object(s["k"])("div",{class:"chapter-page__side-panel-content",style:Object(s["x"])(r.sidePanelVisibility)},[We,Qe,Object(s["n"])(o,{icon:"lb-link",size:1.1,onClick:e.openLinkPopup},{default:Object(s["T"])(()=>[Object(s["m"])("Add new link")]),_:1},8,["size","onClick"]),a.links.length?(Object(s["D"])(),Object(s["j"])("div",Xe,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.links,(e,t)=>(Object(s["D"])(),Object(s["h"])(c,Object(s["u"])({key:t},e,{chapterID:parseInt(n.chapterID),onShowLink:r.openChapterLinkPopup}),null,16,["chapterID","onShowLink"]))),128))])):Object(s["i"])("",!0),a.links.length?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Ze," No links ")),Object(s["k"])("div",et,[Object(s["n"])(o,{icon:"lb-trash",variant:"negative",size:1.2,onClick:r.removeChapter,loading:a.chapterRemoveLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Remove chapter")]),_:1},8,["size","onClick","loading"])])],4),a.linksLoading?(Object(s["D"])(),Object(s["h"])(l,{key:0})):Object(s["i"])("",!0)]),Object(s["k"])("div",tt,[Object(s["k"])("div",nt,[Object(s["n"])(u,{value:a.title,maxLength:80,customClass:"chapter-page__title",class:"chapter-page__title-container",onOnSave:r.changeChapterTitle},null,8,["value","onOnSave"]),st,Object(s["n"])(u,{value:a.description,maxLength:500,type:"textarea",class:"chapter-page__description-container",customClass:"chapter-page__description",onOnSave:r.changeChapterDescription,noContent:"No description"},null,8,["value","onOnSave"])]),Object(s["k"])("div",it,[Object(s["n"])(d,{content:a.chapterText,saveLoading:a.saveLoading,onUpdate:r.updateChapterText,onSave:r.saveChapterText},null,8,["content","saveLoading","onUpdate","onSave"])])]),e.isLinkPopupOpen?(Object(s["D"])(),Object(s["h"])(p,{key:0,chapterID:parseInt(n.chapterID),onOnResult:r.addNewLink},null,8,["chapterID","onOnResult"])):Object(s["i"])("",!0),a.isChapterLinkPopupOpen?(Object(s["D"])(),Object(s["h"])(b,Object(s["u"])({key:1,isOpen:a.isChapterLinkPopupOpen},a.linkInPopup,{onChangeDescription:r.changeLinkDescription,onDeleteLink:r.deleteLink,onClose:r.closeChapterLinkPopup}),null,16,["isOpen","onChangeDescription","onDeleteLink","onClose"])):Object(s["i"])("",!0)])}const rt={class:"rich-editor"},ot={class:"rich-editor__menu"};function ct(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("editor-content");return Object(s["D"])(),Object(s["j"])("div",rt,[Object(s["k"])("div",ot,[Object(s["k"])("button",{class:"rich-editor__menu-btn rich-editor__menu-btn--bold",onClick:t[0]||(t[0]=(...e)=>r.bold&&r.bold(...e))},"B"),Object(s["k"])("button",{class:"rich-editor__menu-btn rich-editor__menu-btn--italic",onClick:t[1]||(t[1]=(...e)=>r.italic&&r.italic(...e))},"I"),Object(s["k"])("button",{class:"rich-editor__menu-btn rich-editor__menu-btn--underline",onClick:t[2]||(t[2]=(...e)=>r.underline&&r.underline(...e))},"U"),Object(s["n"])(o,{class:"rich-editor__save-btn",variant:"positive",size:1.1,loading:n.saveLoading,onClick:t[3]||(t[3]=t=>e.$emit("save"))},{default:Object(s["T"])(()=>[Object(s["m"])("Save")]),_:1},8,["size","loading"])]),Object(s["n"])(c,{class:"rich-editor__content",editor:a.editor,onKeydown:Object(s["V"])(r.saveWithShortcut,["ctrl","stop"])},null,8,["editor","onKeydown"])])}var lt=n("c1e2"),ut=n("cc86"),dt=n("672a"),pt={name:"RichEditor",components:{EditorContent:lt["b"]},props:{content:{type:Object,default:()=>({type:"doc",content:[{type:"paragraph"}]})},saveLoading:{type:Boolean,default:!1}},data(){return{editor:null}},methods:{bold(){this.editor.chain().focus().toggleBold().run()},italic(){this.editor.chain().focus().toggleItalic().run()},underline(){this.editor.chain().focus().toggleUnderline().run()},saveWithShortcut(e){83===e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.$emit("save"))}},watch:{content(e){const t=JSON.stringify(this.editor.getJSON())===JSON.stringify(e);t||this.editor.commands.setContent(e,!1)}},mounted(){this.editor=new lt["a"]({content:this.content,extensions:[dt["a"],ut["a"]],onUpdate:()=>{this.$emit("update",this.editor.getJSON())}})},beforeUnmount(){this.editor.destroy()}};n("d6e9");const bt=w()(pt,[["render",ct]]);var ht=bt,mt=n("bf68");const gt="/chapters",Ot={type:"doc",content:[{type:"paragraph"}]};function vt(e){return e.map(e=>({id:e.id,title:e.title,description:e.description,ordinalNumber:e.ordinal_number}))}async function jt(e){return v.get(`${gt}/${e}`).then(e=>{let t={id:e.data.id,title:e.data.title,description:e.data.description,text:e.data.text,ordinalNumber:e.data.ordinal_number,storyID:e.data.Story_id};return t}).catch(e=>{throw e.response?new Error(""+e.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function yt(e){return await v.get("/chapters/story/"+e).then(e=>vt(e.data)).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ft(e,t,n,s){const i={title:e,description:t,text:Ot,ordinalNumber:n,storyID:s};return v.post("/chapters",i).then(e=>e.data).catch(e=>{throw e.response?new Error(""+e.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function _t(e,t){if(t.text)throw new Error('Cannot update text directly. You should use "textPatch" field.');return await v.patch("/chapters/"+e,t).then(e=>!0).catch(e=>{throw e.response?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function kt(e,t){return await v.patch("/chapters/position/"+e,t).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function wt(e){return await v.delete("/chapters/"+e).then(e=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}function Dt(e){return e.Character_id?e.Character_id:e.Location_id?e.Location_id:e.Event_id?e.Event_id:e.Entry_id?e.Entry_id:void 0}function Ct(e){return{id:e.id,description:e.description,targetName:e.target.name,targetID:Dt(e),categoryName:e.target.Category.name,categoryID:e.target.Category.id}}async function Et(e,t){let n=e;return n.contentID=t,await v.post("/link_groups/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Lt(e,t,n){const s=n?`/links/${e}/content/${n}`:"/links/"+e;return await v.patch(s,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function It(e,t,n){return await v.patch(`/link_groups/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function xt(e,t){return await v.delete(`/link_groups/${e}/content/${t}`).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Pt(e,t){const n=t?`/links/${e}/content/${t}`:"/links/"+e;return await v.delete(n).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function St(e,t,n,s,i){let a;switch(t){case"Locations":a="Location";break;case"Characters":a="Character";break;case"Events":a="Event";break;default:a="Entry";break}const r={targetID:e,targetType:a,description:n};if(s&&!i)r.linkGroupID=s;else{if(!i||s)throw new Error("You should give linkGroupID OR chapterID in arguments");r.chapterID=i}return await v.post("/links",r).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Tt(e){return await v.get("/links/chapter/"+e).then(e=>e.data.map(e=>Ct(e))).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}const Nt={class:"link-popup"},Ut=Object(s["k"])("h2",{class:"link-popup__field-title"},"Type of target",-1),zt={key:0,class:"link-popup__search-field"},$t=Object(s["k"])("h2",{class:"link-popup__field-title"},"Target",-1),Jt={class:"link-popup__buttons"};function Mt(e,t,n,i,a,r){const o=Object(s["J"])("lb-select"),c=Object(s["J"])("lb-search-bar"),l=Object(s["J"])("lb-select-list"),u=Object(s["J"])("lb-page-nav"),d=Object(s["J"])("lb-input"),p=Object(s["J"])("lb-button"),b=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(b,{isOpen:e.isLinkPopupOpen,title:"Create Link",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Nt,[Object(s["k"])("div",null,[Ut,Object(s["n"])(o,{items:a.categories,width:"100%",placeholder:"Select type of link target",loading:a.categoriesLoading,onHandleSelection:r.selectCategory},null,8,["items","loading","onHandleSelection"])]),null!==a.selectedCategory?(Object(s["D"])(),Object(s["j"])("div",zt,[$t,Object(s["n"])(c,{placeholder:"Search target",onSearch:r.search,text:a.searchText},null,8,["onSearch","text"]),Object(s["n"])(l,{items:r.filteredElements,loading:a.areElementsLoading,selectedID:a.targetElementID,onOnSelect:r.selectTargetElement,maxHeight:"250px"},null,8,["items","loading","selectedID","onOnSelect"]),1!=a.totalPages?(Object(s["D"])(),Object(s["h"])(u,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage,class:"link-popup__page-nav"},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)])):Object(s["i"])("",!0),Object(s["n"])(d,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e),maxLength:250},null,8,["value"]),Object(s["k"])("div",Jt,[Object(s["n"])(p,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(p,{variant:"positive",size:1.4,onClick:r.createNewLink,disabled:r.isCreateButtonDisabled,loading:a.createLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Create Link")]),_:1},8,["size","onClick","disabled","loading"])])])]),_:1},8,["isOpen","onClose"])}const qt={class:"lb-input"},Bt={class:"lb-input__header"},Rt=["type","maxlength"],Vt=["maxlength"];function Gt(e,t,n,i,a,r){const o=Object(s["J"])("lb-small-error");return Object(s["D"])(),Object(s["j"])("div",qt,[Object(s["k"])("div",Bt,[n.name?(Object(s["D"])(),Object(s["j"])("h2",{key:0,class:"lb-input__title",style:Object(s["x"])(r.setSize.title)},Object(s["M"])(n.name),5)):Object(s["i"])("",!0),n.error.length&&!a.isFocused?(Object(s["D"])(),Object(s["h"])(o,{key:1,text:n.error,size:1.5},null,8,["text","size"])):Object(s["i"])("",!0)]),"textarea"!==n.type?Object(s["U"])((Object(s["D"])(),Object(s["j"])("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),type:n.type,class:Object(s["w"])(r.fieldClass),maxlength:n.maxLength,style:Object(s["x"])(r.setSize.input),onInput:t[1]||(t[1]=t=>e.$emit("update:value",n.value)),onChange:t[2]||(t[2]=t=>e.$emit("change:value",n.value)),onFocus:t[3]||(t[3]=e=>a.isFocused=!0),onBlur:t[4]||(t[4]=e=>a.isFocused=!1)},null,46,Rt)),[[s["O"],n.value]]):Object(s["U"])((Object(s["D"])(),Object(s["j"])("textarea",{key:1,"onUpdate:modelValue":t[5]||(t[5]=e=>n.value=e),class:Object(s["w"])(r.fieldClass),maxlength:n.maxLength,style:Object(s["x"])(r.setSize.textarea),onInput:t[6]||(t[6]=t=>e.$emit("update:value",n.value)),onFocus:t[7]||(t[7]=e=>a.isFocused=!0),onBlur:t[8]||(t[8]=e=>a.isFocused=!1)},null,46,Vt)),[[s["P"],n.value]])])}const Ft={key:0,class:"lb-small-error"},At={class:"lb-small-error__container"},Ht={class:"lb-small-error__icon"};function Yt(e,t,n,i,a,r){const o=Object(s["J"])("icon");return r.haveText?(Object(s["D"])(),Object(s["j"])("div",Ft,[Object(s["k"])("div",At,[Object(s["k"])("div",Ht,[Object(s["n"])(o,{icon:"lb-warning-circle-fill",size:this.size},null,8,["size"])]),Object(s["k"])("div",{class:"lb-small-error__wrap-text",style:Object(s["x"])(`left: ${n.size}rem; min-width: ${10*n.size}rem;`)},[Object(s["k"])("div",{class:"lb-small-error__content",style:Object(s["x"])(`font-size: ${.5*n.size}rem;`)},Object(s["M"])(n.text),5)],4)])])):Object(s["i"])("",!0)}var Kt={name:"LbSmallError",props:{size:{type:Number,default:1},text:{type:String,default:""}},computed:{haveText(){return""!=this.text}}};n("5a24");const Wt=w()(Kt,[["render",Yt]]);var Qt=Wt,Xt={components:{LbSmallError:Qt},name:"LbInput",emits:["update:value","change:value"],props:{name:{type:String},type:{type:String,default:"text"},value:{type:[String,Number],required:!0},error:{type:String,default:""},maxLength:{type:Number},minHeight:{type:Number,default:150},fontSize:{type:Number,default:1.2}},data(){return{isFocused:!1}},computed:{fieldClass(){return this.error.length&&!this.isFocused?"lb-input__field lb-input__field--invalid":"lb-input__field"},setSize(){return{title:`font-size: ${this.fontSize+.2}rem;`,input:`font-size: ${this.fontSize}rem;`,textarea:`font-size: ${this.fontSize}rem; min-height: ${this.minHeight}px;`}}}};n("7267");const Zt=w()(Xt,[["render",Gt]]);var en=Zt;const tn={class:"lb-select__text-field"},nn={class:"lb-select__button"},sn={class:"lb-select__dropdown"},an={key:0,class:"lb-select__dropdown-content"},rn=["onClick"],on={class:"lb-select__item-text"},cn={key:1,class:"lb-select__no-content"};function ln(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",{class:"lb-select",style:Object(s["x"])(r.setWidth)},[Object(s["k"])("div",{class:Object(s["w"])(["lb-select__control",r.setClass]),onClick:t[0]||(t[0]=(...e)=>r.toggleOpen&&r.toggleOpen(...e))},[Object(s["k"])("div",tn,Object(s["M"])(r.setSelectText),1),Object(s["k"])("div",nn,[Object(s["n"])(o,{icon:r.setIcon},null,8,["icon"])]),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0,variant:"dark",size:"25px"})):Object(s["i"])("",!0)],2),Object(s["U"])(Object(s["k"])("div",sn,[a.itemsToSelect.length>0?(Object(s["D"])(),Object(s["j"])("div",an,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.itemsToSelect,(e,t)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-select__item",key:t,onClick:e=>r.selectItem(t)},[Object(s["k"])("span",on,Object(s["M"])(e.name),1),Object(s["k"])("div",{class:"lb-select__item-icon",style:Object(s["x"])(e.selected?"visibility: visible;":"visibility: hidden;")},[Object(s["n"])(o,{icon:"lb-ok"})],4)],8,rn))),128))])):(Object(s["D"])(),Object(s["j"])("div",cn," No items "))],512),[[s["Q"],a.isOpen]])],4)}var un={name:"LbSelect",props:{items:{type:Array,default:[]},multiselect:{type:Boolean,default:!1},placeholder:{type:String,default:""},width:{type:String,default:"150px"},loading:{type:Boolean,default:!1}},emits:["handleSelection"],data(){return{isOpen:!1,itemsToSelect:this.items,selectedItems:[]}},computed:{setClass(){return this.loading?"lb-select__control--loading":""},setIcon(){return this.isOpen?"lb-up":"lb-down"},setSelectText(){return 0===this.selectedItems.length?this.placeholder:1==this.selectedItems.length?this.selectedItems[0].name:this.selectedItems.length+" selected options"},setWidth(){return`width: ${this.width};`}},methods:{toggleOpen(){this.loading||(this.isOpen=!this.isOpen)},selectItem(e){if(this.multiselect)this.itemsToSelect[e].selected=!this.itemsToSelect[e].selected,this.selectedItems=this.itemsToSelect.filter(e=>e.selected),this.$emit("handleSelection",this.selectedItems);else{this.itemsToSelect[e].selected=!this.itemsToSelect[e].selected;for(let t=0;t<this.itemsToSelect.length;t++)t!=e&&(this.itemsToSelect[t].selected=!1);this.selectedItems=this.itemsToSelect[e].selected?[this.itemsToSelect[e]]:[],this.$emit("handleSelection",this.selectedItems),this.isOpen=!1}}}};n("a853");const dn=w()(un,[["render",ln]]);var pn=dn;const bn={class:"lb-select-list"},hn={class:"lb-select-list__header"},mn=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),gn=["onClick"],On={class:"lb-select-list__item-name"},vn={key:1,class:"lb-select-list__no-items"};function jn(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",bn,[Object(s["k"])("div",hn,[Object(s["k"])("h2",{class:"lb-select-list__header-text",style:Object(s["x"])(`font-size: ${n.size+.3}rem`)},Object(s["M"])(n.headText),5),mn]),n.items.length?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:"lb-select-list__items",style:Object(s["x"])(r.itemsStyle)},[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.items,(e,t)=>(Object(s["D"])(),Object(s["j"])("div",{class:Object(s["w"])(["lb-select-list__item",r.itemChecked(e.id).listItem]),key:t,onClick:t=>r.selectItem(e.id)},[Object(s["k"])("div",{class:"lb-select-list__item-content",style:Object(s["x"])(`font-size: ${n.size}rem`)},[Object(s["k"])("span",On,Object(s["M"])(e.name),1),Object(s["n"])(o,{icon:"lb-ok",class:"lb-select-list__check-icon",size:n.size},null,8,["size"])],4),Object(s["k"])("div",{class:Object(s["w"])(r.itemChecked(e.id).line)},null,2)],10,gn))),128))],4)):Object(s["i"])("",!0),0==n.items.length?(Object(s["D"])(),Object(s["j"])("div",vn,Object(s["M"])(n.noItemsText),1)):Object(s["i"])("",!0),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:2})):Object(s["i"])("",!0)])}var yn={name:"LbSelectList",emits:["onSelect"],props:{headText:{type:String,default:"Name"},selectedID:{type:Number,default:null},items:{type:Array,default:[]},noItemsText:{type:String,default:"No Elements"},loading:{type:Boolean,default:!1},size:{type:Number,default:1},maxHeight:{type:String}},computed:{itemsStyle(){const e=this.maxHeight?`max-height: ${this.maxHeight};`:"",t=this.loading?"visibility: hidden;":"visibility: visible;";return`${e} ${t}`}},methods:{itemChecked(e){return this.selectedID==e?{listItem:"lb-select-list__item--checked",line:"util__horizontal-line--green"}:{listItem:"",line:"util__horizontal-line--white"}},selectItem(e){this.loading||this.$emit("onSelect",e)}}};n("6b23");const fn=w()(yn,[["render",jn]]);var _n=fn;const kn=["placeholder"];function wn(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",{class:"lb-search-bar",style:Object(s["x"])(`width: ${n.width};`)},[Object(s["U"])(Object(s["k"])("input",{class:"lb-search-bar__input",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:n.placeholder,onKeydown:t[1]||(t[1]=(...e)=>r.handleEnterPress&&r.handleEnterPress(...e))},null,40,kn),[[s["P"],a.value]]),Object(s["k"])("button",{class:"lb-search-bar__button",onClick:t[2]||(t[2]=t=>e.$emit("search",a.value))},[Object(s["n"])(o,{icon:"lb-search"})])],4)}var Dn={name:"LbSearchBar",emits:["search"],props:{placeholder:{type:String,default:"Search..."},width:{type:String,default:"100%"},text:{type:String,default:""}},data(){return{value:this.text}},methods:{handleEnterPress(e){"Enter"==e.key&&(e.preventDefault(),this.$emit("search",this.value))}},watch:{text(e){this.value=e}}};n("10f6");const Cn=w()(Dn,[["render",wn]]);var En=Cn;const Ln={class:"lb-page-nav"},In={class:"lb-page-nav__pages"},xn=["max"],Pn=Object(s["k"])("span",null,"of",-1),Sn={class:"lb-page-nav__total-pages"};function Tn(e,t,n,i,a,r){const o=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",Ln,[Object(s["n"])(o,{icon:"lb-left",size:1.4,disabled:r.prevButtonState,onClick:t[0]||(t[0]=e=>this.$emit("go",this.currentPage-1))},null,8,["size","disabled"]),Object(s["k"])("div",In,[Object(s["U"])(Object(s["k"])("input",{class:"lb-page-nav__input",type:"number",min:1,max:n.totalPages,"onUpdate:modelValue":t[1]||(t[1]=e=>a.pageNumber=e),onKeydown:t[2]||(t[2]=(...e)=>r.submitOnKey&&r.submitOnKey(...e))},null,40,xn),[[s["P"],a.pageNumber]]),Pn,Object(s["k"])("span",Sn,Object(s["M"])(n.totalPages),1)]),Object(s["n"])(o,{icon:"lb-right",size:1.4,disabled:r.nextButtonState,onClick:t[3]||(t[3]=e=>this.$emit("go",this.currentPage+1))},null,8,["size","disabled"]),Object(s["n"])(o,{size:1.1,onClick:r.submitPageNumber,class:"lb-page-nav__go-button"},{default:Object(s["T"])(()=>[Object(s["m"])(" Go ")]),_:1},8,["size","onClick"])])}var Nn={name:"LbPageNav",props:{currentPage:{type:Number,default:1},totalPages:{type:Number,required:!0}},emits:["go"],data(){return{pageNumber:this.currentPage}},computed:{prevButtonState(){return this.currentPage-1<1},nextButtonState(){return this.currentPage+1>this.totalPages}},methods:{submitPageNumber(){this.pageNumber<1?(this.$emit("go",1),this.pageNumber=1):this.pageNumber>this.totalPages?(this.$emit("go",this.totalPages),this.pageNumber=this.totalPages):this.$emit("go",this.pageNumber)},submitOnKey(e){13===e.keyCode&&(e.preventDefault(),this.submitPageNumber())}},watch:{currentPage(e){this.pageNumber=e}}};n("85c8");const Un=w()(Nn,[["render",Tn]]);var zn=Un;async function $n(e){return await v.get("/categories/universe/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Jn(e){return await v.get("/categories/universe/list/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Mn({name:e,universeID:t}){return await v.post("/categories",{name:e,universeID:t}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function qn(e,t){return await v.patch("/categories/"+e,{name:t}).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Bn(e){return await v.delete("/categories/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Rn(e){return await v.get("/categories/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}class Vn extends Error{constructor(e){super(e),this.name="NotFoundException"}}async function Gn(e){return await v.get("/characters/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Vn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Fn(e,t){return await v.patch("/characters/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function An(e,t,n){return await v.post("/characters",{name:e,description:t,universeID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Hn(e,t,n,s){const i=encodeURIComponent(t);return await v.get(`/characters/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Yn(e){return await v.delete("/characters/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Kn(e){return await v.get("/entries/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Vn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Wn(e,t){return await v.patch("/entries/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Qn(e,t,n){return await v.post("/entries",{name:e,description:t,categoryID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Xn(e,t,n,s){const i=encodeURIComponent(t);return await v.get(`/entries/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Zn(e){return await v.delete("/entries/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}function es(e){return{id:e.id,name:e.name,description:e.description,parentID:e.Location_id,Universe_id:e.Universe_id,parentName:e.parentName}}async function ts(e){return await v.get("/locations/"+e).then(e=>es(e.data)).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Vn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ns(e,t){return await v.patch("/locations/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ss(e,t,n,s){return await v.post("/locations",{name:e,description:t,universeID:n,locationID:s}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function is(e){return await v.get("/locations/universe/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function as(e,t,n,s){const i=encodeURIComponent(t);return await v.get(`/locations/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function rs(e){return await v.delete("/locations/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function os(e){return await v.get("/events/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Vn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function cs(e,t){return await v.patch("/events/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ls(e,t,n,s){return await v.post("/events",{name:e,description:t,date:n,universeID:s}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function us(e,t,n,s){const i=encodeURIComponent(t);return await v.get(`/events/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ds(e){return await v.delete("/events/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ps(e,t){let n=null;return n="Characters"==t?await Gn(e):"Locations"==t?await ts(e):"Events"==t?await os(e):await Kn(e),n}async function bs(e,t,n){"Characters"==n?await Fn(e,t):"Locations"==n?await ns(e,t):"Events"==n?await cs(e,t):await Wn(e,t)}async function hs(e,t,n,s,i){let a=null;switch(i){case"Locations":a=await as(e,t,n,s);break;case"Characters":a=await Hn(e,t,n,s);break;case"Events":a=await us(e,t,n,s);break;default:a=await Xn(i,t,n,s);break}const r={elements:a.rows,elementCount:a.count,totalPages:Math.ceil(a.count/n)};return r}async function ms(e,t){"Characters"==t?await Yn(e):"Locations"==t?await rs(e):"Events"==t?await ds(e):await Zn(e)}var gs={name:"LinkPopup",emits:["onResult"],components:{LbInput:en,LbSelect:pn,LbSelectList:_n,LbSearchBar:En,LbPageNav:zn},props:{chapterID:{type:Number,default:null},linkGroupID:{type:Number,default:null},elementID:{type:Number,default:null},elementCategoryID:{type:String,default:null}},data(){return{createLoading:!1,description:"",categories:[],selectedCategory:null,categoriesLoading:!1,elements:[],targetElementID:null,areElementsLoading:!1,searchText:"",currentPage:1,totalPages:1}},computed:{...Object(b["c"])("popups",["isLinkPopupOpen"]),...Object(b["c"])("universe",["universeID"]),isCreateButtonDisabled(){return null===this.selectedCategory||null===this.targetElementID},filteredElements(){return this.selectedCategory==this.elementCategoryID?this.elements.filter(e=>e.id!=this.elementID):this.elements}},methods:{...Object(b["d"])("popups",["closeLinkPopup"]),...Object(b["d"])("notifications",["notify"]),close(){this.closeLinkPopup()},async fetchCategories(){try{this.categoriesLoading=!0;const e=[{id:"Characters",name:"Characters"},{id:"Locations",name:"Locations"},{id:"Events",name:"Events"}],t=await $n(this.universeID);this.categories.push(...e,...t)}catch(e){this.notify({type:"negative",message:e.message})}finally{this.categoriesLoading=!1}},async fetchElements(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=25;this.areElementsLoading=!0;try{const t=0!==n?n*s-s:0,i=await hs(this.universeID,e,s,t,this.selectedCategory);this.elementCount=i.elementCount,this.elements=i.elements,this.totalPages=i.totalPages}catch(i){this.notify({type:"negative",message:"Error: "+i.message})}finally{this.areElementsLoading=!1}},async selectCategory(e){this.selectedCategory=e.length?e[0].id:null,null!==this.selectedCategory&&(this.targetElementID=null,this.searchText="",this.currentPage=1,await this.search(this.searchText))},async selectTargetElement(e){this.targetElementID=this.targetElementID!==e?e:null},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchElements(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},async createNewLink(){try{if(this.chapterID&&this.linkGroupID)throw new Error("Only one of this must be defined (chapterID or linkGroupID)");this.createLoading=!0;const e=this.categories.find(e=>e.id==this.selectedCategory),t=this.elements.find(e=>e.id==this.targetElementID),n=this.description,s=await St(this.targetElementID,this.selectedCategory,n,this.linkGroupID,this.chapterID);this.$emit("onResult",{id:s.id,description:n,targetID:t.id,targetName:t.name,categoryID:e.id,categoryName:e.name}),this.closeLinkPopup()}catch(e){this.notify({type:"negative",message:e.message})}finally{this.createLoading=!1}}},async mounted(){await this.fetchCategories()},unmounted(){this.closeLinkPopup()}};n("8c74");const Os=w()(gs,[["render",Mt]]);var vs=Os;const js={class:"lb-chapter-link"},ys={class:"lb-chapter-link__content"},fs={class:"lb-chapter-link__category"},_s={class:"lb-chapter-link__button"};function ks(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",js,[Object(s["k"])("div",ys,[Object(s["k"])("div",fs,Object(s["M"])(n.categoryName),1),Object(s["k"])("div",{class:"lb-chapter-link__name",onClick:t[0]||(t[0]=(...e)=>r.navigateToElement&&r.navigateToElement(...e))},Object(s["M"])(n.targetName),1)]),Object(s["k"])("div",_s,[Object(s["n"])(o,{size:1.1,icon:"lb-info-circle",class:"lb-chapter-link__button-icon",onClick:r.showLink},null,8,["size","onClick"])])])}var ws={name:"LbChapterLink",emits:["showLink"],props:{chapterID:{type:Number,required:!0},id:{type:Number,required:!0},description:{type:String},targetID:{type:Number,required:!0},targetName:{type:String,rquired:!0},categoryID:{type:[Number,String],required:!0},categoryName:{type:String,required:!0}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{navigateToElement(){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.categoryID,elementID:this.targetID}})},showLink(){this.$emit("showLink",this.id)}}};n("9bb8");const Ds=w()(ws,[["render",ks]]);var Cs=Ds;const Es={class:"chapter-link-popup"},Ls={class:"chapter-link-popup__header"},Is={class:"chapter-link-popup__category-name"},xs={class:"chapter-link-popup__target-name"},Ps=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),Ss={class:"chapter-link-popup__content"},Ts=Object(s["k"])("label",{class:"chapter-link-popup__description-label"}," Description ",-1),Ns={class:"chapter-link-popup__delete-btn"};function Us(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(l,{isOpen:n.isOpen,title:"Link in Chapter",onClose:t[0]||(t[0]=t=>e.$emit("close"))},{default:Object(s["T"])(()=>[Object(s["k"])("div",Es,[Object(s["k"])("div",Ls,[Object(s["k"])("div",Is,Object(s["M"])(n.categoryName),1),Object(s["k"])("div",xs,Object(s["M"])(n.targetName),1),Ps]),Object(s["k"])("div",Ss,[Ts,Object(s["n"])(o,{value:a.editableDescription,maxLength:250,type:"textarea",class:"chapter-link-popup__description-container",customClass:"chapter-link-popup__description",onOnSave:r.changeChapterDescription,noContent:"No description"},null,8,["value","onOnSave"]),Object(s["k"])("div",Ns,[Object(s["n"])(c,{icon:"lb-unlink",variant:"negative",onClick:r.deleteChapterLink,size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Remove link from chapter")]),_:1},8,["onClick","size"])])])])]),_:1},8,["isOpen"])}var zs={name:"ChapterLinkPopup",components:{LbEditableText:Be},emits:["changeDescription","deleteLink","close"],props:{isOpen:{type:Boolean,default:!1},id:{type:Number,required:!0},description:{type:String},targetID:{type:Number,required:!0},targetName:{type:String,rquired:!0},categoryID:{type:[Number,String],required:!0},categoryName:{type:String,required:!0}},data(){return{editableDescription:this.description,removeLinkLoading:!0}},methods:{...Object(b["d"])("notifications",["notify"]),async changeChapterDescription(e){try{await Lt(this.id,{description:e}),this.editableDescription=e,this.$emit("changeDescription",{id:this.id,newValue:this.editableDescription})}catch(t){this.notify({type:"negative",message:t.message})}},async deleteChapterLink(){try{this.removeLinkLoading=!0,await Pt(this.id),this.$emit("deleteLink",this.id),this.$emit("close")}catch(e){this.notify({type:"negative",message:e.message})}finally{this.removeLinkLoading=!1}}}};n("3edc");const $s=w()(zs,[["render",Us]]);var Js=$s,Ms={name:"App",components:{RichEditor:ht,LbEditableText:Be,LinkPopup:vs,LbChapterLink:Cs,ChapterLinkPopup:Js},props:{chapterID:{type:String},storyID:{type:String}},data(){return{title:"",description:"",chapterText:{type:"doc",content:[{type:"paragraph"}]},oldChapterText:{type:"doc",content:[{type:"paragraph"}]},saveLoading:!1,linksLoading:!1,links:[],linkInPopup:null,isChapterLinkPopupOpen:!1,chapterRemoveLoading:!1}},computed:{...Object(b["c"])("popups",["isLinkPopupOpen"]),...Object(b["c"])("universe",["universeID"]),sidePanelVisibility(){return this.linksLoading?"visibility: hidden;":"visibility: visible;"}},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("popups",["openLinkPopup"]),updateChapterText(e){this.chapterText=e},async saveChapterText(){this.saveLoading=!0;const e=Object(mt["createPatch"])("newText",JSON.stringify(this.oldChapterText),JSON.stringify(this.chapterText));try{await _t(this.chapterID,{textPatch:e}),this.oldChapterText=this.chapterText}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}finally{this.saveLoading=!1}},async fetchChapter(){try{const e=await jt(this.chapterID);this.chapterText=e.text,this.title=e.title,this.description=e.description,this.oldChapterText=this.chapterText}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}},async fetchChapterLinks(){try{this.linksLoading=!0,this.links=await Tt(this.chapterID)}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.linksLoading=!1}},async changeChapterTitle(e){try{await _t(this.chapterID,{title:e}),this.title=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async changeChapterDescription(e){try{await _t(this.chapterID,{description:e}),this.description=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},addNewLink(e){this.links.push(e)},openChapterLinkPopup(e){this.linkInPopup=this.links.find(t=>t.id===e),this.isChapterLinkPopupOpen=!0},closeChapterLinkPopup(){this.isChapterLinkPopupOpen=!1,this.linkInPopup=null},changeLinkDescription(e){try{const{id:t,newValue:n}=e,s=this.links.find(e=>e.id===t);s.description=n}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},deleteLink(e){try{this.links=this.links.filter(t=>t.id!==e)}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async removeChapter(){try{this.chapterRemoveLoading=!0,await wt(this.chapterID),this.$router.replace({name:"StoryChaptersPage",params:{universeID:this.universeID,storyID:this.storyID}})}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.chapterRemoveLoading=!1}}},async mounted(){await this.fetchChapter(),await this.fetchChapterLinks()}};n("7a10");const qs=w()(Ms,[["render",at]]);var Bs=qs;const Rs={class:"register-page"},Vs={class:"register-page__form"},Gs=Object(s["k"])("h1",{class:"register-page__header"},"Create new account",-1),Fs=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),As={class:"register-page__inputs"},Hs={class:"register-page__bottom"};function Ys(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("router-link"),l=Object(s["J"])("lb-button"),u=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",Rs,[Object(s["k"])("div",Vs,[Object(s["k"])("div",{style:Object(s["x"])(r.isFormVisible)},[Gs,Fs,Object(s["k"])("div",As,[Object(s["n"])(o,{name:"Username",value:a.username.value,"onUpdate:value":r.setUsername,maxLength:45,error:a.username.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Email address",type:"email",value:a.email.value,"onUpdate:value":r.setEmail,maxLength:45,error:a.email.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Password",type:"password",value:a.password.value,"onUpdate:value":r.setPassword,maxLength:60,error:a.password.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Confirm Password",type:"password",value:a.passwordConfirm.value,"onUpdate:value":r.setPasswordConfirm,maxLength:60,error:a.passwordConfirm.errorMsg},null,8,["value","onUpdate:value","error"])]),Object(s["k"])("div",Hs,[Object(s["n"])(c,{to:"/login",class:"register-page__link"},{default:Object(s["T"])(()=>[Object(s["m"])("Already have an account? Log In")]),_:1}),Object(s["n"])(l,{onClick:r.register,size:1.2,disabled:r.isButtonDisabled},{default:Object(s["T"])(()=>[Object(s["m"])("Register")]),_:1},8,["onClick","size","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(u,{key:0,size:"70px",thickness:"10px"})):Object(s["i"])("",!0)])])}const Ks={class:"lb-popup-box__header"},Ws={class:"lb-popup-box__title"},Qs={class:"lb-popup-box__close-window-block"},Xs={class:"lb-popup-box__content"},Zs={class:"lb-popup-box__message"};function ei(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-popper");return Object(s["D"])(),Object(s["h"])(c,{isOpen:n.isOpen},{default:Object(s["T"])(()=>[n.isOpen?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:Object(s["w"])(r.setVariantClass)},[Object(s["k"])("div",Ks,[Object(s["k"])("div",Ws,Object(s["M"])(n.title),1),Object(s["k"])("div",Qs,[Object(s["n"])(o,{id:"lb-popup-box__close-button",onClick:t[0]||(t[0]=t=>e.$emit("close")),icon:"lb-cancel-circled",size:1.5},null,8,["size"])])]),Object(s["k"])("div",Xs,[Object(s["I"])(e.$slots,"default",{},()=>[Object(s["k"])("span",Zs,Object(s["M"])(n.message),1)])])],2)):Object(s["i"])("",!0)]),_:3},8,["isOpen"])}const ti={key:0,class:"lb-popper",tabindex:-1},ni={class:"lb-popper__content"};function si(e,t,n,i,a,r){const o=Object(s["J"])("focus-trap");return Object(s["D"])(),Object(s["h"])(o,{active:n.isOpen},{default:Object(s["T"])(()=>[this.isOpen?(Object(s["D"])(),Object(s["j"])("div",ti,[Object(s["k"])("div",ni,[Object(s["I"])(e.$slots,"default")])])):Object(s["i"])("",!0)]),_:3},8,["active"])}var ii=n("164c"),ai={name:"LbPopper",components:{FocusTrap:ii["a"]},props:{isOpen:{type:Boolean,default:!1}}};n("8815");const ri=w()(ai,[["render",si]]);var oi=ri,ci={components:{LbPopper:oi},name:"LbPopupBox",emits:["close"],props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Title"},message:{type:String,default:"Message text"},variant:{type:String,default:"default",validator(e){return["negative","positive","default"].includes(e)}}},computed:{setVariantClass(){return"lb-popup-box lb-popup-box--"+this.variant}}};n("b10b");const li=w()(ci,[["render",ei]]);var ui=li;async function di(e,t,n){return await v.post("/users",{username:e,password:t,email:n}).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var pi={name:"RegisterPage",components:{LbInput:en,LbPopupBox:ui},data(){return{username:{value:"",errorMsg:""},email:{value:"",errorMsg:""},password:{value:"",errorMsg:""},passwordConfirm:{value:"",errorMsg:""},loading:!1}},computed:{isButtonDisabled(){return 0===this.username.value.length||0===this.email.value.length||0===this.password.value.length||0===this.passwordConfirm.value.length},isFormVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"}},methods:{...Object(b["d"])("notifications",["notify"]),setUsername(e){this.username.errorMsg="",this.username.value=e},setEmail(e){this.email.value=e,!this.email.value.includes("@")&&this.email.value.length>0?this.email.errorMsg='Email should contain "@"':this.email.errorMsg=""},setPassword(e){this.password.value=e,this.password.errorMsg="",this.passwordConfirm.value.length>0&&this.passwordConfirm.value!=this.password.value?this.passwordConfirm.errorMsg="Passwords do not match":this.passwordConfirm.errorMsg=""},setPasswordConfirm(e){this.passwordConfirm.value=e,this.passwordConfirm.value!=this.password.value?this.passwordConfirm.errorMsg="Passwords do not match":this.passwordConfirm.errorMsg=""},formValidation(){return""==this.username.errorMsg&&""==this.password.errorMsg&&""==this.passwordConfirm.errorMsg&&""==this.email.errorMsg&&this.username.value.length>0&&this.password.value.length>0&&this.passwordConfirm.value.length>0&&this.email.value.length>0},closePopup(){this.isPopupOpen=!1,this.resultMessage="",this.resultTitle="",this.resultType=""},async register(){if(this.formValidation()){let e=null;this.loading=!0;try{e=await di(this.username.value,this.password.value,this.email.value),e&&(this.notify({type:"positive",message:"User Created"}),this.$router.push("/login"))}catch(err){switch(err.path){case"password":this.password.errorMsg=err.message;break;case"email":this.email.errorMsg=err.message;break;case"username":this.username.errorMsg=err.message;break;default:this.notify({type:"negative",message:err.message});break}}finally{this.loading=!1}}}}};n("41f7");const bi=w()(pi,[["render",Ys]]);var hi=bi;const mi={class:"login-page"},gi={class:"login-page__form"},Oi=Object(s["k"])("h1",{class:"login-page__header"},"Log In",-1),vi=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),ji={class:"login-page__inputs"},yi={class:"login-page__bottom"};function fi(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("router-link"),l=Object(s["J"])("lb-button"),u=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",mi,[Object(s["k"])("div",gi,[Object(s["k"])("div",{style:Object(s["x"])(r.isFormVisible)},[Oi,vi,Object(s["k"])("div",ji,[Object(s["n"])(o,{name:"Username",value:a.username.value,"onUpdate:value":r.setUsername,maxLength:45,error:a.username.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Password",type:"password",value:a.password.value,"onUpdate:value":r.setPassword,maxLength:60,error:a.password.errorMsg,onKeydown:r.handleEnterPress},null,8,["value","onUpdate:value","error","onKeydown"])]),Object(s["k"])("div",yi,[Object(s["n"])(c,{to:"/register",class:"login-page__link"},{default:Object(s["T"])(()=>[Object(s["m"])("Don't have an account? Sign Up")]),_:1}),Object(s["n"])(l,{onClick:r.logIn,size:1.2,disabled:r.isButtonDisabled},{default:Object(s["T"])(()=>[Object(s["m"])("Log In")]),_:1},8,["onClick","size","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(u,{key:0,size:"70px",thickness:"10px"})):Object(s["i"])("",!0)])])}const _i={class:"lb-search-select"},ki={class:"lb-search-select__control"},wi={key:0,class:"lb-search-select__selection"},Di=["placeholder","disabled"],Ci={class:"lb-search-select__dropdown"},Ei={key:0,class:"lb-search-select__dropdown-content"},Li=["onClick"],Ii={class:"lb-search-select__item-text"},xi={key:1,class:"lb-search-select__no-content"};function Pi(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",_i,[Object(s["k"])("div",ki,[Object(s["k"])("div",{style:Object(s["x"])(r.isControlVisible),class:"lb-search-select__control-content"},[null!==a.selectedItem?(Object(s["D"])(),Object(s["j"])("div",wi,[Object(s["k"])("span",null,Object(s["M"])(a.selectedItem.name),1),Object(s["n"])(o,{icon:"lb-cancel",onClick:r.removeSelection,class:"lb-search-select__remove-button",size:1.2},null,8,["onClick","size"])])):Object(s["i"])("",!0),null===a.selectedItem?Object(s["U"])((Object(s["D"])(),Object(s["j"])("input",{key:1,type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:n.placeholder,class:"lb-search-select__input",disabled:n.loading},null,8,Di)),[[s["P"],a.value]]):Object(s["i"])("",!0)],4),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0,size:"1.3rem"})):Object(s["i"])("",!0)]),Object(s["U"])(Object(s["k"])("div",Ci,[r.filteredItems.length>0?(Object(s["D"])(),Object(s["j"])("div",Ei,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(r.filteredItems,(e,t)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-search-select__item",key:t,onClick:e=>r.selectItem(t)},[Object(s["k"])("span",Ii,Object(s["M"])(e.name),1)],8,Li))),128))])):Object(s["i"])("",!0),0==r.filteredItems.length?(Object(s["D"])(),Object(s["j"])("div",xi," No items ")):Object(s["i"])("",!0)],512),[[s["Q"],r.isDropdownOpen]])])}var Si={name:"LbSearchSelect",props:{items:{type:Array,default:[]},placeholder:{type:String,default:""},loading:{type:Boolean,default:!1}},emits:["onSelection"],data(){return{selectedItem:null,value:""}},computed:{filteredItems(){return this.value.length>0?this.items.filter(e=>e.name.toLowerCase().includes(this.value.toLowerCase())):this.items},isDropdownOpen(){return null===this.selectedItem&&!this.loading},isControlVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"}},methods:{selectItem(e){this.selectedItem=this.filteredItems[e],this.$emit("onSelection",this.selectedItem.id),this.value=""},removeSelection(){this.selectedItem=null,this.$emit("onSelection",null),this.value=""}}};n("b199");const Ti=w()(Si,[["render",Pi]]);var Ni=Ti,Ui={name:"LoginPage",components:{LbInput:en,LbSearchSelect:Ni},data(){return{username:{value:"",errorMsg:""},password:{value:"",errorMsg:""},loading:!1}},computed:{isButtonDisabled(){return 0===this.username.value.length||0===this.password.value.length},isFormVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"}},methods:{...Object(b["d"])(["setUser"]),...Object(b["b"])("universe",["fetchUserUniverses"]),...Object(b["d"])("notifications",["notify"]),setUsername(e){this.username.value=e,this.username.errorMsg=""},setPassword(e){this.password.value=e,this.password.errorMsg=""},formValidation(){return""==this.password.errorMsg&&""==this.username.errorMsg&&this.password.value.length>0&&this.username.value.length>0},async logIn(){this.loading=!0;let e=Date.now(),t=null;if(this.formValidation()){try{t=await j(this.username.value,this.password.value)}catch(err){this.loading=!1,this.notify({type:"negative",message:err.message})}if(t){let n=Date.now()-e;n<500?setTimeout(async()=>{this.loading=!1,this.setUser(t),await this.fetchUserUniverses(t.id),this.$router.push("/user")},500-n):(this.loading=!1,this.setUser(t),await this.fetchUserUniverses(t.id),this.$router.push("/user"))}}this.loading=!1},async handleEnterPress(e){"Enter"==e.key&&(e.preventDefault(),await this.logIn())}}};n("a0b8");const zi=w()(Ui,[["render",fi]]);var $i=zi;const Ji={class:"user-page"},Mi={class:"user-page__account-section"},qi=Object(s["k"])("div",{class:"account-section__header"},[Object(s["k"])("h2",{class:"account-section__header-text"},"Your Account"),Object(s["k"])("div",{class:"util__horizontal-line--white"})],-1),Bi={class:"account-section__account-data"},Ri={class:"account-section__data-row"},Vi=Object(s["k"])("span",{class:"account-section__data-name"},"Email address: ",-1),Gi={class:"account-section__data-value"},Fi={class:"account-section__data-row"},Ai=Object(s["k"])("span",{class:"account-section__data-name"},"Username: ",-1),Hi={class:"account-section__data-value"},Yi={class:"account-section__data-row"},Ki={class:"user-page__universe-section"},Wi={class:"universe-section__header"},Qi=Object(s["k"])("div",{class:"universe-section__header-part"},null,-1),Xi=Object(s["k"])("div",{class:"universe-section__header-title-part"},[Object(s["k"])("h2",null,"Your Universes")],-1),Zi={class:"universe-section__header-part"},ea={class:"universe-section__universes-table"},ta=Object(s["k"])("tr",{class:"universes-table__row universes-table__row--header"},[Object(s["k"])("th",{class:"universes-table__cell"},"Universe"),Object(s["k"])("th",{class:"universes-table__cell"},"Elements"),Object(s["k"])("th",{class:"universes-table__cell"})],-1),na={class:"universes-table__cell"},sa={class:"universes-table__cell"},ia={class:"universes-table__cell universes-table__cell--button"};function aa(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("router-link"),l=Object(s["J"])("create-universe-popup");return Object(s["D"])(),Object(s["j"])("div",Ji,[Object(s["k"])("section",Mi,[qi,Object(s["k"])("div",Bi,[Object(s["k"])("div",Ri,[Vi,Object(s["k"])("span",Gi,Object(s["M"])(e.email),1)]),Object(s["k"])("div",Fi,[Ai,Object(s["k"])("span",Hi,Object(s["M"])(e.username),1),Object(s["n"])(o,{icon:"lb-edit",size:1.2,disabled:!0},null,8,["size"])]),Object(s["k"])("div",Yi,[Object(s["n"])(o,{icon:"lb-edit",size:1.3,disabled:!0},{default:Object(s["T"])(()=>[Object(s["m"])("Change password")]),_:1},8,["size"])])])]),Object(s["k"])("section",Ki,[Object(s["k"])("div",Wi,[Qi,Xi,Object(s["k"])("div",Zi,[Object(s["n"])(o,{class:"universe-section__create-button",onClick:r.openUniverseCreator,icon:"lb-plus",size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Create New Universe")]),_:1},8,["onClick","size"])])]),Object(s["k"])("table",ea,[ta,(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.universes,e=>(Object(s["D"])(),Object(s["j"])("tr",{class:"universes-table__row",key:e.id},[Object(s["k"])("td",na,[Object(s["n"])(c,{class:"universes-table__link",to:"/universe/"+e.id},{default:Object(s["T"])(()=>[Object(s["m"])(Object(s["M"])(e.name),1)]),_:2},1032,["to"])]),Object(s["k"])("td",sa,[Object(s["k"])("span",null,Object(s["M"])(e.elementCount),1)]),Object(s["k"])("td",ia,[Object(s["n"])(o,{variant:"negative",icon:"lb-trash",onClick:t=>r.deleteUniverse(e.id,e.name)},null,8,["onClick"])])]))),128))])]),a.isCreateUniverseOpen?(Object(s["D"])(),Object(s["h"])(l,{key:0,isOpen:a.isCreateUniverseOpen,onClose:r.closeUniverseCreator,onOnResult:r.onCreateUniverse},null,8,["isOpen","onClose","onOnResult"])):Object(s["i"])("",!0)])}const ra={class:"create-universe-popup__form"},oa={class:"create-universe-popup__buttons"};function ca(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(u,{isOpen:n.isOpen,title:"Create New Universe",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",{class:"create-universe-popup",style:Object(s["x"])(r.setVisibilityOnLoading)},[Object(s["k"])("div",ra,[Object(s["n"])(o,{name:"Title of universe",maxLength:45,value:a.title.value,"onUpdate:value":r.setTitle,error:a.title.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e)},null,8,["value"])]),Object(s["k"])("div",oa,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.create,disabled:!r.isFormValid},{default:Object(s["T"])(()=>[Object(s["m"])("Create")]),_:1},8,["size","onClick","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0,size:"50px"})):Object(s["i"])("",!0)]),_:1},8,["isOpen","onClose"])}var la={components:{LbInput:en},name:"CreateUniversePopup",props:{isOpen:{type:Boolean,default:!1}},emits:["close","onResult"],data(){return{title:{value:"",errorMsg:""},description:"",loading:!1}},computed:{...Object(b["c"])(["userID"]),setVisibilityOnLoading(){return this.loading?"visibility: hidden;":"visibility: visible;"},isFormValid(){return""==this.title.errorMsg&&this.title.value.length>0}},methods:{...Object(b["d"])("notifications",["notify"]),setTitle(e){this.title.errorMsg="",this.title.value=e,e.length<1&&(this.title.errorMsg="Title cannot be empty!")},async create(){this.loading=!0;try{const e=await q({name:this.title.value,description:this.description,userID:this.userID});this.$emit("onResult",e),this.close()}catch(e){this.notify({type:"negative",message:e.message}),this.$emit("onResult",!1)}finally{this.loading=!1}},close(){this.title={value:"",errorMsg:""},this.description="",this.$emit("close")}},unmounted(){this.close()}};n("b721");const ua=w()(la,[["render",ca]]);var da=ua,pa={name:"UserPage",components:{CreateUniversePopup:da},data(){return{isCreateUniverseOpen:!1,universes:[]}},computed:{...Object(b["c"])(["username","email","userID"]),...Object(b["c"])("universe",["userUniverses"])},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("universe",["setUniverse","setUserUniverses","pushUserUniverse","removerUserUniverse"]),openUniverseCreator(){this.isCreateUniverseOpen=!0},closeUniverseCreator(){this.isCreateUniverseOpen=!1},async fetchUserUniverseList(){try{this.universes=await M(this.userID)}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}},async deleteUniverse(e,t){try{if(confirm(`Are you sure that you want delete ${t} universe?`)){const t=await B(e);t&&(this.universes=this.universes.filter(t=>t.id!==e),this.removerUserUniverse(e))}}catch(err){this.notify({type:"negative",message:"Error: "+err.message})}},onCreateUniverse(e){if(e){this.notify({type:"positive",message:"Universe Created"});let t=e;this.pushUserUniverse({id:t.id,name:t.name}),t.elementCount=0,this.universes.push(t),this.isCreateUniverseOpen=!1}}},async mounted(){await this.fetchUserUniverseList()}};n("eb40");const ba=w()(pa,[["render",aa]]);var ha=ba;const ma={class:"universe-page"};function ga(e,t,n,i,a,r){const o=Object(s["J"])("router-view"),c=Object(s["J"])("lb-spinner"),l=Object(s["J"])("categories-popup"),u=Object(s["J"])("universe-element-popup"),d=Object(s["J"])("tags-popup");return Object(s["D"])(),Object(s["j"])("div",ma,[a.loading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(o,{key:0,universeDescriptionProp:a.universeDescription},null,8,["universeDescriptionProp"])),a.loading?(Object(s["D"])(),Object(s["h"])(c,{key:1,size:"40px"})):Object(s["i"])("",!0),e.isCategoriesPopupOpen?(Object(s["D"])(),Object(s["h"])(l,{key:2})):Object(s["i"])("",!0),e.isUniverseElementPopupOpen?(Object(s["D"])(),Object(s["h"])(u,{key:3})):Object(s["i"])("",!0),e.isTagsPopupOpen?(Object(s["D"])(),Object(s["h"])(d,{key:4})):Object(s["i"])("",!0)])}const Oa={class:"categories-popup"},va={class:"categories-popup__form"},ja={class:"categories-popup__categories-table"},ya={class:"categories-table"},fa=Object(s["k"])("thead",null,[Object(s["k"])("tr",{class:"categories-table__row categories-table__row--header"},[Object(s["k"])("th",{class:"categories-table__cell categories-table__cell--header"},"Category"),Object(s["k"])("th",{class:"categories-table__cell categories-table__cell--header"},"Elements"),Object(s["k"])("th",{class:"categories-table__cell categories-table__cell--header"})])],-1),_a={class:"categories-table__cell"},ka=["onClick"],wa={class:"categories-table__cell"},Da={class:"categories-table__cell"},Ca={key:0,class:"categories-table__buttons"};function Ea(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(l,{isOpen:e.isCategoriesPopupOpen,title:"Categories in current universe",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Oa,[Object(s["k"])("div",va,[Object(s["n"])(o,{name:"Name",value:a.categoryName,"onUpdate:value":r.setName,error:a.categoryNameError,maxLength:45},null,8,["value","onUpdate:value","error"]),Object(s["k"])("div",{class:Object(s["w"])(["categories-popup__buttons",r.setButtonsClass])},[null===a.selectedCategory?(Object(s["D"])(),Object(s["h"])(c,{key:0,size:1.2,variant:"positive",icon:"lb-plus",onClick:r.addCategory,disabled:r.disableFormButtons,loading:a.isAddCategoryLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Add new category")]),_:1},8,["size","onClick","disabled","loading"])):Object(s["i"])("",!0),null!==a.selectedCategory?(Object(s["D"])(),Object(s["h"])(c,{key:1,size:1.2,variant:"outline",onClick:r.cancelEdit},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"])):Object(s["i"])("",!0),null!==a.selectedCategory?(Object(s["D"])(),Object(s["h"])(c,{key:2,size:1.2,icon:"lb-edit",onClick:r.renameCategory,disabled:r.disableFormButtons},{default:Object(s["T"])(()=>[Object(s["m"])("Rename")]),_:1},8,["size","onClick","disabled"])):Object(s["i"])("",!0)],2)]),Object(s["k"])("div",ja,[Object(s["k"])("table",ya,[fa,Object(s["k"])("tbody",null,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.categoriesList,e=>(Object(s["D"])(),Object(s["j"])("tr",{class:Object(s["w"])(["categories-table__row",r.isRowEdited(e.id)]),key:e.id},[Object(s["k"])("td",_a,[Object(s["k"])("span",{class:"categories-table__link",onClick:t=>r.navigateToCategory(e.id)},Object(s["M"])(e.name),9,ka)]),Object(s["k"])("td",wa,Object(s["M"])(e.elementCount),1),Object(s["k"])("td",Da,[r.isCategoryMutable(e.id)?(Object(s["D"])(),Object(s["j"])("div",Ca,[Object(s["n"])(c,{size:1.2,icon:"lb-edit",onClick:t=>r.editCategory(e.id)},null,8,["size","onClick"]),Object(s["n"])(c,{size:1.2,icon:"lb-trash",variant:"negative",onClick:t=>r.deleteCategory(e.id),disabled:this.selectedCategory==e.id},null,8,["size","onClick","disabled"])])):Object(s["i"])("",!0)])],2))),128))])])])])]),_:1},8,["isOpen","onClose"])}var La={name:"CategoriesPopup",components:{LbInput:en},props:{},emits:["onResult"],data(){return{categoryName:"",categoryNameError:"",loading:!1,selectedCategory:null,categoriesList:[],isAddCategoryLoading:!1}},computed:{...Object(b["c"])("popups",["isCategoriesPopupOpen"]),...Object(b["c"])("universe",["universeID"]),setButtonsClass(){return null!==this.selectedCategory?"categories-popup__buttons--rename-mode":""},disableFormButtons(){return this.categoryName.length<1||this.categoryNameError.length>0},isCategoryNameValid(){return this.categoryName.length>0&&!this.categoriesList.find(e=>e.name===this.categoryName)}},methods:{...Object(b["d"])("popups",["closeCategoriesPopup"]),...Object(b["d"])("notifications",["notify"]),close(){this.closeCategoriesPopup()},setName(e){this.categoryNameError="",this.categoryName=e},isCategoryMutable(e){return!["Locations","Characters","Events"].includes(e)},isRowEdited(e){return this.selectedCategory==e?"categories-table__row--edited":""},navigateToCategory(e){const t={name:"CategoryElements",params:{categoryID:e}};this.$router.push(t),this.close()},editCategory(e){this.selectedCategory==e?(this.selectedCategory=null,this.categoryName=""):(this.selectedCategory=e,this.categoryName=this.categoriesList.find(t=>t.id==e).name)},cancelEdit(){this.selectedCategory=null,this.categoryName=""},async addCategory(){if(this.isCategoryNameValid){this.isAddCategoryLoading=!0;try{const e=await Mn({name:this.categoryName,universeID:this.universeID});this.categoriesList.push({id:e.id,name:this.categoryName,elementCount:0}),this.categoryName=""}catch(e){this.notify({type:"negative",message:e.message})}finally{this.isAddCategoryLoading=!1}}else this.categoryNameError="Category with that name already exists"},async renameCategory(){if(this.isCategoryNameValid)try{await qn(this.selectedCategory,this.categoryName),this.categoriesList.find(e=>e.id==this.selectedCategory).name=this.categoryName,this.selectedCategory=null,this.categoryName=""}catch(e){this.notify({type:"negative",message:e.message})}else this.categoryNameError="Category with that name already exists"},async deleteCategory(e){if(confirm("Do you really want to delete this category? You will lose all elements belonging in this category. It cannot be undone!"))try{await Bn(e),this.categoriesList=this.categoriesList.filter(t=>t.id!==e),this.$route.params.categoryID&&this.$route.params.categoryID==e&&(this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}}),this.close())}catch(t){this.notify({type:"negative",message:t.message})}}},async mounted(){try{this.categoriesList=await Jn(this.universeID)}catch(e){this.notify({type:"negative",message:e.message})}},unmounted(){this.closeCategoriesPopup()}};n("7f1f");const Ia=w()(La,[["render",Ea]]);var xa=Ia;const Pa={class:"universe-element-popup"},Sa=Object(s["k"])("h2",{class:"universe-element-popup__field-title"},"Type of element",-1),Ta={key:0,class:"universe-element-popup__specific-row universe-element-popup__specific-row--events"},Na={key:1,class:"universe-element-popup__specific-row"},Ua=Object(s["k"])("h2",{class:"universe-element-popup__field-title"},"Parent Location",-1),za={class:"universe-element-popup__buttons"};function $a(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-select"),l=Object(s["J"])("lb-search-select"),u=Object(s["J"])("lb-button"),d=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(d,{isOpen:e.isUniverseElementPopupOpen,title:"Create new element in Universe",onClose:e.closeUniverseElementPopup},{default:Object(s["T"])(()=>[Object(s["k"])("div",Pa,[Object(s["n"])(o,{name:"Title",value:a.name,"onUpdate:value":t[0]||(t[0]=e=>a.name=e),maxLength:60},null,8,["value"]),Object(s["k"])("div",null,[Sa,Object(s["n"])(c,{items:a.categories,width:"100%",placeholder:"Select type of new element",onHandleSelection:r.selectCategory},null,8,["items","onHandleSelection"])]),"Events"==a.selectedCategory?(Object(s["D"])(),Object(s["j"])("div",Ta,[Object(s["n"])(o,{name:"Year",type:"number",value:a.eventDate.year,"onUpdate:value":t[1]||(t[1]=e=>a.eventDate.year=e)},null,8,["value"]),Object(s["n"])(o,{name:"Month",type:"number","onChange:value":r.setEventMonth,value:a.eventDate.month,"onUpdate:value":t[2]||(t[2]=e=>a.eventDate.month=e)},null,8,["onChange:value","value"]),Object(s["n"])(o,{name:"Day",type:"number","onChange:value":r.setEventDay,value:a.eventDate.day,"onUpdate:value":t[3]||(t[3]=e=>a.eventDate.day=e)},null,8,["onChange:value","value"])])):Object(s["i"])("",!0),"Locations"==a.selectedCategory?(Object(s["D"])(),Object(s["j"])("div",Na,[Ua,Object(s["n"])(l,{placeholder:"Select parent locations...",items:a.locations,loading:a.areLocationsLoading,onOnSelection:r.selectLocation},null,8,["items","loading","onOnSelection"])])):Object(s["i"])("",!0),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[4]||(t[4]=e=>a.description=e),maxLength:250},null,8,["value"]),Object(s["k"])("div",za,[Object(s["n"])(u,{variant:"outline",size:1.4,onClick:e.closeUniverseElementPopup},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(u,{variant:"positive",size:1.4,onClick:r.createElement,disabled:r.isCreateButtonDisabled,loading:a.createLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Create Element")]),_:1},8,["size","onClick","disabled","loading"])])])]),_:1},8,["isOpen","onClose"])}var Ja={name:"UniverseElementPopup",components:{LbPopupBox:ui,LbInput:en,LbSelect:pn,LbSearchSelect:Ni},emits:["onResult"],data(){return{name:"",description:"",selectedCategory:null,categories:[],createLoading:!1,eventDate:{year:0,month:1,day:1},locations:[],parentLocation:null,areLocationsLoading:!1,fetchLocationsFlag:!1}},computed:{...Object(b["c"])("popups",["isUniverseElementPopupOpen"]),...Object(b["c"])("universe",["universeID"]),isCreateButtonDisabled(){return null==this.selectedCategory||this.name.length<1}},methods:{...Object(b["d"])("popups",["closeUniverseElementPopup"]),...Object(b["d"])("notifications",["notify"]),resetForm(){this.name="",this.description="",this.selectedCategory=null,this.eventDate={year:0,month:1,day:1},this.parentLocation=null},async selectCategory(e){this.selectedCategory=e.length?e[0].id:null,"Locations"==this.selectedCategory?(this.parentLocation=null,this.fetchLocationsFlag||(await this.fetchLocations(),this.fetchLocationsFlag=!0)):"Events"==this.selectedCategory&&(this.eventDate={year:0,month:1,day:1})},async createElement(){this.createLoading=!0;try{let e=null;e="Events"==this.selectedCategory?await ls(this.name,this.description,this.eventDate,this.universeID):"Locations"==this.selectedCategory?await ss(this.name,this.description,this.universeID,this.parentLocation):"Characters"==this.selectedCategory?await An(this.name,this.description,this.universeID):await Qn(this.name,this.description,this.selectedCategory),e&&(this.notify({type:"positive",message:"Successfully created "+e.name}),this.$emit("onResult",{result:e,type:this.selectedCategory}),this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.selectedCategory,elementID:e.id}}),this.closeUniverseElementPopup())}catch(e){this.notify({type:"negative",message:e.message})}finally{this.createLoading=!1}},setEventMonth(e){this.eventDate.month=e>12?12:e<1?1:e},setEventDay(e){this.eventDate.day=e>31?31:e<1?1:e},async fetchLocations(){this.areLocationsLoading=!0;try{this.locations=await is(this.universeID)}catch(e){this.notify({type:"negative",message:e.message})}finally{this.areLocationsLoading=!1}},selectLocation(e){this.parentLocation=e}},async mounted(){try{const e=[{id:"Characters",name:"Characters"},{id:"Locations",name:"Locations"},{id:"Events",name:"Events"}],t=await $n(this.universeID);this.categories.push(...e,...t)}catch(e){this.notify({type:"negative",message:e.message})}},unmounted(){this.closeUniverseElementPopup()}};n("5b96");const Ma=w()(Ja,[["render",$a]]);var qa=Ma;const Ba={class:"tags-popup"},Ra={class:"tags-popup__row"},Va={key:0,class:"tags-popup__edit-form"},Ga={class:"tags-popup__form-buttons"},Fa={key:0,class:"tags-popup__row"},Aa={class:"tags-popup__tag-table"},Ha={class:"tag-table"},Ya=Object(s["k"])("thead",null,[Object(s["k"])("tr",{class:"tag-table__row tag-table__row--header"},[Object(s["k"])("th",{class:"tag-table__cell tag-table__cell--header"},"Tag Name"),Object(s["k"])("th",{class:"tag-table__cell tag-table__cell--header"},"Tagged Elements"),Object(s["k"])("th",{class:"tag-table__cell tag-table__cell--header"})])],-1),Ka={class:"tag-table__cell"},Wa={class:"tag-table__tag-name"},Qa={class:"tag-table__cell"},Xa={class:"tag-table__cell"},Za={class:"tag-table__buttons"},er={key:1,class:"tags-popup__no-content"},tr=Object(s["k"])("h3",{class:"tags-popup__no-content-header"},"No results",-1),nr=Object(s["k"])("span",null,"If you want to see searched tags here, you should add them to universe elements",-1),sr=[tr,nr],ir={key:2,class:"tags-popup__row"};function ar(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-search-bar"),u=Object(s["J"])("lb-page-nav"),d=Object(s["J"])("lb-spinner"),p=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(p,{isOpen:e.isTagsPopupOpen,title:"Tags in current universe",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Ba,[Object(s["k"])("div",{class:"tags-popup__content",style:Object(s["x"])(r.tagsLoadingVisibility)},[Object(s["k"])("div",Ra,[a.selectedTag?(Object(s["D"])(),Object(s["j"])("div",Va,[Object(s["n"])(o,{name:"Tag Name",value:a.tagName,"onUpdate:value":r.setTagName,error:a.tagNameError,maxLength:60},null,8,["value","onUpdate:value","error"]),Object(s["k"])("div",Ga,[Object(s["n"])(c,{size:1.2,variant:"outline",onClick:r.cancelEdit},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{size:1.2,icon:"lb-edit",onClick:r.renameTag,loading:a.renameLoading,disabled:r.disableRenameButton},{default:Object(s["T"])(()=>[Object(s["m"])("Rename Tag")]),_:1},8,["size","onClick","loading","disabled"])])])):Object(s["i"])("",!0),a.selectedTag?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(l,{key:1,placeholder:"Search tag by name...",onSearch:r.search,text:a.searchText},null,8,["onSearch","text"]))]),0!==a.tagList.length?(Object(s["D"])(),Object(s["j"])("div",Fa,[Object(s["k"])("div",Aa,[Object(s["k"])("table",Ha,[Ya,Object(s["k"])("tbody",null,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.tagList,e=>(Object(s["D"])(),Object(s["j"])("tr",{class:Object(s["w"])(["tag-table__row",r.isRowEdited(e.id)]),key:e.id},[Object(s["k"])("td",Ka,[Object(s["k"])("span",Wa,Object(s["M"])(e.name),1)]),Object(s["k"])("td",Qa,Object(s["M"])(e.elementCount),1),Object(s["k"])("td",Xa,[Object(s["k"])("div",Za,[Object(s["n"])(c,{size:1.2,icon:"lb-edit",onClick:t=>r.editTag(e.id)},null,8,["size","onClick"]),Object(s["n"])(c,{size:1.2,icon:"lb-trash",variant:"negative",onClick:t=>r.removeTag(e.id),disabled:a.selectedTag==e.id},null,8,["size","onClick","disabled"])])])],2))),128))])])])])):Object(s["i"])("",!0),0==a.tagList.length?(Object(s["D"])(),Object(s["j"])("div",er,sr)):Object(s["i"])("",!0),null===a.selectedTag?(Object(s["D"])(),Object(s["j"])("div",ir,[Object(s["n"])(u,{currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage,class:"tags-popup__page-nav"},null,8,["currentPage","totalPages","onGo"])])):Object(s["i"])("",!0)],4),a.tagsLoading?(Object(s["D"])(),Object(s["h"])(d,{key:0})):Object(s["i"])("",!0)])]),_:1},8,["isOpen","onClose"])}async function rr(e,t,n){return await v.post("/tags/content",{name:e,contentID:t,universeID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function or(e){return await v.delete("/tags/"+e).then(e=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function cr(e,t){return await v.delete(`/tags/${e}/content/${t}`).then(e=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function lr(e,t,n,s){const i=encodeURIComponent(t);return await v.get(`/tags/search/list/${e}/?q=${i}&limit=${n}&offset=${s}`).then(e=>{const t={elements:e.data.rows,totalPages:Math.ceil(e.data.count/n)};return t}).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ur(e,t){return await v.patch("/tags/"+e,{name:t}).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var dr={name:"TagsPopup",components:{LbSearchBar:En,LbInput:en,LbPageNav:zn},data(){return{tagList:[],tagsLoading:!1,renameLoading:!1,searchText:"",tagName:"",tagNameError:"",selectedTag:null,currentPage:1,totalPages:2}},computed:{...Object(b["c"])("popups",["isTagsPopupOpen"]),...Object(b["c"])("universe",["universeID"]),tagsLoadingVisibility(){return this.tagsLoading?"visibility: hidden;":"visibility: visible"},disableRenameButton(){return this.tagName.length<1||this.tagNameError.length>0}},methods:{...Object(b["d"])("popups",["closeTagsPopup"]),...Object(b["d"])("notifications",["notify"]),close(){this.closeTagsPopup()},isRowEdited(e){return this.selectedTag==e?"tag-table__row--edited":""},editTag(e){this.selectedTag==e?(this.selectedTag=null,this.tagName=""):(this.selectedTag=e,this.tagName=this.tagList.find(t=>t.id==e).name)},async fetchTagList(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e,this.searchText=e;const s=25;this.tagsLoading=!0;try{const t=0!==n?n*s-s:0,i=await lr(this.universeID,e,s,t);this.tagList=i.elements,this.totalPages=i.totalPages}catch(i){this.notify({type:"negative",message:"Error: "+err.message})}finally{this.tagsLoading=!1}},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchTagList(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},setTagName(e){this.tagNameError="",this.tagName=e},cancelEdit(){this.tagName="",this.tagNameError="",this.selectedTag=null},async renameTag(){try{this.renameLoading=!0,await ur(this.selectedTag,this.tagName),this.tagList.find(e=>e.id==this.selectedTag).name=this.tagName,this.selectedTag=null,this.tagName=""}catch(e){this.tagNameError=e.message}finally{this.renameLoading=!1}},async removeTag(e){try{await or(e),this.tagList=this.tagList.filter(t=>t.id!==e),await this.fetchTagList(this.searchText,this.currentPage)}catch(t){this.notify({type:"negative",message:t.message})}}},async mounted(){await this.fetchTagList("",1)},unmounted(){this.closeTagsPopup()}};n("a808");const pr=w()(dr,[["render",ar]]);var br=pr,hr={name:"UniversePage",components:{CategoriesPopup:xa,UniverseElementPopup:qa,TagsPopup:br},data(){return{universeDescription:"",loading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),...Object(b["c"])("popups",["isCategoriesPopupOpen","isUniverseElementPopupOpen","isTagsPopupOpen"])},methods:{...Object(b["d"])("universe",["setUniverse","setUniverseName"]),...Object(b["d"])("notifications",["notify"])},async mounted(){const e=this.$route.params.universeID;this.loading=!0;try{const t=await R(e);this.setUniverse({id:t.id,name:t.name}),this.universeDescription=t.description}catch(err){this.notify({type:"negative",message:"Error: "+err.message}),this.$route.replace({name:"User"})}finally{this.loading=!1}}};n("6de2");const mr=w()(hr,[["render",ga]]);var gr=mr;const Or={class:"universe-main-page"},vr={class:"universe-main-page__header"},jr=Object(s["k"])("label",{class:"universe-main-page__header-label"},"Description",-1),yr={class:"universe-main-page__content-swapper"},fr={key:0,class:"universe-main-page__dynamic-content"};function _r(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-content-swapper");return Object(s["D"])(),Object(s["j"])("div",Or,[Object(s["k"])("div",vr,[Object(s["n"])(o,{value:e.universeName,maxLength:45,customClass:"universe-main-page__title",onOnSave:r.changeUniverseTitle},null,8,["value","onOnSave"]),jr,Object(s["n"])(o,{value:a.universeDescription,maxLength:1e3,type:"textarea",customClass:"universe-main-page__description",onOnSave:r.changeDescription,noContent:"No description"},null,8,["value","onOnSave"])]),Object(s["k"])("div",yr,[Object(s["n"])(c,{options:a.contentOptions,activeOption:a.activeOption,onOnSelect:r.changeContent},null,8,["options","activeOption","onOnSelect"])]),e.universeID?(Object(s["D"])(),Object(s["j"])("div",fr,[(Object(s["D"])(),Object(s["h"])(Object(s["K"])(a.activeOption)))])):Object(s["i"])("",!0)])}const kr={class:"lb-content-swapper"},wr=["disabled","onClick"];function Dr(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",kr,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.options,e=>(Object(s["D"])(),Object(s["j"])("button",{class:Object(s["w"])(["lb-content-swapper__option",r.setActiveClass(e.key)]),key:e.key,disabled:e.disabled||e.key==n.activeOption,onClick:t=>r.selectOption(e.key)},Object(s["M"])(e.name),11,wr))),128))])}var Cr={name:"LbContentSwapper",props:{options:{type:Array,required:!0},activeOption:{type:String,default:null}},emits:["onSelect"],methods:{selectOption(e){this.$emit("onSelect",e)},setActiveClass(e){return this.activeOption==e?"lb-content-swapper__option--active":""}}};n("ffae");const Er=w()(Cr,[["render",Dr]]);var Lr=Er;const Ir={class:"universe-elements"},xr={class:"universe-elements__loading"},Pr={key:0,class:"universe-elements__no-content"};function Sr(e,t,n,i,a,r){const o=Object(s["J"])("lb-spinner"),c=Object(s["J"])("lb-universe-element-list");return Object(s["D"])(),Object(s["j"])("div",Ir,[Object(s["k"])("div",xr,[a.loading?(Object(s["D"])(),Object(s["h"])(o,{key:0})):Object(s["i"])("",!0)]),(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.elementLists,e=>(Object(s["D"])(),Object(s["j"])("div",{class:"universe-elements__list",key:e.id},[Object(s["n"])(c,{categoryID:e.id,title:e.name,elements:e.elements,elementCount:e.elementCount,footerLink:e.elementCount>3},null,8,["categoryID","title","elements","elementCount","footerLink"])]))),128)),0==a.elementLists.length?(Object(s["D"])(),Object(s["j"])("div",Pr," No elements in this universe ")):Object(s["i"])("",!0)])}const Tr={class:"lb-universe-element-list"},Nr={class:"lb-universe-element-list__header"},Ur=Object(s["k"])("span",{class:"lb-universe-element-list__vertical-line"},null,-1),zr={class:"lb-universe-element-list__count"},$r=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Jr={class:"lb-universe-element-list__element-header"},Mr=["onClick"],qr={class:"lb-universe-element-list__element-date"},Br={key:0,class:"lb-universe-element-list__element-button"},Rr=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Vr={key:0,class:"lb-universe-element-list__footer"};function Gr(e,t,n,i,a,r){const o=Object(s["J"])("router-link"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",Tr,[Object(s["k"])("div",{class:"lb-universe-element-list__body",style:Object(s["x"])(r.isContentVisible)},[Object(s["k"])("div",Nr,[Object(s["n"])(o,{to:r.categoryLink,class:"lb-universe-element-list__title"},{default:Object(s["T"])(()=>[Object(s["m"])(Object(s["M"])(n.title),1)]),_:1},8,["to"]),Ur,Object(s["k"])("span",zr,Object(s["M"])(r.elementCountText),1)]),$r,(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.elements,e=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-universe-element-list__element",key:e.id},[Object(s["k"])("div",Jr,[Object(s["k"])("h4",{onClick:t=>r.navigateToElement(e.id),class:"lb-universe-element-list__element-name"},Object(s["M"])(e.name),9,Mr),Object(s["k"])("span",qr,Object(s["M"])(r.formatDate(e.last_modified)),1),n.interactive?(Object(s["D"])(),Object(s["j"])("div",Br,[Object(s["n"])(c,{variant:"negative",icon:"lb-trash",size:1,onClick:t=>r.deleteElement(e.id,e.catID)},null,8,["onClick"])])):Object(s["i"])("",!0)]),Object(s["k"])("p",{class:Object(s["w"])(["lb-universe-element-list__description",e.description.length?"":"lb-universe-element-list__description--empty"])},Object(s["M"])(e.description.length?e.description:"No description"),3),Rr]))),128)),n.footerLink?(Object(s["D"])(),Object(s["j"])("div",Vr,[Object(s["n"])(o,{to:r.categoryLink,class:"lb-universe-element-list__link"},{default:Object(s["T"])(()=>[Object(s["m"])("see more elements...")]),_:1},8,["to"])])):Object(s["i"])("",!0)],4),n.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0})):Object(s["i"])("",!0)])}var Fr=n("b166"),Ar={name:"LbUniverseElementList",emits:["onDelete"],props:{categoryID:{type:String,required:!0},title:{type:String,required:!0},elements:{type:Array,default:[]},footerLink:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},elementCount:{type:Number},interactive:{type:Boolean}},computed:{...Object(b["c"])("universe",["universeID"]),elementCountText(){return 1==this.elementCount?this.elementCount+" element":this.elementCount+" elements"},isContentVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"},categoryLink(){return{name:"CategoryElements",params:{categoryID:this.categoryID}}}},methods:{formatDate(e){const t=new Date(e),n=Object(Fr["a"])(t,"dd.MM.yyyy hh:mm");return"Last modified: "+n},deleteElement(e){this.$emit("onDelete",{id:e,categoryID:this.categoryID})},navigateToElement(e){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.categoryID,elementID:e}})}}};n("6677");const Hr=w()(Ar,[["render",Gr]]);var Yr=Hr;async function Kr(e){return await v.get("/search/shortLists/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}function Wr(e){return e.map(e=>({id:e.id,name:e.name,lastModified:e.last_modified,categoryID:e.Category_id,categoryName:e.categoryName}))}async function Qr(e,t,n,s,i,a){let r=[];if(n&&n.length>0){const e=n.map(e=>{const t=encodeURIComponent(e);return"&categories="+t});e.forEach(e=>r.push(e))}if(s&&s.length>0){const e=s.map(e=>{const t=encodeURIComponent(e);return"&tags="+t});e.forEach(e=>r.push(e))}let o="";r.length>0&&r.forEach(e=>{o=`${o}${e}`});const c=encodeURIComponent(t||"");return await v.get(`/search/${e}/?q=${c}${o}&limit=${i}&offset=${a}`).then(e=>{const t={elements:Wr(e.data.rows),totalPages:Math.ceil(e.data.count/i)};return t}).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var Xr={components:{LbUniverseElementList:Yr},name:"UniverseElements",data(){return{elementLists:[],loading:!1}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{...Object(b["d"])("notifications",["notify"]),async fetchElementLists(){this.loading=!0;try{this.elementLists=await Kr(this.universeID),this.elementLists=this.elementLists.filter(e=>e.elementCount).sort((e,t)=>t.elements[0].last_modified>e.elements[0].last_modified?1:t.elements[0].last_modified<e.elements[0].last_modified?-1:0)}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.loading=!1}}},async mounted(){await this.fetchElementLists()}};n("8c2e");const Zr=w()(Xr,[["render",Sr]]);var eo=Zr;const to={class:"universe-stories"},no={class:"universe-stories__header"},so=Object(s["k"])("div",{class:"universe-stories__header-part"},null,-1),io=Object(s["k"])("div",{class:"universe-stories__header-part universe-stories__header-part--title"}," Your Stories ",-1),ao={class:"universe-stories__header-part"},ro={class:"universe-stories__list"},oo=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),co={key:0,class:"universe-stories__list--no-content"};function lo(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-story-element"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("create-story-popup");return Object(s["D"])(),Object(s["j"])("div",to,[Object(s["k"])("div",no,[so,io,Object(s["k"])("div",ao,[Object(s["n"])(o,{icon:"lb-plus",size:1.2,onClick:r.openPopup},{default:Object(s["T"])(()=>[Object(s["m"])("Create new Story")]),_:1},8,["size","onClick"])])]),Object(s["k"])("div",ro,[oo,Object(s["k"])("div",{class:"universe-stories__list-elements",style:Object(s["x"])(r.storiesListVisibility)},[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.storiesList,(e,t)=>(Object(s["D"])(),Object(s["h"])(c,{key:t,id:e.id,title:e.title,initDescription:e.description,chapterCount:e.chapterCount,onOnDelete:r.removeStory},null,8,["id","title","initDescription","chapterCount","onOnDelete"]))),128)),0==a.storiesList.length?(Object(s["D"])(),Object(s["j"])("div",co," No Stories in this Universe ")):Object(s["i"])("",!0)],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0})):Object(s["i"])("",!0)]),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(u,{key:0,isOpen:a.isPopupOpen,onClose:r.closePopup,onOnResult:r.addStory},null,8,["isOpen","onClose","onOnResult"])):Object(s["i"])("",!0)])}const uo={class:"create-story-popup__form"},po={class:"create-story-popup__buttons"};function bo(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(u,{isOpen:n.isOpen,title:"Create Story",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",{class:"create-story-popup",style:Object(s["x"])(r.setVisibilityOnLoading)},[Object(s["k"])("div",uo,[Object(s["n"])(o,{name:"Story Title",maxLength:80,value:a.title.value,"onUpdate:value":r.setTitle,error:a.title.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e),maxLength:500},null,8,["value"])]),Object(s["k"])("div",po,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.create,disabled:!r.isFormValid},{default:Object(s["T"])(()=>[Object(s["m"])("Create")]),_:1},8,["size","onClick","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0,size:"50px"})):Object(s["i"])("",!0)]),_:1},8,["isOpen","onClose"])}async function ho(e){return await v.get("/stories/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new NotFoundException(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function mo({title:e,description:t,universeID:n}){return await v.post("/stories",{title:e,description:t,universeID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function go(e){return await v.get(`/stories/universe/${e}/list`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Oo(e,t){return await v.patch("/stories/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function vo(e){return await v.delete("/stories/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var jo={name:"CreateStoryPopup",components:{LbInput:en},props:{isOpen:{type:Boolean,default:!1}},emits:["close","onResult"],data(){return{title:{value:"",errorMsg:""},description:"",loading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),setVisibilityOnLoading(){return this.loading?"visibility: hidden;":"visibility: visible;"},isFormValid(){return""==this.title.errorMsg&&this.title.value.length>0}},methods:{...Object(b["d"])("notifications",["notify"]),setTitle(e){this.title.errorMsg="",this.title.value=e,e.length<1&&(this.title.errorMsg="Title cannot be empty!")},async create(){this.loading=!0;try{const e=await mo({title:this.title.value,description:this.description,universeID:this.universeID});this.$emit("onResult",e),this.close()}catch(e){this.notify({type:"negative",message:e.message})}finally{this.loading=!1}},close(){this.title={value:"",errorMsg:""},this.description="",this.$emit("close")}}};n("6516");const yo=w()(jo,[["render",bo]]);var fo=yo;const _o={class:"lb-story-element"},ko={class:"lb-story-element__header"},wo={class:"lb-story-element__header-part"},Do=Object(s["k"])("span",{class:"lb-story-element__vertical-line"},null,-1),Co={class:"lb-story-element__count"},Eo={class:"lb-story-element__header-part"},Lo=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Io={class:"lb-story-element__content"},xo=Object(s["k"])("label",{class:"lb-story-element__description-label"}," Description ",-1);function Po(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-editable-text");return Object(s["D"])(),Object(s["j"])("div",_o,[Object(s["k"])("div",ko,[Object(s["k"])("div",wo,[Object(s["k"])("span",{class:"lb-story-element__link",onClick:t[0]||(t[0]=(...e)=>r.navigateToStory&&r.navigateToStory(...e))},Object(s["M"])(n.title),1),Do,Object(s["k"])("span",Co,Object(s["M"])(r.chapterCountText),1)]),Object(s["k"])("div",Eo,[Object(s["n"])(o,{variant:"negative",icon:"lb-trash",size:1.05,onClick:r.deleteStory,class:"lb-story-element__delete-btn"},null,8,["size","onClick"])])]),Lo,Object(s["k"])("div",Io,[xo,Object(s["n"])(c,{maxLength:500,noContent:"No Description",type:"textarea",width:"100%",value:a.description,onOnSave:r.changeDescription},null,8,["value","onOnSave"])])])}var So={name:"LbStoryElement",components:{LbEditableText:Be},emits:["onDelete"],props:{id:{type:Number,required:!0},title:{type:String,required:!0},initDescription:{type:String,default:""},chapterCount:{type:Number,default:0}},data(){return{description:this.initDescription}},computed:{...Object(b["c"])("universe",["universeID"]),navigateToStory(){this.$router.push({name:"StoryChaptersPage",params:{universeID:this.universeID,storyID:this.id}})},chapterCountText(){return this.chapterCount+" Chapters"}},methods:{...Object(b["d"])("notifications",["notify"]),async changeDescription(e){try{await Oo(this.id,{description:e}),this.description=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},deleteStory(){this.$emit("onDelete",this.id)}}};n("c446");const To=w()(So,[["render",Po]]);var No=To,Uo={name:"UniverseStories",components:{CreateStoryPopup:fo,LbStoryElement:No},data(){return{loading:!1,storiesList:[],isPopupOpen:!1}},computed:{...Object(b["c"])("universe",["universeID"]),storiesListVisibility(){return this.loading?"visibility: hidden;":""}},methods:{...Object(b["d"])("notifications",["notify"]),openPopup(){this.isPopupOpen=!0},closePopup(){this.isPopupOpen=!1},addStory(e){const t={...e};t.chapterCount=0,this.storiesList.push(t)},async removeStory(e){const t=this.storiesList.find(t=>t.id===e).chapterCount;try{t>0?confirm("Do you really want delete this story? This cannot be undone.")&&(await vo(e),this.storiesList=this.storiesList.filter(t=>t.id!==e)):(await vo(e),this.storiesList=this.storiesList.filter(t=>t.id!==e))}catch(n){this.notify({type:"negative",message:"Error: "+n.message})}},async fetchListOfStories(){try{this.loading=!0,this.storiesList=await go(this.universeID)}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.loading=!1}}},async mounted(){await this.fetchListOfStories()}};n("f9d1");const zo=w()(Uo,[["render",lo]]);var $o=zo,Jo={name:"UnivereseMainPage",components:{LbContentSwapper:Lr,LbEditableText:Be,UniverseElements:eo,UniverseStories:$o},props:{universeDescriptionProp:{type:String}},data(){return{universeDescription:this.universeDescriptionProp,contentOptions:[{name:"Elements",key:"universe-elements"},{name:"Stories",key:"universe-stories"}],activeOption:"universe-elements"}},computed:{...Object(b["c"])("universe",["universeName","universeID"])},methods:{...Object(b["d"])("universe",["setUniverse","setUniverseName"]),...Object(b["d"])("notifications",["notify"]),changeContent(e){this.activeOption=e},async changeUniverseTitle(e){try{await V(this.universeID,{name:e}).then(()=>{this.setUniverseName(e)})}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async changeDescription(e){try{await V(this.universeID,{description:e}).then(()=>{this.universeDescription=e})}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}}}};n("ccbd");const Mo=w()(Jo,[["render",_r]]);var qo=Mo;const Bo={class:"lb-universe-nav"},Ro=Object(s["k"])("div",{class:"lb-universe-nav__universe-button-header"},[Object(s["k"])("span",null,"Universe"),Object(s["k"])("div",{class:"util__horizontal-line--white"})],-1),Vo={class:"lb-universe-nav__universe-link"},Go=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Create Element",-1),Fo=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Categories",-1),Ao=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Tags",-1),Ho=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Search",-1);function Yo(e,t,n,i,a,r){const o=Object(s["J"])("router-link"),c=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",Bo,[Object(s["n"])(o,{class:"lb-universe-nav__universe-button",to:"/universe/"+e.universeID},{default:Object(s["T"])(()=>[Ro,Object(s["k"])("span",Vo,Object(s["M"])(e.universeName),1)]),_:1},8,["to"]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[0]||(t[0]=(...t)=>e.openUniverseElementPopup&&e.openUniverseElementPopup(...t))},[Object(s["n"])(c,{icon:"lb-plus-square"}),Go]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[1]||(t[1]=(...t)=>e.openCategoriesPopup&&e.openCategoriesPopup(...t))},[Object(s["n"])(c,{icon:"lb-folder"}),Fo]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[2]||(t[2]=(...t)=>e.openTagsPopup&&e.openTagsPopup(...t))},[Object(s["n"])(c,{icon:"lb-tags"}),Ao]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[3]||(t[3]=(...e)=>r.navigateToSearch&&r.navigateToSearch(...e))},[Object(s["n"])(c,{icon:"lb-search"}),Ho])])}var Ko={name:"LbUniverseNav",computed:{...Object(b["c"])("universe",["universeName","universeID"])},methods:{...Object(b["d"])("popups",["openCategoriesPopup","openUniverseElementPopup","openTagsPopup"]),navigateToSearch(){this.$router.push({name:"SearchPage",params:{universeID:this.universeID}})}}};n("5376");const Wo=w()(Ko,[["render",Yo]]);var Qo=Wo;const Xo={class:"category-page"};function Zo(e,t,n,i,a,r){const o=Object(s["J"])("router-view");return Object(s["D"])(),Object(s["j"])("div",Xo,[this.loading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(o,{key:0,categoryName:a.categoryName},null,8,["categoryName"]))])}function ec(e){return["Locations","Characters","Events"].includes(e)}var tc={name:"CategoryPage",props:{universeID:String},data(){return{loading:!0,categoryName:""}},methods:{...Object(b["d"])("notifications",["notify"]),async fetchCategory(e){this.loading=!0;try{if(ec(e))this.categoryName=e;else{const t=await Rn(e);if(this.universeID!=t.Universe_id)throw new Error("This category does not belong to this universe");this.categoryName=t.name}this.loading=!1}catch(err){this.notify({type:"negative",message:"Error: "+err.message}),this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}})}}},async mounted(){await this.fetchCategory(this.$route.params.categoryID)},async beforeRouteUpdate(e,t){await this.fetchCategory(e.params.categoryID)}};n("0b1d");const nc=w()(tc,[["render",Zo]]);var sc=nc;const ic={class:"category-elements-page"},ac={class:"category-elements-page__search-section"},rc={class:"category-elements-page__results"};function oc(e,t,n,i,a,r){const o=Object(s["J"])("lb-search-bar"),c=Object(s["J"])("lb-universe-element-list"),l=Object(s["J"])("lb-page-nav");return Object(s["D"])(),Object(s["j"])("div",ic,[Object(s["k"])("div",ac,[Object(s["n"])(o,{placeholder:"Search elements in "+n.categoryName,onSearch:r.search,text:a.searchText},null,8,["placeholder","onSearch","text"])]),Object(s["k"])("div",rc,[Object(s["n"])(c,{categoryID:n.categoryID,title:n.categoryName,elements:a.elements,elementCount:a.elementCount,footerLink:!1,interactive:!0,loading:a.loading,onOnDelete:r.deleteElement},null,8,["categoryID","title","elements","elementCount","loading","onOnDelete"]),r.isPageNavNeeded?(Object(s["D"])(),Object(s["h"])(l,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)])])}var cc={components:{LbSearchBar:En,LbUniverseElementList:Yr,LbPageNav:zn},name:"CategoryElementsPage",props:{categoryID:{type:String},categoryName:{type:String}},data(){return{elements:[],elementCount:0,currentPage:1,totalPages:1,loading:!1,searchText:""}},computed:{...Object(b["c"])("universe",["universeID"]),isPageNavNeeded(){return!this.loading&&this.totalPages>1}},methods:{...Object(b["d"])("notifications",["notify"]),async fetchElements(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=50;this.loading=!0;try{const t=0!==n?n*s-s:0,i=await hs(this.universeID,e,s,t,this.categoryID);this.elementCount=i.elementCount,this.elements=i.elements,this.totalPages=i.totalPages}catch(i){this.notify({type:"negative",message:"Error: "+i.message})}finally{this.loading=!1}},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchElements(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},async deleteElement({id:e,categoryID:t}){if(confirm("Are yo sure that you want delete this element?")){this.loading=!0;try{let n=null;switch(t){case"Locations":n=await rs(e);break;case"Characters":n=await Yn(e);break;case"Events":n=await ds(e);break;default:n=await Zn(e);break}n&&(this.notify({type:"positive",message:"Successfully deleted element"}),await this.search(this.searchText))}catch(n){this.notify({type:"negative",message:"Error: "+n.message})}finally{this.loading=!1}}}},watch:{async categoryID(){this.searchText="",this.currentPage=1,await this.fetchElements("",0)}},async mounted(){await this.fetchElements("",0)}};n("cfe2");const lc=w()(cc,[["render",oc]]);var uc=lc;const dc={class:"element-page"},pc={class:"element-page__side-panel"},bc={class:"side-panel__info"},hc=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),mc={class:"side-panel__header-text"},gc={class:"side-panel__bottom-button"},Oc={class:"element-page__content"};function vc(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("icon"),l=Object(s["J"])("lb-tag-container"),u=Object(s["J"])("lb-spinner"),d=Object(s["J"])("lb-button"),p=Object(s["J"])("lb-content");return Object(s["D"])(),Object(s["j"])("div",dc,[Object(s["k"])("div",pc,[Object(s["k"])("div",bc,[Object(s["k"])("div",{class:"side-panel__info-content",style:Object(s["x"])(r.sideInfoVisibility)},[Object(s["n"])(o,{value:a.name,maxLength:60,width:"100%",onOnSave:r.saveName,customClass:"side-panel__title"},null,8,["value","onOnSave"]),hc,Object(s["n"])(o,{value:a.description,maxLength:250,width:"100%",type:"textarea",onOnSave:r.saveDescription,customClass:"side-panel__description",noContent:"No description"},null,8,["value","onOnSave"]),null!==a.element?(Object(s["D"])(),Object(s["h"])(Object(s["K"])(r.specificElement),{key:0,element:a.element},null,8,["element"])):Object(s["i"])("",!0),Object(s["k"])("h3",mc,[Object(s["n"])(c,{icon:"lb-tags"}),Object(s["m"])(" Tags ")]),Object(s["n"])(l,{tags:a.tags,onAddTag:r.addTag,onRemoveTag:r.removeTag,loading:a.contentLoading,buttonLoading:a.tagLoading},null,8,["tags","onAddTag","onRemoveTag","loading","buttonLoading"])],4),a.elementLoading?(Object(s["D"])(),Object(s["h"])(u,{key:0})):Object(s["i"])("",!0)]),Object(s["k"])("div",gc,[Object(s["n"])(d,{variant:"negative",icon:"lb-trash",size:1.2,onClick:r.deleteCurrentElement,loading:a.deleteLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Delete Element")]),_:1},8,["size","onClick","loading"])])]),Object(s["k"])("div",Oc,[a.contentLoading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(p,{key:0,elementID:parseInt(n.elementID),categoryID:n.categoryID},null,8,["elementID","categoryID"])),a.contentLoading?(Object(s["D"])(),Object(s["h"])(u,{key:1})):Object(s["i"])("",!0)])])}const jc={class:"lb-content"},yc={class:"lb-content__menu"},fc={key:0,class:"lb-content__elements"},_c={key:1,class:"lb-content__empty"};function kc(e,t,n,i,a,r){const o=Object(s["J"])("lb-menu-button");return Object(s["D"])(),Object(s["j"])("div",jc,[Object(s["k"])("div",yc,[Object(s["n"])(o,{icon:"lb-plus",size:1.2,options:a.options,loading:a.createLoading,onClick:r.clickOnMenuBtn,class:"lb-content__button-btn"},null,8,["size","options","loading","onClick"])]),e.contentElements.length?(Object(s["D"])(),Object(s["j"])("div",fc,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(e.contentElements,(t,i)=>(Object(s["D"])(),Object(s["h"])(Object(s["K"])(r.componentType(t.type)),Object(s["u"])({key:{id:t.id,type:t.type},position:i,isLast:r.isLast(i),contentID:e.contentID,buttonsLoading:a.elementButtonsLoading,elementID:n.elementID,categoryID:n.categoryID},t,{onMoveElement:r.moveElement,onDeleteElement:r.removeElement}),null,16,["position","isLast","contentID","buttonsLoading","elementID","categoryID","onMoveElement","onDeleteElement"]))),128))])):Object(s["i"])("",!0),0==e.contentElements.length?(Object(s["D"])(),Object(s["j"])("div",_c," No content elements yet ")):Object(s["i"])("",!0)])}const wc={class:"lb-menu-button"},Dc={class:"lb-menu-button__activator"},Cc={key:0,class:"lb-menu-button__dropdown"},Ec={class:"lb-menu-button__options"},Lc=["onClick"];function Ic(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",wc,[Object(s["k"])("div",Dc,[Object(s["n"])(o,{size:n.size,icon:n.icon,disabled:n.disabled,loading:n.loading,onClick:r.clickActivator},{default:Object(s["T"])(()=>[Object(s["I"])(e.$slots,"default")]),_:3},8,["size","icon","disabled","loading","onClick"])]),n.disabled||n.loading||!a.isOpen?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Cc,[Object(s["k"])("div",Ec,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.options,e=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-menu-button__option",key:e.id,onClick:t=>r.clickOption(e.id),style:Object(s["x"])(r.optionSize)},[e.icon?(Object(s["D"])(),Object(s["h"])(c,{key:0,icon:e.icon,class:"lb-menu-button__option-icon"},null,8,["icon"])):Object(s["i"])("",!0),Object(s["k"])("span",null,Object(s["M"])(e.name),1)],12,Lc))),128))])]))])}var xc={name:"LbMenuButton",emits:["click"],props:{size:{type:Number,required:!1,default:null},icon:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},loading:{type:Boolean,default:!1},options:{type:Array,default:[],required:!0}},data(){return{isOpen:!1}},computed:{optionSize(){return`font-size: ${this.size}rem;`}},methods:{clickActivator(){this.isOpen=!this.isOpen},clickOption(e){this.$emit("click",e),this.isOpen=!1}}};n("5ea1");const Pc=w()(xc,[["render",Ic]]);var Sc=Pc;const Tc={class:"lb-text-element"};function Nc(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(c,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["k"])("div",Tc,[Object(s["n"])(o,{value:n.text,type:"textarea",width:"100%",onOnSave:r.saveText},null,8,["value","onOnSave"])])]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}const Uc={class:"lb-content-element"},zc={class:"lb-content-element__header"},$c={class:"lb-content-element__header-buttons"},Jc=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),Mc={class:"lb-content-element__body"},qc={class:"lb-content-element__footer"},Bc={class:"lb-content-element__footer-buttons"};function Rc(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",Uc,[Object(s["k"])("div",zc,[Object(s["n"])(o,{value:n.title,maxLength:60,width:"100%",onOnSave:r.changeTitle,customClass:"lb-content-element__title"},null,8,["value","onOnSave"]),Object(s["k"])("div",$c,[Object(s["n"])(c,{variant:"negative",icon:"lb-trash",onClick:t[0]||(t[0]=t=>e.$emit("removeElement")),size:1.2,loading:n.buttonsLoading},null,8,["size","loading"])])]),Jc,Object(s["k"])("div",Mc,[Object(s["I"])(e.$slots,"default")]),Object(s["k"])("div",qc,[Object(s["k"])("div",Bc,[Object(s["n"])(c,{icon:"lb-up",disabled:r.isUpBtnDisabled,onClick:t[1]||(t[1]=e=>r.moveContentElement(-1)),size:1.1,loading:n.buttonsLoading},null,8,["disabled","size","loading"]),Object(s["n"])(c,{icon:"lb-down",disabled:n.isLast,onClick:t[2]||(t[2]=e=>r.moveContentElement(1)),size:1.1,loading:n.buttonsLoading},null,8,["disabled","size","loading"])])])])}var Vc={name:"LbContentElement",components:{LbEditableText:Be},emits:["moveElement","removeElement","changeTitle"],props:{position:{type:Number,required:!0},isLast:{type:Boolean,default:!1},title:{type:String,default:"Title"},buttonsLoading:{type:Boolean,default:!1}},computed:{isUpBtnDisabled(){return this.position-1<0}},methods:{moveContentElement(e){this.$emit("moveElement",this.position+e)},changeTitle(e){this.$emit("changeTitle",e)}}};n("776c");const Gc=w()(Vc,[["render",Rc]]);var Fc=Gc;const Ac={emits:["moveElement","deleteElement"],props:{id:{type:Number,required:!0},contentID:{type:Number,required:!0},position:{type:Number,required:!0},isLast:{type:Boolean,default:!1},title:{type:String,default:"Title"},buttonsLoading:{type:Boolean,default:!1}},methods:{moveContentElement(e){this.$emit("moveElement",{oldPosition:this.position,newPosition:e})}}};var Hc=Ac;async function Yc(e,t){let n=e;return n.contentID=t,await v.post("/texts/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Kc(e,t,n){return await v.patch(`/texts/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Wc(e,t){return await v.delete(`/texts/${e}/content/${t}`).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var Qc={name:"LbTextElement",mixins:[Hc],components:{LbContentElement:Fc,LbEditableText:Be},props:{text:{type:String,default:""}},data(){return{elementType:K.text}},computed:{...Object(b["c"])("element",["getElementById"])},methods:{...Object(b["d"])("notifications",["notify"]),deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await Kc(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async saveText(e){try{await Kc(this.id,{text:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.text=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}}}};n("8931");const Xc=w()(Qc,[["render",Nc]]);var Zc=Xc;const el={class:"lb-list-element"},tl={key:0,class:"lb-list-element__items"},nl=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),sl={key:1,class:"lb-list-element__no-content"},il={class:"lb-list-element__button"};function al(e,t,n,i,a,r){const o=Object(s["J"])("lb-list-item"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(l,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["k"])("div",el,[n.items.length>0?(Object(s["D"])(),Object(s["j"])("div",tl,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(r.sortedItems,(t,n)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-list-element__item",key:t.id},[Object(s["n"])(o,{id:t.id,title:t.title,text:t.text,ordinalNumber:t.ordinalNumber,isLast:r.isItemLast(n),contentID:e.contentID,listID:e.id,onMoveItem:r.moveItem,onRemoveListItem:r.deleteItem},null,8,["id","title","text","ordinalNumber","isLast","contentID","listID","onMoveItem","onRemoveListItem"]),nl]))),128))])):Object(s["i"])("",!0),n.items.length?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",sl," No items ")),Object(s["k"])("div",il,[Object(s["n"])(c,{icon:"lb-plus",onClick:r.addListItem,size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Add list item")]),_:1},8,["onClick","size"])])])]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}const rl={class:"lb-list-item"},ol={class:"lb-list-item__header"},cl={class:"lb-list-item__header-buttons"},ll={class:"lb-list-item__body"};function ul(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",rl,[Object(s["k"])("div",ol,[Object(s["n"])(o,{value:n.title,maxLength:45,width:"100%",onOnSave:r.saveTitle,customClass:"lb-list-item__title"},null,8,["value","onOnSave"]),Object(s["k"])("div",cl,[Object(s["n"])(c,{icon:"lb-up",disabled:r.isUpBtnDisabled,onClick:t[0]||(t[0]=e=>r.moveListItem(-1)),size:1},null,8,["disabled"]),Object(s["n"])(c,{icon:"lb-down",disabled:n.isLast,onClick:t[1]||(t[1]=e=>r.moveListItem(1)),size:1},null,8,["disabled"]),Object(s["n"])(c,{variant:"negative",icon:"lb-trash",onClick:t[2]||(t[2]=t=>e.$emit("removeListItem",n.id)),size:1})])]),Object(s["k"])("div",ll,[Object(s["n"])(o,{value:n.text,type:"textarea",width:"100%",onOnSave:r.saveText},null,8,["value","onOnSave"])])])}async function dl(e,t){let n=e;return n.contentID=t,await v.post("/lists/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function pl(e,t,n){return await v.patch(`/lists/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function bl(e,t){return await v.delete(`/lists/${e}/content/${t}`).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function hl(e){return await v.post("/list_items/",e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ml(e,t){return await v.delete(`/list_items/${e}/content/${t}`).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function gl(e,t,n){return await v.patch(`/list_items/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Ol(e,t,n){return await v.patch(`/list_items/position/${e}/content/${n}`,t).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}var vl={name:"LbListItem",components:{LbEditableText:Be},emits:["removeListItem","moveItem"],props:{id:{type:Number,required:!0},listID:{type:Number,required:!0},ordinalNumber:{type:Number,required:!0},contentID:{type:Number,required:!0},title:{type:String},text:{type:String},isLast:{type:Boolean,default:!1}},computed:{...Object(b["c"])("element",["getElementById","getListItemById"]),isUpBtnDisabled(){return 0==this.ordinalNumber}},methods:{...Object(b["d"])("notifications",["notify"]),moveListItem(e){this.$emit("moveItem",{oldOrdinalNumber:this.ordinalNumber,newOrdinalNumber:this.ordinalNumber+e})},async saveText(e){try{await gl(this.id,{text:e},this.contentID);const t=this.getListItemById(this.listID,this.id);t.text=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async saveTitle(e){try{await gl(this.id,{title:e},this.contentID);const t=this.getListItemById(this.listID,this.id);t.title=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}}}};n("8641");const jl=w()(vl,[["render",ul]]);var yl=jl,fl={name:"LbListElement",mixins:[Hc],components:{LbContentElement:Fc,LbListItem:yl},props:{items:{type:Array,default:[]}},data(){return{elementType:K.list}},computed:{...Object(b["c"])("element",["getElementById","getListItemByOrder"]),sortedItems(){return this.items.sort((e,t)=>e.ordinalNumber>t.ordinalNumber?1:e.ordinalNumber==t.ordinalNumber?0:e.ordinalNumber<t.ordinalNumber?-1:void 0)}},methods:{...Object(b["d"])("notifications",["notify"]),isItemLast(e){return this.items.length-1==e},deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await pl(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async addListItem(){let e={title:"Title",text:"",ordinalNumber:this.items.length?this.sortedItems[this.items.length-1].ordinalNumber+1:0,listID:this.id,contentID:this.contentID};const t=await hl(e);e={id:t.id,title:e.title,text:e.text,ordinalNumber:e.ordinalNumber};const n=this.getElementById(this.id,this.elementType);n.items.push(e)},async moveItem(e){const t=this.getListItemByOrder(this.id,e.oldOrdinalNumber),n=this.getListItemByOrder(this.id,e.newOrdinalNumber);await Ol(t.id,{listID:this.id,oldOrdinalNumber:e.oldOrdinalNumber,newOrdinalNumber:e.newOrdinalNumber},this.contentID),t.ordinalNumber=e.newOrdinalNumber,n.ordinalNumber=e.oldOrdinalNumber},async deleteItem(e){try{await ml(e,this.contentID);const t=this.getElementById(this.id,this.elementType),n=t.items.find(t=>t.id==e).ordinalNumber;t.items=this.items.filter(t=>t.id!==e),t.items.filter(e=>e.ordinalNumber>n).forEach(e=>{e.ordinalNumber=e.ordinalNumber-1})}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}}}};n("9e63");const _l=w()(fl,[["render",al]]);var kl=_l;const wl={class:"lb-link-group-element"},Dl={key:0,class:"lb-link-group-element__items"},Cl=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),El={key:1,class:"lb-link-group-element__no-content"},Ll={class:"lb-link-group-element__button"};function Il(e,t,n,i,a,r){const o=Object(s["J"])("lb-content-link"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("link-popup"),u=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(u,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["k"])("div",wl,[n.links.length>0?(Object(s["D"])(),Object(s["j"])("div",Dl,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.links,t=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-link-group-element__item",key:t.id},[Object(s["n"])(o,{id:t.id,contentID:e.contentID,description:t.description,targetID:t.targetID,targetName:t.targetName,categoryID:t.categoryID,categoryName:t.categoryName,linkGroupID:e.id,onRemoveLink:r.deleteContentLink},null,8,["id","contentID","description","targetID","targetName","categoryID","categoryName","linkGroupID","onRemoveLink"]),Cl]))),128))])):Object(s["i"])("",!0),n.links.length?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",El," No links ")),Object(s["k"])("div",Ll,[Object(s["n"])(c,{icon:"lb-link",onClick:e.openLinkPopup,size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Add new link")]),_:1},8,["onClick","size"])])]),e.isLinkPopupOpen?(Object(s["D"])(),Object(s["h"])(l,{key:0,linkGroupID:e.id,elementID:n.elementID,elementCategoryID:n.categoryID,onOnResult:r.addNewLink},null,8,["linkGroupID","elementID","elementCategoryID","onOnResult"])):Object(s["i"])("",!0)]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}const xl={class:"lb-content-link"},Pl={class:"lb-content-link__header"},Sl={class:"lb-content-link__header-main"},Tl={class:"lb-content-link__title-text"},Nl={class:"lb-content-link__category"},Ul={class:"lb-content-link__header-buttons"},zl={class:"lb-content-link__body"};function $l(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-editable-text");return Object(s["D"])(),Object(s["j"])("div",xl,[Object(s["k"])("div",Pl,[Object(s["k"])("div",Sl,[Object(s["k"])("div",{onClick:t[0]||(t[0]=(...e)=>r.navigateToElement&&r.navigateToElement(...e)),class:"lb-content-link__title"},[Object(s["n"])(o,{icon:"lb-link",class:"lb-content-link__title-icon"}),Object(s["k"])("span",Tl,Object(s["M"])(n.targetName),1)]),Object(s["k"])("div",Nl,[Object(s["n"])(o,{icon:"lb-folder"}),Object(s["m"])(" "+Object(s["M"])(n.categoryName),1)])]),Object(s["k"])("div",Ul,[Object(s["n"])(c,{variant:"negative",icon:"lb-unlink",onClick:t[1]||(t[1]=t=>e.$emit("removeLink",n.id)),size:1})])]),Object(s["k"])("div",zl,[Object(s["n"])(l,{value:n.description,type:"textarea",maxLength:250,width:"100%",onOnSave:r.saveDescription},null,8,["value","onOnSave"])])])}var Jl={name:"LbContentLink",components:{LbEditableText:Be},emits:["removeLink"],props:{contentID:{type:Number,required:!0},id:{type:Number,required:!0},linkGroupID:{type:Number,required:!0},description:{type:String},targetID:{type:Number,required:!0},targetName:{type:String,rquired:!0},categoryID:{type:[Number,String],required:!0},categoryName:{type:String,required:!0}},computed:{...Object(b["c"])("universe",["universeID"]),...Object(b["c"])("element",["getLinkById"])},methods:{...Object(b["d"])("notifications",["notify"]),async saveDescription(e){try{await Lt(this.id,{description:e},this.contentID);const t=this.getLinkById(this.linkGroupID,this.id);t.description=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},navigateToElement(){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.categoryID,elementID:this.targetID}})}}};n("58e7");const Ml=w()(Jl,[["render",$l]]);var ql=Ml,Bl={name:"LbLinkGroupElement",mixins:[Hc],components:{LbContentElement:Fc,LbContentLink:ql,LinkPopup:vs},props:{links:{type:Array,default:[]},elementID:{type:Number},categoryID:{type:String}},data(){return{elementType:K.linkGroup}},computed:{...Object(b["c"])("element",["getElementById"]),...Object(b["c"])("popups",["isLinkPopupOpen"])},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("popups",["openLinkPopup"]),deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await It(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},addNewLink(e){const t=this.getElementById(this.id,this.elementType);t.links.push(e)},async deleteContentLink(e){try{await Pt(e,this.contentID);const t=this.getElementById(this.id,this.elementType);t.links=t.links.filter(t=>t.id!=e)}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}}}};n("2155");const Rl=w()(Bl,[["render",Il]]);var Vl=Rl;const Gl=Object(s["k"])("div",{class:"lb-image-group-element"}," This functionality is implemented yet. ",-1);function Fl(e,t,n,i,a,r){const o=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(o,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Gl]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}async function Al(e,t){let n=e;return n.contentID=t,await v.post("/image_groups/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Hl(e,t){return await v.delete(`/image_groups/${e}/content/${t}`).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Yl(e,t,n){return await v.patch(`/image_groups/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var Kl={name:"LbImageGroupElement",mixins:[Hc],components:{LbContentElement:Fc},data(){return{elementType:K.imageGroup}},computed:{...Object(b["c"])("element",["getElementById"])},methods:{deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await Yl(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}}}};n("43d5");const Wl=w()(Kl,[["render",Fl]]);var Ql=Wl;const Xl={entry:"Entry",event:"Event",location:"Location",character:"Character"};function Zl(e){return e.Character_id?e.Character_id:e.Location_id?e.Location_id:e.Event_id?e.Event_id:e.Entry_id?e.Entry_id:void 0}function eu(e){return{id:e.id,description:e.description,targetName:e.target.name,targetID:Zl(e),categoryName:e.target.Category.name,categoryID:e.target.Category.id}}function tu(e,t){return e.map(e=>({id:e.id,title:e.title,links:t.filter(t=>t.Link_group_id==e.id).map(e=>eu(e)),type:K.linkGroup}))}function nu(e){return{id:e.id,title:e.title,text:e.text,ordinalNumber:e.ordinal_number}}function su(e){return e.map(e=>({id:e.id,title:e.title,items:e.ListItems.map(e=>nu(e)),type:K.list}))}function iu(e){return e.map(e=>({id:e.id,title:e.title,text:e.text,type:K.text}))}function au(e){return e.map(e=>({id:e.id,title:e.title,type:K.imageGroup}))}async function ru(e,t){let n;return n="Characters"==t?Xl.character:"Locations"==t?Xl.location:"Events"==t?Xl.event:Xl.entry,await v.get(`/contents/${n}/${e}`).then(e=>{const t={contentID:e.data.content.id,configuration:e.data.content.configuration,texts:iu(e.data.texts),lists:su(e.data.lists),linkGroups:tu(e.data.linkGroups,e.data.links),imageGroups:au(e.data.imageGroups),tags:e.data.tags};return t}).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ou(e,t){const n={config:t};return await v.patch("/contents/"+e,n).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function cu(e,t,n){let s=null;try{n==K.text?s=await Yc(e,t):n==K.list?s=await dl(e,t):n==K.linkGroup?s=await Et(e,t):n==K.imageGroup&&(s=await Al(e,t))}catch(i){throw new Error(i.message)}return s}async function lu(e,t,n){n==K.text?await Wc(e,t):n==K.list?await bl(e,t):n==K.linkGroup?await xt(e,t):n==K.imageGroup&&await Hl(e,t)}var uu={name:"LbContent",components:{LbMenuButton:Sc,LbTextElement:Zc,LbListElement:kl,LbLinkGroupElement:Vl,LbImageGroupElement:Ql},props:{elementID:Number,categoryID:String},data(){return{options:[{id:1,name:"Text",type:K.text,icon:"lb-edit"},{id:2,name:"List",type:K.list,icon:"lb-list"},{id:3,name:"Link Group",type:K.linkGroup,icon:"lb-link"},{id:4,name:"Image Group",type:K.imageGroup,icon:"lb-picture"}],createLoading:!1,elementButtonsLoading:!1}},computed:{...Object(b["c"])("element",["config","contentID","contentElements"])},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("element",["removeContentElement"]),async moveElement(e){this.elementButtonsLoading=!0;const t=this.contentElements.splice(e.oldPosition,1)[0];this.contentElements.splice(e.newPosition,0,t);try{await ou(this.contentID,this.config)}catch(n){this.notify({type:"negative",message:"Error: "+n.message})}finally{this.elementButtonsLoading=!1}},async removeElement(e){try{this.elementButtonsLoading=!0,await lu(e.id,this.contentID,e.type),this.removeContentElement(e)}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}finally{this.elementButtonsLoading=!1}},async clickOnMenuBtn(e){const t=this.options.find(t=>t.id==e).type;try{this.createLoading=!0;let e={title:"Title of "+t};t==K.text&&(e.text="");const n=await cu(e,this.contentID,t);e.id=n.id,e.type=t,t==K.list&&(e.items=[]),t==K.linkGroup&&(e.links=[]),this.contentElements.push(e)}catch(n){this.notify({type:"negative",message:"Error: "+n.message})}finally{this.createLoading=!1}},componentType(e){return e==K.text?"LbTextElement":e==K.list?"LbListElement":e==K.linkGroup?"LbLinkGroupElement":e==K.imageGroup?"LbImageGroupElement":void 0},isLast(e){return this.contentElements.length-1==e}}};n("9ca3");const du=w()(uu,[["render",kc]]);var pu=du;const bu={class:"lb-tag-container"},hu={key:0,class:"lb-tag-container__tags"},mu={class:"lb-tag-container__tag-name"},gu={key:1,class:"lb-tag-container__no-content"},Ou={key:1,class:"lb-tage-container__input-field"};function vu(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner"),l=Object(s["J"])("lb-input"),u=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",bu,[Object(s["k"])("div",{class:"lb-tag-container__content",style:Object(s["x"])(r.visibility)},[n.tags.length?(Object(s["D"])(),Object(s["j"])("div",hu,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.tags,(t,n)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-tag-container__tag",key:n},[Object(s["k"])("span",mu,Object(s["M"])(t.name),1),Object(s["n"])(o,{icon:"lb-cancel-circled",class:"lb-tag-container__icon",onClick:n=>e.$emit("removeTag",t.id)},null,8,["onClick"])]))),128))])):Object(s["i"])("",!0),n.tags.length<1?(Object(s["D"])(),Object(s["j"])("div",gu," No tags ")):Object(s["i"])("",!0)],4),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0})):Object(s["i"])("",!0),n.loading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Ou,[Object(s["n"])(l,{maxLength:60,value:a.name,"onUpdate:value":t[0]||(t[0]=e=>a.name=e),fontSize:1,onKeydown:r.handleEnterPress},null,8,["value","onKeydown"]),Object(s["n"])(u,{variant:"positive",icon:"lb-plus",size:1,onClick:r.addTag,loading:n.buttonLoading},null,8,["onClick","loading"])]))])}var ju={name:"LbTagContainer",components:{LbInput:en},emits:["addTag","removeTag"],props:{tags:{type:Array,default:[]},loading:{type:Boolean,default:!1},buttonLoading:{type:Boolean,default:!1}},computed:{visibility(){return this.loading?"visibility: hidden;":"visibility: visible;"}},data(){return{name:""}},methods:{addTag(){if(0!==this.name.length){const e=this.tags.find(e=>e.name===this.name);void 0==e&&this.$emit("addTag",this.name),this.name=""}},handleEnterPress(e){"Enter"==e.key&&(e.preventDefault(),this.addTag())}}};n("91d4");const yu=w()(ju,[["render",vu]]);var fu=yu;const _u={class:"event-date-section"},ku={class:"event-date-section__header"},wu=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Du={class:"event-date-section__date"},Cu={class:"event-date-section__date-part"},Eu=Object(s["k"])("span",{class:"event-date-section__date-part-name"},"Year: ",-1),Lu={class:"event-date-section__date-part-value"},Iu={class:"event-date-section__date-part"},xu=Object(s["k"])("span",{class:"event-date-section__date-part-name"},"Month: ",-1),Pu={class:"event-date-section__date-part-value"},Su={class:"event-date-section__date-part"},Tu=Object(s["k"])("span",{class:"event-date-section__date-part-name"},"Day: ",-1),Nu={class:"event-date-section__date-part-value"};function Uu(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("event-date-popup");return Object(s["D"])(),Object(s["j"])("div",_u,[Object(s["k"])("h3",ku,[Object(s["m"])(" Date "),Object(s["n"])(o,{icon:"lb-edit",size:.8,onClick:r.openPopup},null,8,["size","onClick"])]),wu,Object(s["k"])("div",Du,[Object(s["k"])("div",Cu,[Eu,Object(s["k"])("span",Lu,Object(s["M"])(a.year),1)]),Object(s["k"])("div",Iu,[xu,Object(s["k"])("span",Pu,Object(s["M"])(a.month),1)]),Object(s["k"])("div",Su,[Tu,Object(s["k"])("span",Nu,Object(s["M"])(a.day),1)])]),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(c,{key:0,isOpen:a.isPopupOpen,onClose:r.closePopup,year:a.year,month:a.month,day:a.day,eventID:a.eventID,onOnResult:r.changeDate},null,8,["isOpen","onClose","year","month","day","eventID","onOnResult"])):Object(s["i"])("",!0)])}const zu={class:"event-date-popup"},$u={class:"event-date-popup__inputs"},Ju={class:"event-date-popup__buttons"};function Mu(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(l,{isOpen:n.isOpen,title:"Change event date",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",zu,[Object(s["k"])("div",$u,[Object(s["n"])(o,{name:"Year",type:"number",value:a.eventDate.year,"onUpdate:value":t[0]||(t[0]=e=>a.eventDate.year=e)},null,8,["value"]),Object(s["n"])(o,{name:"Month",type:"number","onChange:value":r.setEventMonth,value:a.eventDate.month,"onUpdate:value":t[1]||(t[1]=e=>a.eventDate.month=e)},null,8,["onChange:value","value"]),Object(s["n"])(o,{name:"Day",type:"number","onChange:value":r.setEventDay,value:a.eventDate.day,"onUpdate:value":t[2]||(t[2]=e=>a.eventDate.day=e)},null,8,["onChange:value","value"])]),Object(s["k"])("div",Ju,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.changeDate,loading:a.loading},{default:Object(s["T"])(()=>[Object(s["m"])("Save date")]),_:1},8,["size","onClick","loading"])])])]),_:1},8,["isOpen","onClose"])}var qu={name:"EventDatePopup",components:{LbInput:en},emits:["close","onResult"],props:{isOpen:{type:Boolean,default:!1},year:{type:Number},month:{type:Number},day:{type:Number},eventID:{type:Number,required:!0}},data(){return{eventDate:{year:this.year,month:this.month,day:this.day},loading:!1}},methods:{...Object(b["d"])("notifications",["notify"]),close(){this.$emit("close")},setEventMonth(e){this.eventDate.month=e>12?12:e<1?1:e},setEventDay(e){this.eventDate.day=e>31?31:e<1?1:e},async changeDate(){try{this.loading=!0,await cs(this.eventID,this.eventDate),this.$emit("onResult",this.eventDate),this.close()}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.loading=!1}}}};n("1417");const Bu=w()(qu,[["render",Mu]]);var Ru=Bu,Vu={name:"EventDateSection",components:{EventDatePopup:Ru},props:{element:{type:Object,required:!0,validator:e=>null!==e.year&&void 0!==e.year&&(null!==e.month&&void 0!==e.month&&(null!==e.day&&void 0!==e.day))}},data(){return{year:this.element.year,month:this.element.month,day:this.element.day,eventID:this.element.id,isPopupOpen:!1}},methods:{closePopup(){this.isPopupOpen=!1},openPopup(){this.isPopupOpen=!0},changeDate(e){this.year=e.year,this.month=e.month,this.day=e.day}}};n("c8be");const Gu=w()(Vu,[["render",Uu]]);var Fu=Gu;const Au={class:"location-parent-section"},Hu={class:"location-parent-section__header"},Yu={key:1,class:"location-parent-section__no-content"};function Ku(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("icon"),l=Object(s["J"])("location-parent-popup");return Object(s["D"])(),Object(s["j"])("div",Au,[Object(s["k"])("h3",Hu,[Object(s["m"])(" Parent Location "),Object(s["n"])(o,{icon:"lb-edit",size:.8,onClick:r.openPopup},null,8,["size","onClick"])]),a.parentName?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:"location-parent-section__parent",onClick:t[0]||(t[0]=(...e)=>r.navigateToParent&&r.navigateToParent(...e))},[Object(s["n"])(c,{icon:"lb-link"}),Object(s["k"])("span",null,Object(s["M"])(a.parentName),1)])):Object(s["i"])("",!0),a.parentName?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Yu," No Parent Location ")),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(l,{key:2,isOpen:a.isPopupOpen,locationID:a.id,currentParentID:a.parentID,currentParentName:a.parentName,onClose:r.closePopup,onOnResult:r.setParent},null,8,["isOpen","locationID","currentParentID","currentParentName","onClose","onOnResult"])):Object(s["i"])("",!0)])}const Wu={class:"location-parent-popup"},Qu={class:"location-parent-popup__field"},Xu={class:"location-parent-popup__name"},Zu={class:"location-parent-popup__name-value"},ed={class:"location-parent-popup__field"},td={class:"location-parent-popup__field"},nd={class:"location-parent-popup__field"},sd={class:"location-parent-popup__buttons"};function id(e,t,n,i,a,r){const o=Object(s["J"])("lb-search-bar"),c=Object(s["J"])("lb-select-list"),l=Object(s["J"])("lb-page-nav"),u=Object(s["J"])("lb-button"),d=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(d,{isOpen:n.isOpen,title:"Set Parent Location",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Wu,[Object(s["k"])("div",Qu,[Object(s["k"])("div",Xu,[Object(s["m"])(" Current Parent: "),Object(s["k"])("span",Zu,Object(s["M"])(n.currentParentName),1)])]),Object(s["k"])("div",ed,[Object(s["n"])(o,{placeholder:"Search location...",onSearch:r.search,text:a.searchText},null,8,["placeholder","onSearch","text"])]),Object(s["k"])("div",td,[Object(s["n"])(c,{items:r.filteredLocations,loading:a.locationsLoading,selectedID:a.parentID,onOnSelect:r.selectParent,maxHeight:"250px"},null,8,["items","loading","selectedID","onOnSelect"])]),Object(s["k"])("div",nd,[1!=a.totalPages?(Object(s["D"])(),Object(s["h"])(l,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage,class:"location-parent-popup__page-nav"},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)]),Object(s["k"])("div",sd,[Object(s["n"])(u,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(u,{variant:"positive",size:1.4,onClick:r.setParent,loading:a.setParentLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Set Parent")]),_:1},8,["size","onClick","loading"])])])]),_:1},8,["isOpen","onClose"])}var ad={name:"LocationParentPopup",components:{LbSearchBar:En,LbSelectList:_n,LbPageNav:zn},emits:["close","onResult"],props:{isOpen:{type:Boolean,default:!1},locationID:{type:Number},currentParentID:{type:Number},currentParentName:{type:String}},data(){return{parentID:this.currentParentID,parentName:this.currentParentName,searchText:"",locationsLoading:!1,locations:[],currentPage:1,totalPages:2,setParentLoading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),filteredLocations(){return this.locations.filter(e=>e.id!==this.locationID&&e.Location_id!==this.locationID)}},methods:{...Object(b["d"])("notifications",["notify"]),close(){this.$emit("close")},async fetchLocations(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=25;this.locationsLoading=!0;try{const t=0!==n?n*s-s:0,i=await hs(this.universeID,e,s,t,"Locations");this.locations=i.elements,this.totalPages=i.totalPages}catch(i){this.notify({type:"negative",message:"Error: "+i.message})}finally{this.locationsLoading=!1}},selectParent(e){this.parentID=this.parentID!==e?e:null,null!==this.parentID?this.parentName=this.filteredLocations.find(e=>e.id==this.parentID).name:this.parentName=null},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchLocations(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},async setParent(){try{this.setParentLoading=!0,await ns(this.locationID,{Location_id:this.parentID}),this.$emit("onResult",{id:this.parentID,name:this.parentName}),this.close()}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.setParentLoading=!1}}},async mounted(){await this.fetchLocations("",1)}};n("6f37");const rd=w()(ad,[["render",id]]);var od=rd,cd={name:"LocationParentSection",components:{LocationParentPopup:od},props:{element:{type:Object,required:!0}},data(){return{id:this.element.id,parentName:this.element.parentName,parentID:this.element.parentID,isPopupOpen:!1}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{closePopup(){this.isPopupOpen=!1},openPopup(){this.isPopupOpen=!0},navigateToParent(){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:"Locations",elementID:this.parentID}})},setParent(e){this.parentID=e.id,this.parentName=e.name}}};n("29ed");const ld=w()(cd,[["render",Ku]]);var ud=ld;function dd(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div")}var pd={name:"DummyComponent"};const bd=w()(pd,[["render",dd]]);var hd=bd,md={name:"ElementPage",components:{LbEditableText:Be,LbContent:pu,LbTagContainer:fu,EventDateSection:Fu,DummyComponent:hd,LocationParentSection:ud},props:{elementID:{type:String,required:!0},categoryID:{type:String,required:!0}},data(){return{name:"",description:"",element:null,elementLoading:!1,contentLoading:!0,deleteLoading:!1,tags:[],tagLoading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),...Object(b["c"])("element",["contentID"]),sideInfoVisibility(){return this.elementLoading?"visibility: hidden;":"visibility: visible;"},specificElement(){return"Events"==this.categoryID?"EventDateSection":"Locations"==this.categoryID?"LocationParentSection":"DummyComponent"}},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("element",["setContent","setContentID","clearContent"]),async fetchElement(e,t){this.element=null;const n=e||this.categoryID,s=t||this.elementID;this.elementLoading=!0;try{const e=await ps(s,n);if(e){if(null!=e.Universe_id&&e.Universe_id!=this.universeID)throw new Vn("This element does not belong to this universe!");return this.name=e.name,this.description=e.description,this.element=e,!0}}catch(i){return this.notify({type:"negative",message:"Error: "+i.message}),i instanceof Vn&&this.$router.replace({name:"ElementNotFoundPage",params:{universeID:this.universeID}}),!1}finally{this.elementLoading=!1}},async fetchFullContent(){this.contentLoading=!0;try{this.clearContent();const e=await ru(this.elementID,this.categoryID);this.setContentID(e.contentID);const t=e.configuration.map(t=>t.type==K.text?e.texts.find(e=>e.id==t.id):t.type==K.list?e.lists.find(e=>e.id==t.id):t.type==K.linkGroup?e.linkGroups.find(e=>e.id==t.id):t.type==K.imageGroup?e.imageGroups.find(e=>e.id==t.id):void 0);this.tags=e.tags,this.setContent(t)}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.contentLoading=!1}},async saveName(e){try{if(e.length<1)throw new Error("Cannot save Name: It should have at least 1 character");await bs(this.elementID,{name:e},this.categoryID),this.name=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async saveDescription(e){try{await bs(this.elementID,{description:e},this.categoryID),this.description=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async addTag(e){try{this.tagLoading=!0;const t=await rr(e,this.contentID,this.universeID);this.tags.push({id:t.id,name:e})}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}finally{this.tagLoading=!1}},async removeTag(e){try{this.tagLoading=!0,await cr(e,this.contentID),this.tags=this.tags.filter(t=>t.id!==e)}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}finally{this.tagLoading=!1}},async deleteCurrentElement(){try{this.deleteLoading=!0,confirm("Do you want delete this element? It cannot be undone!")&&(await ms(this.elementID,this.categoryID),this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}}),this.clearContent())}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.deleteLoading=!1}},async init(e,t){const n=await this.fetchElement(e,t);n&&await this.fetchFullContent(e,t)}},watch:{async $route(e){"ElementPage"===e.name&&await this.init(e.params.categoryID,e.params.elementID)}},async mounted(){await this.init()},beforeRouteLeave(e,t){this.clearContent()}};n("bc71");const gd=w()(md,[["render",vc]]);var Od=gd;const vd={class:"element-not-found-page"},jd=Object(s["k"])("div",{class:"element-not-found-page__title"}," Page Not Found ",-1),yd=[jd];function fd(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",vd,yd)}var _d={name:"ElementNotFoundPage"};n("c485");const kd=w()(_d,[["render",fd]]);var wd=kd;const Dd={class:"search-page"},Cd={class:"search-page__filter-section"},Ed={class:"search-page__filters"},Ld=Object(s["k"])("h2",{class:"search-page__result-section-header"},"Results",-1),Id={class:"search-page__element-table"},xd={class:"element-table__row element-table__row--header"},Pd={class:"element-table__cell"},Sd={class:"element-table__cell-content"},Td=Object(s["k"])("span",null," Name ",-1),Nd={class:"element-table__cell"},Ud={class:"element-table__cell-content"},zd=Object(s["k"])("span",null," Category ",-1),$d=Object(s["k"])("th",{class:"element-table__cell element-table__cell--shrink"}," Last modified ",-1),Jd={class:"element-table__cell"},Md=["onClick"],qd={class:"element-table__cell"},Bd={class:"element-table__cell element-table__cell--shrink"};function Rd(e,t,n,i,a,r){const o=Object(s["J"])("lb-search-bar"),c=Object(s["J"])("lb-select"),l=Object(s["J"])("lb-tag-container"),u=Object(s["J"])("icon"),d=Object(s["J"])("lb-page-nav"),p=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",Dd,[Object(s["k"])("div",Cd,[Object(s["n"])(o,{placeholder:"Search elements by name...",onSearch:r.search,text:a.searchText},null,8,["placeholder","onSearch","text"]),Object(s["k"])("div",Ed,[Object(s["n"])(c,{placeholder:"All categories",items:a.categories,loading:a.categoriesLoading,multiselect:!0,width:"50%"},null,8,["items","loading"]),Object(s["n"])(l,{tags:a.tags,onAddTag:r.addTag,onRemoveTag:r.removeTag},null,8,["tags","onAddTag","onRemoveTag"])])]),Object(s["k"])("div",{class:"search-page__result-section",style:Object(s["x"])(r.loadingVisibility)},[Ld,Object(s["k"])("table",Id,[Object(s["k"])("tr",xd,[Object(s["k"])("th",Pd,[Object(s["k"])("div",Sd,[Object(s["n"])(u,{icon:"lb-link"}),Td])]),Object(s["k"])("th",Nd,[Object(s["k"])("div",Ud,[Object(s["n"])(u,{icon:"lb-folder"}),zd])]),$d]),(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.elements,(e,t)=>(Object(s["D"])(),Object(s["j"])("tr",{class:"element-table__row",key:t},[Object(s["k"])("td",Jd,[Object(s["k"])("span",{class:"element-table__link",onClick:t=>r.navigateToElement(e.id,e.categoryID)},Object(s["M"])(e.name),9,Md)]),Object(s["k"])("td",qd,[Object(s["k"])("span",null,Object(s["M"])(e.categoryName),1)]),Object(s["k"])("td",Bd,Object(s["M"])(r.formatDate(e.lastModified)),1)]))),128))]),r.isPageNavNeeded?(Object(s["D"])(),Object(s["h"])(d,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)],4),a.elementsLoading?(Object(s["D"])(),Object(s["h"])(p,{key:0})):Object(s["i"])("",!0)])}var Vd=n("11c1"),Gd={name:"SearchPage",components:{LbSearchBar:En,LbSelect:pn,LbTagContainer:fu,LbPageNav:zn},data(){return{searchText:"",tags:[],categories:[],categoriesLoading:!1,elementsLoading:!1,elements:[],currentPage:1,totalPages:1}},computed:{...Object(b["c"])("universe",["universeID"]),selectedCategories(){return this.categories.filter(e=>e.selected).map(e=>e.id)},loadingVisibility(){return this.elementsLoading?"visibility: hidden;":"visibility: visible;"},isPageNavNeeded(){return this.totalPages>1}},methods:{...Object(b["d"])("notifications",["notify"]),formatDate(e){const t=new Date(e),n=Object(Fr["a"])(t,"dd.MM.yyyy hh:mm");return n},navigateToElement(e,t){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:t,elementID:e}})},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchElements(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},addTag(e){this.tags.push({id:Object(Vd["v4"])(),name:e})},removeTag(e){this.tags=this.tags.filter(t=>t.id!==e)},async fetchElements(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=50;this.loading=!0;try{const t=0!==n?n*s-s:0,i=this.tags.map(e=>e.name),a=await Qr(this.universeID,e,this.selectedCategories,i,s,t);this.elements=a.elements,this.totalPages=a.totalPages}catch(i){this.notify({type:"negative",message:"Error: "+i.message})}finally{this.loading=!1}},async fetchCategories(){try{this.categoriesLoading=!0;const e=[{id:"Characters",name:"Characters"},{id:"Locations",name:"Locations"},{id:"Events",name:"Events"}],t=await $n(this.universeID);this.categories.push(...e,...t)}catch(e){this.notify({type:"negative",message:e.message})}finally{this.categoriesLoading=!1}}},async mounted(){this.fetchCategories()}};n("8fb3");const Fd=w()(Gd,[["render",Rd]]);var Ad=Fd;const Hd={class:"story-page"};function Yd(e,t,n,i,a,r){const o=Object(s["J"])("router-view");return Object(s["D"])(),Object(s["j"])("div",Hd,[n.storyID?(Object(s["D"])(),Object(s["h"])(o,{key:0,storyID:n.storyID,universeID:n.universeID},null,8,["storyID","universeID"])):Object(s["i"])("",!0)])}var Kd={name:"StoryPage",props:{storyID:{type:String},universeID:{type:String}},data(){return{}}};n("3319");const Wd=w()(Kd,[["render",Yd]]);var Qd=Wd;const Xd={class:"story-chapters-page"},Zd=Object(s["k"])("label",{class:"story-chapters-page__header-label"},"Description",-1),ep={class:"story-chapters-page__chapter-list"},tp=Object(s["k"])("div",{class:"story-chapters-page__chapter-list-header"}," List of Chapters ",-1),np=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1);function sp(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-spinner"),l=Object(s["J"])("story-chapters");return Object(s["D"])(),Object(s["j"])("div",Xd,[Object(s["k"])("div",{class:"story-chapters-page__header",style:Object(s["x"])(r.storyLoadingVisibility)},[Object(s["n"])(o,{value:a.storyTitle,maxLength:80,customClass:"story-chapters-page__title",onOnSave:r.changeStoryTitle},null,8,["value","onOnSave"]),Zd,Object(s["n"])(o,{value:a.storyDescription,maxLength:500,type:"textarea",customClass:"story-chapters-page__description",onOnSave:r.changeStoryDescription,noContent:"No description"},null,8,["value","onOnSave"])],4),a.storyLoading?(Object(s["D"])(),Object(s["h"])(c,{key:0})):Object(s["i"])("",!0),Object(s["k"])("div",ep,[tp,np,a.canShowChapters?(Object(s["D"])(),Object(s["h"])(l,{key:0,storyID:n.storyID},null,8,["storyID"])):Object(s["i"])("",!0)])])}const ip={class:"story-chapters"},ap={key:0,class:"story-chapters__content"},rp={key:1,class:"story-chapters__no-content"},op={class:"story-chapters__create-button"};function cp(e,t,n,i,a,r){const o=Object(s["J"])("lb-chapter-element"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("create-chapter-popup");return Object(s["D"])(),Object(s["j"])("div",ip,[a.chapters.length?(Object(s["D"])(),Object(s["j"])("div",ap,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(r.sortedChapters,(e,t)=>(Object(s["D"])(),Object(s["h"])(o,{key:t,id:e.id,title:e.title,description:e.description,ordinalNumber:e.ordinalNumber,isLast:e.ordinalNumber==a.chapters.length-1,storyID:n.storyID,onChangeDescription:r.changeDescription,onDeleteChapter:r.removeChapter,onMoveChapter:r.moveChapter},null,8,["id","title","description","ordinalNumber","isLast","storyID","onChangeDescription","onDeleteChapter","onMoveChapter"]))),128))])):Object(s["i"])("",!0),0==a.chapters.length?(Object(s["D"])(),Object(s["j"])("div",rp," No chapters ")):Object(s["i"])("",!0),Object(s["k"])("div",op,[Object(s["n"])(c,{onClick:r.openPopup,size:1.2,icon:"lb-plus"},{default:Object(s["T"])(()=>[Object(s["m"])("Create new chapter")]),_:1},8,["onClick","size"])]),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:2})):Object(s["i"])("",!0),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(u,{key:3,isOpen:a.isPopupOpen,onClose:r.closePopup,storyID:n.storyID,ordinalNumber:r.newChapterOrdinalNumber,onOnResult:r.addNewChapter},null,8,["isOpen","onClose","storyID","ordinalNumber","onOnResult"])):Object(s["i"])("",!0)])}const lp={class:"create-chapter-popup__form"},up={class:"create-chapter-popup__buttons"};function dp(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(u,{isOpen:n.isOpen,title:"Create Chapter",onClose:t[2]||(t[2]=t=>e.$emit("close"))},{default:Object(s["T"])(()=>[Object(s["k"])("div",{class:"create-chapter-popup",style:Object(s["x"])(r.setVisibilityOnLoading)},[Object(s["k"])("div",lp,[Object(s["n"])(o,{name:"Chapter Title",maxLength:80,value:a.title,"onUpdate:value":r.setTitle,error:a.titleError},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e),maxLength:500},null,8,["value"])]),Object(s["k"])("div",up,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:t[1]||(t[1]=t=>e.$emit("close"))},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.create,disabled:!r.isFormValid},{default:Object(s["T"])(()=>[Object(s["m"])("Create")]),_:1},8,["size","onClick","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0,size:"50px"})):Object(s["i"])("",!0)]),_:1},8,["isOpen"])}var pp={name:"CreateChapterPopup",components:{LbInput:en},props:{isOpen:{type:Boolean,default:!1},storyID:{type:String,required:!0},ordinalNumber:{type:Number,required:!0}},emits:["close","onResult"],data(){return{loading:!1,title:"",titleError:"",description:""}},computed:{setVisibilityOnLoading(){return this.loading?"visibility: hidden;":"visibility: visible;"},isFormValid(){return""==this.titleError&&this.title.length>0}},methods:{...Object(b["d"])("notifications",["notify"]),setTitle(e){this.titleError="",this.title=e,this.title.length<1&&(this.titleError="Title cannot be empty!")},async create(){try{this.loading=!0;const e=await ft(this.title,this.description,this.ordinalNumber,this.storyID);e.ordinalNumber=e.ordinal_number,delete e.ordinal_number,this.$emit("onResult",e),this.$emit("close")}catch(e){this.notify({type:"negative",message:e.message})}finally{this.loading=!1}}}};n("f194");const bp=w()(pp,[["render",dp]]);var hp=bp;const mp={class:"lb-chapter-element"},gp={class:"lb-chapter-element__header"},Op={class:"lb-chapter-element__header-part"},vp={class:"lb-chapter-element__header-part"},jp={class:"lb-chapter-element__buttons"},yp={class:"lb-chapter-element__position-buttons"},fp=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),_p={class:"lb-chapter-element__content"},kp=Object(s["k"])("label",{class:"lb-chapter-element__description-label"}," Description ",-1);function wp(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-editable-text");return Object(s["D"])(),Object(s["j"])("div",mp,[Object(s["k"])("div",gp,[Object(s["k"])("div",Op,[Object(s["k"])("div",{class:"lb-chapter-element__title",onClick:t[0]||(t[0]=(...e)=>r.navigateToChapter&&r.navigateToChapter(...e))},Object(s["M"])(n.title),1)]),Object(s["k"])("div",vp,[Object(s["k"])("div",jp,[Object(s["k"])("div",yp,[Object(s["n"])(o,{icon:"lb-up",size:1.05,disabled:0==n.ordinalNumber,onClick:t[1]||(t[1]=e=>r.moveChapter(-1))},null,8,["size","disabled"]),Object(s["n"])(o,{icon:"lb-down",size:1.05,disabled:n.isLast,onClick:t[2]||(t[2]=e=>r.moveChapter(1))},null,8,["size","disabled"])]),Object(s["n"])(o,{icon:"lb-trash",variant:"negative",size:1.05,onClick:r.deleteChapter},null,8,["size","onClick"])])])]),fp,Object(s["k"])("div",_p,[kp,Object(s["n"])(c,{maxLength:500,noContent:"No Description",type:"textarea",width:"100%",value:n.description,onOnSave:r.changeDescription},null,8,["value","onOnSave"])])])}var Dp={name:"LbChapterElement",components:{LbEditableText:Be},emits:["changeDescription","moveChapter","deleteChapter"],props:{id:{type:Number,require:!0},storyID:{type:String},title:{type:String},ordinalNumber:{type:Number},description:{type:String},isLast:{type:Boolean,default:!1}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{changeDescription(e){this.$emit("changeDescription",{id:this.id,newValue:e})},moveChapter(e){this.$emit("moveChapter",{oldOrdinalNumber:this.ordinalNumber,newOrdinalNumber:this.ordinalNumber+e})},deleteChapter(){this.$emit("deleteChapter",this.id)},navigateToChapter(){this.$router.push({name:"ChapterPage",params:{chapterID:this.id,storyID:this.storyID,universeID:this.universeID}})}}};n("1d2a");const Cp=w()(Dp,[["render",wp]]);var Ep=Cp,Lp={name:"StoryChapters",components:{CreateChapterPopup:hp,LbChapterElement:Ep},props:{storyID:{type:String}},data(){return{isPopupOpen:!1,chapters:[],loading:!1}},computed:{newChapterOrdinalNumber(){return this.chapters.length},sortedChapters(){return this.chapters.sort((e,t)=>e.ordinalNumber>t.ordinalNumber?1:e.ordinalNumber==t.ordinalNumber?0:e.ordinalNumber<t.ordinalNumber?-1:void 0)}},methods:{...Object(b["d"])("notifications",["notify"]),closePopup(){this.isPopupOpen=!1},openPopup(){this.isPopupOpen=!0},async changeDescription(e){const{id:t,newValue:n}=e;try{const e=this.chapters.find(e=>e.id==t);await _t(e.id,{description:n}),e.description=n}catch(s){this.notify({type:"negative",message:"Error: "+s.message})}},addNewChapter(e){this.chapters.push(e)},async moveChapter(e){try{const t=this.chapters.find(t=>t.ordinalNumber==e.oldOrdinalNumber),n=this.chapters.find(t=>t.ordinalNumber==e.newOrdinalNumber);await kt(t.id,{storyID:this.storyID,oldOrdinalNumber:e.oldOrdinalNumber,newOrdinalNumber:e.newOrdinalNumber}),t.ordinalNumber=e.newOrdinalNumber,n.ordinalNumber=e.oldOrdinalNumber}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async removeChapter(e){try{const t=this.chapters.find(t=>t.id==e),n=t.ordinalNumber;await wt(t.id),this.chapters=this.chapters.filter(t=>t.id!==e),this.chapters.filter(e=>e.ordinalNumber>n).forEach(e=>{e.ordinalNumber=e.ordinalNumber-1})}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async fetchChapters(){this.loading=!0;try{this.chapters=await yt(this.storyID)}catch(e){this.notify({type:"negative",message:"Error: "+e.message})}finally{this.loading=!1}}},async mounted(){await this.fetchChapters()}};n("5014");const Ip=w()(Lp,[["render",cp]]);var xp=Ip,Pp={name:"StoryChaptersPage",components:{LbEditableText:Be,StoryChapters:xp},props:{storyID:{type:String},universeID:{type:String}},data(){return{storyTitle:"",storyDescription:"",storyLoading:!0,canShowChapters:!1}},computed:{storyLoadingVisibility(){return this.storyLoading?"visibility: hiddden;":"visibility: visible"}},methods:{...Object(b["d"])("notifications",["notify"]),async changeStoryTitle(e){try{await Oo(this.storyID,{title:e}),this.storyTitle=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async changeStoryDescription(e){try{await Oo(this.storyID,{description:e}),this.storyDescription=e}catch(t){this.notify({type:"negative",message:"Error: "+t.message})}},async fetchStory(){try{this.storyLoading=!0;const e=await ho(this.storyID);if(this.universeID!=e.Universe_id)throw new Error("This story does not belong to this universe");return this.storyDescription=e.description,this.storyTitle=e.title,!0}catch(e){this.notify({type:"negative",message:"Error: "+e.message}),this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}})}finally{this.storyLoading=!1}}},async mounted(){this.canShowChapters=await this.fetchStory()}};n("5765");const Sp=w()(Pp,[["render",sp]]);var Tp=Sp;const Np={path:"category/:categoryID/",name:"Category",props:!0,components:{default:sc},children:[{path:"",name:"CategoryElements",component:uc,props:!0},{path:"element/:elementID",name:"ElementPage",component:Od,props:!0}]},Up={path:"",name:"UniverseMainPage",component:qo,props:!0},zp={path:"not-found",name:"ElementNotFoundPage",component:wd},$p={path:"search/",name:"SearchPage",component:Ad},Jp={path:"story/:storyID",name:"StoryPage",component:Qd,props:!0,children:[{path:"chapter/:chapterID",name:"ChapterPage",component:Bs,props:!0},{path:"",name:"StoryChaptersPage",component:Tp,props:!0}]},Mp=[{path:"/",name:"Main",component:He},{path:"/register",name:"Register",component:hi,meta:{requiresUnAuth:!0}},{path:"/login",name:"Login",component:$i,meta:{requiresUnAuth:!0}},{path:"/user",name:"User",component:ha,meta:{requiresAuth:!0}},{path:"/universe/:universeID",name:"Universe",components:{default:gr,header:Qo},meta:{requiresAuth:!0,universeRelated:!0},async beforeEnter(e,t,n){Z.getters["universe/universesFetchedFlag"]||await Z.dispatch("universe/fetchUserUniverses"),Z.getters["universe/checkIfUserOwnsUniverse"]({universeID:e.params.universeID})?n():n("/user")},children:[Np,Up,zp,$p,Jp]},{path:"/:notFound(.*)",redirect:"/"}],qp=Object(U["a"])({history:Object(U["b"])("/"),routes:Mp});qp.beforeEach(async(e,t,n)=>{if(!Z.getters.tokenRefreshedFlag){let e=await f();e&&e.data.name&&e.data.email&&e.data.id&&Z.commit("setUser",e.data),Z.commit("setTokenRefreshedFlag",!0)}e.meta.requiresAuth&&!Z.getters.isAuth?n("/login"):e.meta.requiresUnAuth&&Z.getters.isAuth?n("/user"):n()});var Bp=qp;function Rp(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",null,[Object(s["k"])("i",{class:Object(s["w"])(n.icon),style:Object(s["x"])(r.setSize)},null,6)])}var Vp={name:"Icon",props:{icon:{type:String,required:!0},size:{type:Number}},computed:{setSize(){if(this.size)return`font-size: ${this.size}rem`}}};n("2a18");const Gp=w()(Vp,[["render",Rp]]);var Fp=Gp;const Ap=["disabled","tabindex"],Hp={class:"button__content"};function Yp(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("button",{class:Object(s["w"])(r.setStyleClass),style:Object(s["x"])(`font-size: ${this.size}rem;`),disabled:n.disabled||n.loading,tabindex:n.disabled||n.loading?-1:1,onClick:t[0]||(t[0]=(...e)=>r.onClick&&r.onClick(...e))},[Object(s["k"])("div",Hp,[this.icon?(Object(s["D"])(),Object(s["h"])(o,{key:0,icon:this.icon,size:this.size},null,8,["icon","size"])):Object(s["i"])("",!0),Object(s["I"])(e.$slots,"default")]),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0,size:"20px",thickness:"3px",variant:r.setSpinnerVariant},null,8,["variant"])):Object(s["i"])("",!0)],14,Ap)}var Kp={name:"LbButton",props:{variant:{type:String,default:"default",validator(e){return["default","positive","negative","outline"].includes(e)}},size:{type:Number,required:!1,default:null},icon:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},loading:{type:Boolean,default:!1}},emits:["click"],computed:{setStyleClass(){return this.disabled?"button button--disabled":this.loading?`button button--${this.variant} button--loading`:"button button--"+this.variant},setSpinnerVariant(){return"outline"===this.variant?"dark":""}},methods:{onClick(){this.loading||this.disabled||this.$emit("click")}}};n("a54b");const Wp=w()(Kp,[["render",Yp]]);var Qp=Wp;function Xp(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",{class:Object(s["w"])(["lb-spinner",r.setVariant])},[Object(s["k"])("div",{class:"lb-spinner__loader",style:Object(s["x"])(r.setStyle)},null,4)],2)}var Zp={name:"LbSpinner",props:{size:{type:String,default:"35px"},thickness:{type:String,default:"5px"},variant:{type:String,default:""}},computed:{setStyle(){return`width: ${this.size}; height: ${this.size}; border-width: ${this.thickness};`},setVariant(){return this.variant.length>0?"lb-spinner--"+this.variant:""}}};n("402b");const eb=w()(Zp,[["render",Xp]]);var tb=eb;const nb=Object(s["g"])(N).use(Z).use(Bp);nb.component("Icon",Fp),nb.component("LbButton",Qp),nb.component("LbPopupBox",ui),nb.component("LbSpinner",tb),nb.mount("#app")},5765:function(e,t,n){"use strict";n("391b")},5856:function(e,t,n){},"58e7":function(e,t,n){"use strict";n("6dfc")},"5a24":function(e,t,n){"use strict";n("435e")},"5b96":function(e,t,n){"use strict";n("dc20")},"5d4e":function(e,t,n){},"5ea1":function(e,t,n){"use strict";n("7493")},"5fd2":function(e,t,n){},6516:function(e,t,n){"use strict";n("296d")},6571:function(e,t,n){},6677:function(e,t,n){"use strict";n("dbdb")},"67cd":function(e,t,n){},"683a":function(e,t,n){},"6b23":function(e,t,n){"use strict";n("bce0")},"6dd5":function(e,t,n){},"6de2":function(e,t,n){"use strict";n("2400")},"6dfc":function(e,t,n){},"6f37":function(e,t,n){"use strict";n("84ea")},"720d":function(e,t,n){},7267:function(e,t,n){"use strict";n("b5db")},7493:function(e,t,n){},"74fd":function(e,t,n){},"776c":function(e,t,n){"use strict";n("67cd")},"7a10":function(e,t,n){"use strict";n("1484")},"7f1f":function(e,t,n){"use strict";n("44c8")},"84ea":function(e,t,n){},"85c8":function(e,t,n){"use strict";n("f64e")},8641:function(e,t,n){"use strict";n("b423")},8815:function(e,t,n){"use strict";n("a595")},8931:function(e,t,n){"use strict";n("c249")},"8a35":function(e,t,n){},"8c2e":function(e,t,n){"use strict";n("e7b6")},"8c74":function(e,t,n){"use strict";n("2d83")},"8fb3":function(e,t,n){"use strict";n("ccaa")},"915e":function(e,t,n){},"91d4":function(e,t,n){"use strict";n("8a35")},"9bb8":function(e,t,n){"use strict";n("3bdf")},"9be3":function(e,t,n){},"9ca3":function(e,t,n){"use strict";n("cadb")},"9e63":function(e,t,n){"use strict";n("23b8")},"9f73":function(e,t,n){},a0b8:function(e,t,n){"use strict";n("74fd")},a2e7:function(e,t,n){"use strict";n("f8ca")},a3a9:function(e,t,n){},a54b:function(e,t,n){"use strict";n("1d96")},a595:function(e,t,n){},a674:function(e,t,n){e.exports=n.p+"img/edit-universe-title-1.44022736.jpg"},a7db:function(e,t,n){},a7f5:function(e,t,n){},a808:function(e,t,n){"use strict";n("f075")},a853:function(e,t,n){"use strict";n("33a6")},b10b:function(e,t,n){"use strict";n("a7f5")},b199:function(e,t,n){"use strict";n("f233")},b34f:function(e,t,n){e.exports=n.p+"img/edit-universe-title-2.a14da9dd.jpg"},b423:function(e,t,n){},b5db:function(e,t,n){},b649:function(e,t,n){"use strict";n("9be3")},b721:function(e,t,n){"use strict";n("6571")},bc71:function(e,t,n){"use strict";n("3a5a")},bce0:function(e,t,n){},c178:function(e,t,n){e.exports=n.p+"img/search-elements-1.016ec7aa.jpg"},c20b:function(e,t,n){},c249:function(e,t,n){},c446:function(e,t,n){"use strict";n("4ac7")},c485:function(e,t,n){"use strict";n("e9cc")},c8be:function(e,t,n){"use strict";n("4650")},c922:function(e,t,n){},cadb:function(e,t,n){},cbeb:function(e,t,n){},ccaa:function(e,t,n){},ccbd:function(e,t,n){"use strict";n("c20b")},ce4f:function(e,t,n){},cfb0:function(e,t,n){},cfe2:function(e,t,n){"use strict";n("a7db")},d541:function(e,t,n){},d6e9:function(e,t,n){"use strict";n("ee0e")},d987:function(e,t,n){"use strict";n("3402")},dab6:function(e,t,n){},dbdb:function(e,t,n){},dc20:function(e,t,n){},e7b6:function(e,t,n){},e9cc:function(e,t,n){},eb40:function(e,t,n){"use strict";n("ce4f")},ee0e:function(e,t,n){},f075:function(e,t,n){},f194:function(e,t,n){"use strict";n("915e")},f233:function(e,t,n){},f64e:function(e,t,n){},f7bb:function(e,t,n){},f8ca:function(e,t,n){},f9d1:function(e,t,n){"use strict";n("4192")},ffae:function(e,t,n){"use strict";n("1cd1")}});
//# sourceMappingURL=app.080071ea.js.map