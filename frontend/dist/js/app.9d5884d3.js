(function(e){function t(t){for(var s,r,o=t[0],c=t[1],l=t[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(s=!1)}s&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},i={app:0},a=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"05eb":function(e,t,n){"use strict";n("2ce0")},"0b1d":function(e,t,n){"use strict";n("dab6")},"0b61":function(e,t,n){},"0b9d":function(e,t,n){e.exports=n.p+"img/manage-content-element-2.d457ed06.jpg"},"10f6":function(e,t,n){"use strict";n("4430")},"11d2":function(e,t,n){},1417:function(e,t,n){"use strict";n("c922")},1484:function(e,t,n){},"1ba1":function(e,t,n){"use strict";n("0b61")},"1cd1":function(e,t,n){},"1d2a":function(e,t,n){"use strict";n("683a")},"1d96":function(e,t,n){},2155:function(e,t,n){"use strict";n("f7bb")},"23b8":function(e,t,n){},2400:function(e,t,n){},"285e":function(e,t,n){"use strict";n("bb9c")},2966:function(e,t,n){},"296d":function(e,t,n){},"29ed":function(e,t,n){"use strict";n("5fd2")},"2a18":function(e,t,n){"use strict";n("d541")},"2ce0":function(e,t,n){},"2d83":function(e,t,n){},3319:function(e,t,n){"use strict";n("5d4e")},"33a6":function(e,t,n){},3402:function(e,t,n){},"391b":function(e,t,n){},"3a4b":function(e,t,n){"use strict";n("996a")},"3ac6":function(e,t,n){"use strict";n("2966")},"3bdf":function(e,t,n){},"3eb9":function(e,t,n){"use strict";n("9f73")},"3edc":function(e,t,n){"use strict";n("6dd5")},"402b":function(e,t,n){"use strict";n("cbeb")},4192:function(e,t,n){},"435e":function(e,t,n){},"43ef":function(e,t,n){e.exports=n.p+"img/manage-content-element-1.f0e21097.jpg"},4430:function(e,t,n){},4650:function(e,t,n){},4759:function(e,t,n){"use strict";n("ea33")},"4ac7":function(e,t,n){},"4f4f":function(e,t,n){"use strict";n("5856")},5014:function(e,t,n){"use strict";n("a3a9")},"507f":function(e,t,n){},5376:function(e,t,n){"use strict";n("507f")},"56d7":function(e,t,n){"use strict";n.r(t);var s=n("7a23");const i={class:"main__content"};function a(e,t,n,a,r,o){const c=Object(s["J"])("lb-header"),l=Object(s["J"])("lb-toast"),u=Object(s["J"])("router-view");return Object(s["D"])(),Object(s["j"])("main",null,[Object(s["n"])(c),Object(s["k"])("div",i,[Object(s["n"])(l,{type:e.notificationType,message:e.notificationMessage,isOpen:e.isNotificationOpen,onClose:e.closeNotification},null,8,["type","message","isOpen","onClose"]),Object(s["n"])(u)])])}const r={class:"lb-header"},o={class:"lb-header__nav"},c={class:"lb-header__nav-left"},l={class:"lb-header__nav-center"},u={class:"lb-header__nav-right"},d={class:"lb-header__account-text"};function p(e,t,n,i,a,p){const b=Object(s["J"])("router-link"),h=Object(s["J"])("router-view"),m=Object(s["J"])("icon"),g=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("header",r,[Object(s["k"])("nav",o,[Object(s["k"])("div",c,[Object(s["n"])(b,{class:"lb-header__link lb-header__link--main",to:"/"},{default:Object(s["T"])(()=>[Object(s["m"])("Lorebook")]),_:1})]),Object(s["k"])("div",l,[Object(s["n"])(h,{name:"header"})]),Object(s["k"])("div",u,[Object(s["n"])(b,{class:"lb-header__link lb-header__link--account",to:p.setLink},{default:Object(s["T"])(()=>[Object(s["k"])("span",d,Object(s["M"])(p.setAccountLinkText),1),Object(s["n"])(m,{icon:"lb-user",size:1.5},null,8,["size"])]),_:1},8,["to"]),this.username?(Object(s["D"])(),Object(s["h"])(g,{key:0,icon:"lb-logout",size:1.5,onClick:p.logOut},null,8,["size","onClick"])):Object(s["i"])("",!0)])])])}var b=n("5502"),h=n("bc3a"),m=n.n(h);const g=m.a.create({baseURL:"https://ec2-3-75-217-172.eu-central-1.compute.amazonaws.com/api",timeout:5e3,withCredentials:!0});var O=g;const v=async(e,t)=>{const n=await O.post("/login",{name:e,password:t}).then(e=>e.data).catch(e=>{throw e.response?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")});return n};async function j(){return await O.get("/logout").then(()=>!0).catch(e=>{throw e.response?new Error(""+e.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}const y=async()=>{const e=await O.get("/refreshToken").then(e=>e.data).catch(()=>{});return e};var f={name:"LbHeader",computed:{...Object(b["c"])(["username"]),setAccountLinkText(){return this.username?this.username:"Log In"},setLink(){return this.username?"/user":"/login"}},methods:{...Object(b["d"])(["clearUser"]),...Object(b["d"])("universe",["clearUserUniverses","clearUniverse"]),async logOut(){try{await j()}catch(err){console.error(err.message)}finally{this.clearUser(),this.clearUserUniverses(),this.clearUniverse(),this.$router.push("/login")}}}},_=(n("a2e7"),n("6b0d")),k=n.n(_);const w=k()(f,[["render",p]]);var D=w;const C={class:"lb-toast__message"};function E(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["h"])(s["d"],{name:"toast"},{default:Object(s["T"])(()=>[n.isOpen?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:Object(s["w"])(["lb-toast",r.setTypeClass])},[Object(s["n"])(o,{class:"lb-toast__close-button",icon:"lb-cancel-circled",size:1.2,onClick:t[0]||(t[0]=t=>e.$emit("close"))},null,8,["size"]),Object(s["k"])("span",C,Object(s["M"])(n.message),1)],2)):Object(s["i"])("",!0)]),_:1})}var L={name:"LbToast",emits:["close"],props:{message:{type:String,default:""},type:{type:String,validator(e){return"positive"===e||"negative"===e||""===e}},isOpen:{type:Boolean,default:!1}},computed:{setTypeClass(){return"lb-toast--"+this.type}}};n("4f4f");const I=k()(L,[["render",E]]);var x=I,P={name:"App",components:{LbHeader:D,LbToast:x},computed:{...Object(b["c"])("notifications",["isNotificationOpen","notificationMessage","notificationType"])},methods:{...Object(b["d"])(["setUser"]),...Object(b["d"])("notifications",["closeNotification"])}};n("b649");const S=k()(P,[["render",a]]);var T=S,N=n("6605");const U={namespaced:!0,state(){return{isNotificationOpen:!1,notificationType:"",message:""}},mutations:{notify(e,t){e.notificationType=t.type,e.message=t.message,e.isNotificationOpen=!0},closeNotification(e){e.notificationType="",e.message="",e.isNotificationOpen=!1}},getters:{isNotificationOpen(e){return e.isNotificationOpen},notificationMessage(e){return e.message},notificationType(e){return e.notificationType}}};var z=U;async function $(e){return await O.get("/universes/user/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function J(e){return await O.get("/universes/user/list/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function M({name:e,description:t,userID:n}){return await O.post("/universes",{name:e,description:t,userID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function q(e){return await O.delete("/universes/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function B(e){return await O.get("/universes/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function R(e,t){return await O.patch("/universes/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}const G={namespaced:!0,state(){return{universeID:null,universeName:null,userUniverses:[],universesFetchedFlag:!1}},getters:{universeID(e){return e.universeID},universeName(e){return e.universeName},userUniverses(e){return e.userUniverses},checkIfUserOwnsUniverse:e=>t=>e.userUniverses.find(e=>e.id==t.universeID),universesFetchedFlag(e){return e.universesFetchedFlag}},mutations:{setUniverse(e,t){e.universeID=t.id,e.universeName=t.name},setUniverseName(e,t){e.universeName=t},clearUniverse(e){e.universeID=null,e.universeName=null,e.categories=[]},setUserUniverses(e,t){e.userUniverses=t},setUniversesFetchedFlag(e,t){e.universesFetchedFlag=t},pushUserUniverse(e,t){e.userUniverses.push(t)},removerUserUniverse(e,t){e.userUniverses=e.userUniverses.filter(e=>e.id!==t)},clearUserUniverses(e){e.userUniverses=[]}},actions:{async fetchUserUniverses(e){try{if(e.rootGetters.userID){const t=await $(e.rootGetters.userID);e.commit("setUserUniverses",t),e.commit("setUniversesFetchedFlag",!0)}}catch(error){e.commit("notifications/notify",{type:"negative",message:""+error.message},{root:!0})}}}};var V=G;const F={namespaced:!0,state(){return{isCategoriesPopupOpen:!1,isUniverseElementPopupOpen:!1,isLinkPopupOpen:!1,isTagsPopupOpen:!1}},getters:{isCategoriesPopupOpen(e){return e.isCategoriesPopupOpen},isUniverseElementPopupOpen(e){return e.isUniverseElementPopupOpen},isLinkPopupOpen(e){return e.isLinkPopupOpen},isTagsPopupOpen(e){return e.isTagsPopupOpen}},mutations:{openCategoriesPopup(e){e.isCategoriesPopupOpen=!0},closeCategoriesPopup(e){e.isCategoriesPopupOpen=!1},openUniverseElementPopup(e){e.isUniverseElementPopupOpen=!0},closeUniverseElementPopup(e){e.isUniverseElementPopupOpen=!1},openLinkPopup(e){e.isLinkPopupOpen=!0},closeLinkPopup(e){e.isLinkPopupOpen=!1},openTagsPopup(e){e.isTagsPopupOpen=!0},closeTagsPopup(e){e.isTagsPopupOpen=!1}}};var A=F;const H={text:"TEXT",list:"LIST",imageGroup:"IMAGE_GROUP",linkGroup:"LINK_GROUP"};var Y=H;const K={namespaced:!0,state(){return{contentElements:[],contentID:null}},getters:{contentElements(e){return e.contentElements},contentID(e){return e.contentID},config(e){return e.contentElements.map(e=>({id:e.id,type:e.type}))},getElementById:e=>(t,n)=>e.contentElements.find(e=>e.id==t&&e.type==n),getListItemById:e=>(t,n)=>{const s=e.contentElements.find(e=>e.id==t&&e.type==Y.list);return s?s.items.find(e=>e.id==n):null},getListItemByOrder:e=>(t,n)=>{const s=e.contentElements.find(e=>e.id==t&&e.type==Y.list);return s?s.items.find(e=>e.ordinalNumber==n):null},getLinkById:e=>(t,n)=>{const s=e.contentElements.find(e=>e.id==t&&e.type==Y.linkGroup);return s?s.links.find(e=>e.id==n):null}},mutations:{clearContent(e){e.contentElements=[],e.contentID=null},setContent(e,t){e.contentElements=t},setContentID(e,t){e.contentID=t},removeContentElement(e,t){e.contentElements=e.contentElements.filter(e=>!(e.id==t.id&&e.type==t.type))}}};var W=K;const Q=Object(b["a"])({modules:{notifications:z,universe:V,popups:A,element:W},state:{userID:null,username:null,email:null,isAuth:!1,tokenRefreshedFlag:!1},getters:{userID(e){return e.userID},username(e){return e.username},email(e){return e.email},isAuth(e){return e.isAuth},tokenRefreshedFlag(e){return e.tokenRefreshedFlag}},mutations:{setTokenRefreshedFlag(e,t){e.tokenRefreshedFlag=t},setUser(e,t){e.userID=t.id,e.username=t.name,e.email=t.email,e.isAuth=!0},clearUser(e){e.userID=null,e.username=null,e.email=null,e.isAuth=!1}},actions:{}});var X=Q,Z=n("a674"),ee=n.n(Z),te=n("b34f"),ne=n.n(te),se=n("43ef"),ie=n.n(se),ae=n("0b9d"),re=n.n(ae),oe=n("c178"),ce=n.n(oe);const le={class:"main-page"},ue={class:"main-page__content"},de=Object(s["l"])('<div class="main-page__section"><h2 class="main-page__section-title"> What is Lorebook? </h2><div class="util__horizontal-line--black"></div><div class="main-page__section-content"><p class="main-page__paragraph"> Lorebook is an application designed to help writers create their own universes for books, movies, games etc. Creating an entire world can be a very difficult task that requires the collection of a lot of different information. Each universe can consist of many different elements belonging to different categories. These elements are often strongly connected with each other (e.g. locations with events or characters). Keeping all this information in plain text files and documents would be very inefficient for larger projects. It would be hard to maintain relationships between items. </p><p class="main-page__paragraph"> Lorebook is an application that will allow users to save all relevant items in a well-organized database. It allows you to create any elements, describe them, put them in appropriate categories and create connections between them. With Lorebook, you can also create your own stories in your universes. </p></div></div><div class="main-page__section"><h2 class="main-page__section-title"> What features does Lorebook offer? </h2><div class="util__horizontal-line--black"></div><div class="main-page__section-content"><ul class="main-page__ulist"><li class="main-page__ulist-item"> Create your own universes </li><li class="main-page__ulist-item"> Create characters </li><li class="main-page__ulist-item"> Create locations in hierarchy (city in country, country on a continent... etc.) </li><li class="main-page__ulist-item"> Create events with dates </li><li class="main-page__ulist-item"> Create your own element categories (eg: creatures, religions, items, magic systems) </li><li class="main-page__ulist-item"> Describe elements with texts, lists, links etc. on their pages </li><li class="main-page__ulist-item"> Tagging elements in a universe </li><li class="main-page__ulist-item"> Searching all elements created in universe </li><li class="main-page__ulist-item"> Write your stories with use of rich text editor </li><li class="main-page__ulist-item"> Use links to maintain relations between elements </li></ul></div></div><div class="main-page__section"><h2 class="main-page__section-title"> What new features will come in the future? </h2><div class="util__horizontal-line--black"></div><div class="main-page__section-content"><ul class="main-page__ulist"><li class="main-page__ulist-item"> Interactive maps with layers for locations </li><li class="main-page__ulist-item"> Images in content of universe elements </li><li class="main-page__ulist-item"> Character relations page (relations will be displayed as lists and graphs) </li><li class="main-page__ulist-item"> Timelines for events </li><li class="main-page__ulist-item"> Information about all links connected to a specific universe element </li><li class="main-page__ulist-item"> Tree view for hierarchy of locations </li><li class="main-page__ulist-item"> Support for other languages </li><li class="main-page__ulist-item"> Upgrade for rich text editor </li></ul></div></div>',3),pe={class:"main-page__section"},be=Object(s["k"])("h2",{class:"main-page__section-title"}," Instructions ",-1),he=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),me={class:"main-page__section-content main-page__section-content--instructions"},ge=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Log In to your account "),Object(s["k"])("li",{class:"answer__olist-item"}," Go to user page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create New Universe" button '),Object(s["k"])("li",{class:"answer__olist-item"}," Enter title to input (description is optional) "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create" button '),Object(s["k"])("li",{class:"answer__olist-item"}," You should see newly created universe on list of Your Universes on User Page ")])],-1),Oe=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Move your cursor over the title or description "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["m"])(" If you see this half-transparent, blurred background, it means, that this text is editable. "),Object(s["k"])("img",{src:ee.a})]),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("strong",null,"Double Click on this text."),Object(s["m"])(" You will enter in edit mode for this text. You can change the text. "),Object(s["k"])("img",{src:ne.a})]),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to save the text, click on green button or use Ctrl+S shortcut. "),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to cancel changes, click on red button. ")])],-1),ve=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Creating new category "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Manage Categories" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Enter the name into input (Name should be unique to the universe) "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Add new category" button. Now you should be able to use new category ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," Changing category name "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Manage Categories" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Click edit button next to category name. You will enter in edit mode for this category. "),Object(s["k"])("li",{class:"answer__olist-item"},' Change text in "Name" field, then click "Rename" button ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," Deleting category "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Manage Categories" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Click red remove button next to category name, then confirm action. ")])],-1),je=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create Element" button on top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Enter title for new element (description is optional) "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["m"])(" Select type (category) of new element "),Object(s["k"])("ul",{class:"answer__sublist"},[Object(s["k"])("li",{class:"answer__sublist-item"},' If type is "Locations", you can choose parent location. '),Object(s["k"])("li",{class:"answer__sublist-item"},' If type is "Events", you should set date. ')])]),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create Element" button ')])],-1),ye=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," How to create new content element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the Universe Element Page "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("div",{class:"answer__olist-item-content"},[Object(s["k"])("span",null,"Click button for adding new content elements"),Object(s["k"])("img",{src:ie.a})])]),Object(s["k"])("li",{class:"answer__olist-item"}," Click on type of content element you want to create ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," How to move content element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the Universe Element Page "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("div",{class:"answer__olist-item-content"},[Object(s["k"])("span",null,"Move cursor over the content element. You will see new buttons on the right"),Object(s["k"])("img",{src:re.a})])]),Object(s["k"])("li",{class:"answer__olist-item"}," Click on available chosen button ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," How to delete content element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Move cursor over the content element "),Object(s["k"])("li",{class:"answer__olist-item"}," Click on red delete button with trash icon ")])],-1),fe=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Search" button in top navigation '),Object(s["k"])("li",{class:"answer__olist-item"}," Write text to search bar (optional) "),Object(s["k"])("li",{class:"answer__olist-item"}," Choose one or more categories in select (optional) "),Object(s["k"])("li",{class:"answer__olist-item"}," Add some tags (optional) "),Object(s["k"])("li",{class:"answer__olist-item"},[Object(s["k"])("div",{class:"answer__olist-item-content"},[Object(s["k"])("span",null,"Click search button with magnifier icon (next to search bar)"),Object(s["k"])("img",{src:ce.a})])])])],-1),_e=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Create link in content of universe element "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the universe element page "),Object(s["k"])("li",{class:"answer__olist-item"},' Create "Link Group" in content, if you don\'t have one '),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Add new link" button in link group. It will open popup '),Object(s["k"])("li",{class:"answer__olist-item"},' Follow next steps in "How to use popup to create link?" ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," Create link in story chapter "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Enter the chapter page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Add new link" button on left side panel. It will open popup. '),Object(s["k"])("li",{class:"answer__olist-item"},' Follow next steps in "How to use popup to create link?" ')]),Object(s["k"])("h4",{class:"answer__subtitle"}," How to use popup to create link? "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Select type (category) of the element to be linked "),Object(s["k"])("li",{class:"answer__olist-item"}," You will see search bar and list of elements belonging to selected category "),Object(s["k"])("li",{class:"answer__olist-item"}," Click on list item to select it. "),Object(s["k"])("li",{class:"answer__olist-item"}," Write description (optional) "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create link" button ')])],-1),ke=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Adding new tags "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to universe element page "),Object(s["k"])("li",{class:"answer__olist-item"}," You can see tag section in left side panel. Enter text to bottom input, next to green plus button "),Object(s["k"])("li",{class:"answer__olist-item"}," Click green plus button to add tag ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," Managing used tags in universe "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to universe page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Tags" button in top navigation. It will open popup '),Object(s["k"])("li",{class:"answer__olist-item"}," You can see list of all tags used in Universe. You can search them with use of search bar. "),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to delete existing tag, click red button with trash icon next to tag name "),Object(s["k"])("li",{class:"answer__olist-item"}," If you want to edit extisting tag, click blue edit button. You will enter edit mode. "),Object(s["k"])("li",{class:"answer__olist-item"},' Change name in the input, then click "Rename Tag" button ')])],-1),we=Object(s["k"])("div",{class:"answer"},[Object(s["k"])("h4",{class:"answer__subtitle"}," Create Story "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to universe main page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Stories" button (next to "Elements" button) '),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create new Story" button. It will open popup for you '),Object(s["k"])("li",{class:"answer__olist-item"},' Enter the title and descripton, then click "Create" button '),Object(s["k"])("li",{class:"answer__olist-item"}," Popup will close. You will see your story in the list. Click on name to enter the story page ")]),Object(s["k"])("h4",{class:"answer__subtitle"}," Create Chapter "),Object(s["k"])("ol",{class:"answer__olist"},[Object(s["k"])("li",{class:"answer__olist-item"}," Go to story page "),Object(s["k"])("li",{class:"answer__olist-item"},' Click "Create new Chapter" button. It will open popup for you '),Object(s["k"])("li",{class:"answer__olist-item"},' Enter the title and descripton, then click "Create" button '),Object(s["k"])("li",{class:"answer__olist-item"}," Popup will close. You will see your chapter in the list. Click on name to enter the story page. You can change order of chapter with arrow buttons. ")])],-1);function De(e,t,n,i,a,r){const o=Object(s["J"])("lb-accordion");return Object(s["D"])(),Object(s["j"])("div",le,[Object(s["k"])("div",ue,[de,Object(s["k"])("div",pe,[be,he,Object(s["k"])("div",me,[Object(s["n"])(o,{title:"How to create universe?"},{default:Object(s["T"])(()=>[ge]),_:1}),Object(s["n"])(o,{title:"How to edit titles and descriptions of universe, stories, chapters and universe elements?"},{default:Object(s["T"])(()=>[Oe]),_:1}),Object(s["n"])(o,{title:"How to create and manage new categories?"},{default:Object(s["T"])(()=>[ve]),_:1}),Object(s["n"])(o,{title:"How to create new elements?"},{default:Object(s["T"])(()=>[je]),_:1}),Object(s["n"])(o,{title:"How to manage content items of Universe Elements?"},{default:Object(s["T"])(()=>[ye]),_:1}),Object(s["n"])(o,{title:"How to search universe elements?"},{default:Object(s["T"])(()=>[fe]),_:1}),Object(s["n"])(o,{title:"How to create links to universe elements?"},{default:Object(s["T"])(()=>[_e]),_:1}),Object(s["n"])(o,{title:"How to manage tags in universe?"},{default:Object(s["T"])(()=>[ke]),_:1}),Object(s["n"])(o,{title:"How to create stories and chapters?"},{default:Object(s["T"])(()=>[we]),_:1})])])])])}const Ce={class:"lb-accordion"},Ee={class:"lb-accordion__activator"},Le={class:"lb-accordion__activator-right"},Ie={key:0,class:"lb-accordion__activator-subtext"},xe={key:0,class:"lb-accordion__content"};function Pe(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",Ce,[Object(s["k"])("div",Ee,[n.isTitleEditable?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("h3",{key:0,class:"lb-accordion__title lb-accordion__title--static",onClick:t[0]||(t[0]=(...e)=>r.toggleContent&&r.toggleContent(...e))},Object(s["M"])(n.title),1)),n.isTitleEditable?(Object(s["D"])(),Object(s["h"])(o,{key:1,value:n.title,width:"100%",onOnSave:r.changeTitle,maxLength:n.maxLength,customClass:"lb-accordion__title lb-accordion__title--editable"},null,8,["value","onOnSave","maxLength"])):Object(s["i"])("",!0),Object(s["k"])("div",Le,[n.subtext?(Object(s["D"])(),Object(s["j"])("span",Ie,Object(s["M"])(n.subtext),1)):Object(s["i"])("",!0),Object(s["k"])("div",{class:"lb-accordion__activator-button",onClick:t[1]||(t[1]=(...e)=>r.toggleContent&&r.toggleContent(...e))},[Object(s["n"])(c,{icon:r.toggleButtonIcon,size:2},null,8,["icon"])])])]),a.isOpen?(Object(s["D"])(),Object(s["j"])("div",xe,[Object(s["I"])(e.$slots,"default")])):Object(s["i"])("",!0)])}const Se={class:"lb-editable-text"},Te={key:0,class:"lb-editable-text__cancel-button"},Ne=["maxlength"],Ue=["maxlength"],ze={key:2,class:"lb-editable-text__save-button"};function $e(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",Se,[Object(s["k"])("div",{class:Object(s["w"])(["lb-editable-text__content",n.customClass]),style:Object(s["x"])(r.setWidth)},[a.active?(Object(s["D"])(),Object(s["j"])("div",Te,[Object(s["n"])(o,{icon:"lb-cancel-circled",size:1.22,onClick:r.deactivate},null,8,["size","onClick"])])):Object(s["i"])("",!0),a.active?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("pre",{key:1,class:Object(s["w"])(["lb-editable-text__text",r.textClass]),onDblclick:t[0]||(t[0]=(...e)=>r.activate&&r.activate(...e))},Object(s["M"])(n.value?n.value:n.noContent),35)),Object(s["U"])(Object(s["k"])("input",{class:"lb-editable-text__input",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.editedValue=e),maxlength:n.maxLength,ref:"input",onKeydown:t[2]||(t[2]=Object(s["V"])((...e)=>r.saveWithShortcut&&r.saveWithShortcut(...e),["ctrl","prevent","stop"]))},null,40,Ne),[[s["Q"],a.active&&"input"==n.type],[s["P"],a.editedValue]]),Object(s["U"])(Object(s["k"])("textarea",{class:"lb-editable-text__input","onUpdate:modelValue":t[3]||(t[3]=e=>a.editedValue=e),maxlength:n.maxLength,ref:"textarea",style:Object(s["x"])(`min-height: ${n.minHeight}px;`),onKeydown:t[4]||(t[4]=Object(s["V"])((...e)=>r.saveWithShortcut&&r.saveWithShortcut(...e),["ctrl","prevent","stop"]))},null,44,Ue),[[s["Q"],a.active&&"textarea"==n.type],[s["P"],a.editedValue]]),a.active?(Object(s["D"])(),Object(s["j"])("div",ze,[Object(s["n"])(o,{icon:"lb-ok-circle-fill",size:1.22,onClick:r.save},null,8,["size","onClick"])])):Object(s["i"])("",!0)],6)])}var Je={name:"LbEditableText",props:{value:{type:String,default:""},type:{type:String,default:"input",validator(e){return["input","textarea"].includes(e)}},width:{type:String},customClass:{type:String},maxLength:{type:Number},minHeight:{type:Number,default:150},noContent:{type:String,default:"No text"}},emits:["onSave"],data(){return{active:!1,editedValue:this.value}},computed:{textClass(){return this.value?"":"lb-editable-text__text--no-content"},setWidth(){return this.width?`width: ${this.width};`:""}},methods:{activate(){this.active=!0,"input"===this.type?this.$nextTick(()=>{this.$refs.input.focus()}):"textarea"===this.type&&this.$nextTick(()=>{this.$refs.textarea.focus()})},deactivate(){this.active=!1,this.editedValue=this.value},save(){this.$emit("onSave",this.editedValue),this.active=!1},saveWithShortcut(e){83===e.keyCode&&e.ctrlKey&&this.save()}},watch:{value(){this.editedValue=this.value}}};n("3a4b");const Me=k()(Je,[["render",$e]]);var qe=Me,Be={name:"LbAccordion",components:{LbEditableText:qe},emits:["changeTitle"],props:{title:{type:String,required:!0},isTitleEditable:{type:Boolean,default:!1},maxLength:{type:Number},subtext:{type:String}},data(){return{isOpen:!1}},computed:{toggleButtonIcon(){return this.isOpen?"lb-down":"lb-right"}},methods:{toggleContent(){this.isOpen=!this.isOpen},changeTitle(e){this.$emit("changeTitle",e)}}};n("3eb9");const Re=k()(Be,[["render",Pe]]);var Ge=Re,Ve={name:"MainPage",components:{LbAccordion:Ge}};n("d987");const Fe=k()(Ve,[["render",De]]);var Ae=Fe;const He={class:"chapter-page"},Ye={class:"chapter-page__side-panel"},Ke=Object(s["k"])("h2",{class:"chapter-page__side-panel-header-text"}," Links in Chapter ",-1),We=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Qe={key:0,class:"chapter-page__side-panel-links"},Xe={key:1,class:"chapter-page__side-panel-no-links"},Ze={class:"chapter-page__side-panel-bottom"},et={class:"chapter-page__main"},tt={class:"chapter-page__main-header"},nt=Object(s["k"])("label",{class:"chapter-page__main-header-label"},"Description",-1),st={class:"chapter-page__main-content"};function it(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-chapter-link"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-editable-text"),d=Object(s["J"])("rich-editor"),p=Object(s["J"])("link-popup"),b=Object(s["J"])("chapter-link-popup");return Object(s["D"])(),Object(s["j"])("div",He,[Object(s["k"])("div",Ye,[Object(s["k"])("div",{class:"chapter-page__side-panel-content",style:Object(s["x"])(r.sidePanelVisibility)},[Ke,We,Object(s["n"])(o,{icon:"lb-link",size:1.1,onClick:e.openLinkPopup},{default:Object(s["T"])(()=>[Object(s["m"])("Add new link")]),_:1},8,["size","onClick"]),a.links.length?(Object(s["D"])(),Object(s["j"])("div",Qe,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.links,(e,t)=>(Object(s["D"])(),Object(s["h"])(c,Object(s["u"])({key:t},e,{chapterID:parseInt(n.chapterID),onShowLink:r.openChapterLinkPopup}),null,16,["chapterID","onShowLink"]))),128))])):Object(s["i"])("",!0),a.links.length?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Xe," No links ")),Object(s["k"])("div",Ze,[Object(s["n"])(o,{icon:"lb-trash",variant:"negative",size:1.2,onClick:r.removeChapter,loading:a.chapterRemoveLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Remove chapter")]),_:1},8,["size","onClick","loading"])])],4),a.linksLoading?(Object(s["D"])(),Object(s["h"])(l,{key:0})):Object(s["i"])("",!0)]),Object(s["k"])("div",et,[Object(s["k"])("div",tt,[Object(s["n"])(u,{value:a.title,maxLength:80,customClass:"chapter-page__title",class:"chapter-page__title-container",onOnSave:r.changeChapterTitle},null,8,["value","onOnSave"]),nt,Object(s["n"])(u,{value:a.description,maxLength:500,type:"textarea",class:"chapter-page__description-container",customClass:"chapter-page__description",onOnSave:r.changeChapterDescription,noContent:"No description"},null,8,["value","onOnSave"])]),Object(s["k"])("div",st,[Object(s["n"])(d,{content:a.chapterText,saveLoading:a.saveLoading,onUpdate:r.updateChapterText,onSave:r.saveChapterText},null,8,["content","saveLoading","onUpdate","onSave"])])]),e.isLinkPopupOpen?(Object(s["D"])(),Object(s["h"])(p,{key:0,chapterID:parseInt(n.chapterID),onOnResult:r.addNewLink},null,8,["chapterID","onOnResult"])):Object(s["i"])("",!0),a.isChapterLinkPopupOpen?(Object(s["D"])(),Object(s["h"])(b,Object(s["u"])({key:1,isOpen:a.isChapterLinkPopupOpen},a.linkInPopup,{onChangeDescription:r.changeLinkDescription,onDeleteLink:r.deleteLink,onClose:r.closeChapterLinkPopup}),null,16,["isOpen","onChangeDescription","onDeleteLink","onClose"])):Object(s["i"])("",!0)])}const at={class:"rich-editor"},rt={class:"rich-editor__menu"};function ot(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("editor-content");return Object(s["D"])(),Object(s["j"])("div",at,[Object(s["k"])("div",rt,[Object(s["k"])("button",{class:"rich-editor__menu-btn rich-editor__menu-btn--bold",onClick:t[0]||(t[0]=(...e)=>r.bold&&r.bold(...e))},"B"),Object(s["k"])("button",{class:"rich-editor__menu-btn rich-editor__menu-btn--italic",onClick:t[1]||(t[1]=(...e)=>r.italic&&r.italic(...e))},"I"),Object(s["k"])("button",{class:"rich-editor__menu-btn rich-editor__menu-btn--underline",onClick:t[2]||(t[2]=(...e)=>r.underline&&r.underline(...e))},"U"),Object(s["n"])(o,{class:"rich-editor__save-btn",variant:"positive",size:1.1,loading:n.saveLoading,onClick:t[3]||(t[3]=t=>e.$emit("save"))},{default:Object(s["T"])(()=>[Object(s["m"])("Save")]),_:1},8,["size","loading"])]),Object(s["n"])(c,{class:"rich-editor__content",editor:a.editor,onKeydown:Object(s["V"])(r.saveWithShortcut,["ctrl","prevent","stop"])},null,8,["editor","onKeydown"])])}var ct=n("c1e2"),lt=n("cc86"),ut=n("672a"),dt={name:"RichEditor",components:{EditorContent:ct["b"]},props:{content:{type:Object,default:()=>({type:"doc",content:[{type:"paragraph"}]})},saveLoading:{type:Boolean,default:!1}},data(){return{editor:null}},methods:{bold(){this.editor.chain().focus().toggleBold().run()},italic(){this.editor.chain().focus().toggleItalic().run()},underline(){this.editor.chain().focus().toggleUnderline().run()},saveWithShortcut(e){83===e.keyCode&&e.ctrlKey&&this.$emit("save")}},watch:{content(e){const t=JSON.stringify(this.editor.getJSON())===JSON.stringify(e);t||this.editor.commands.setContent(e,!1)}},mounted(){this.editor=new ct["a"]({content:this.content,extensions:[ut["a"],lt["a"]],onUpdate:()=>{this.$emit("update",this.editor.getJSON())}})},beforeUnmount(){this.editor.destroy()}};n("05eb");const pt=k()(dt,[["render",ot]]);var bt=pt,ht=n("bf68");const mt="/chapters",gt={type:"doc",content:[{type:"paragraph"}]};function Ot(e){return e.map(e=>({id:e.id,title:e.title,description:e.description,ordinalNumber:e.ordinal_number}))}async function vt(e){return O.get(`${mt}/${e}`).then(e=>{let t={id:e.data.id,title:e.data.title,description:e.data.description,text:e.data.text,ordinalNumber:e.data.ordinal_number,storyID:e.data.Story_id};return t}).catch(e=>{throw e.response?new Error(""+e.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function jt(e){return await O.get("/chapters/story/"+e).then(e=>Ot(e.data)).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function yt(e,t,n,s){const i={title:e,description:t,text:gt,ordinalNumber:n,storyID:s};return O.post("/chapters",i).then(e=>e.data).catch(e=>{throw e.response?new Error(""+e.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ft(e,t){if(t.text)throw new Error('Cannot update text directly. You should use "textPatch" field.');return await O.patch("/chapters/"+e,t).then(e=>!0).catch(e=>{throw e.response?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function _t(e,t){return await O.patch("/chapters/position/"+e,t).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function kt(e){return await O.delete("/chapters/"+e).then(e=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}function wt(e){return e.Character_id?e.Character_id:e.Location_id?e.Location_id:e.Event_id?e.Event_id:e.Entry_id?e.Entry_id:void 0}function Dt(e){return{id:e.id,description:e.description,targetName:e.target.name,targetID:wt(e),categoryName:e.target.Category.name,categoryID:e.target.Category.id}}async function Ct(e,t){let n=e;return n.contentID=t,await O.post("/link_groups/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Et(e,t,n){const s=n?`/links/${e}/content/${n}`:"/links/"+e;return await O.patch(s,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Lt(e,t,n){return await O.patch(`/link_groups/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function It(e,t){return await O.delete(`/link_groups/${e}/content/${t}`).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function xt(e,t){const n=t?`/links/${e}/content/${t}`:"/links/"+e;return await O.delete(n).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Pt(e,t,n,s,i){let a;switch(t){case"Locations":a="Location";break;case"Characters":a="Character";break;case"Events":a="Event";break;default:a="Entry";break}const r={targetID:e,targetType:a,description:n};if(s&&!i)r.linkGroupID=s;else{if(!i||s)throw new Error("You should give linkGroupID OR chapterID in arguments");r.chapterID=i}return await O.post("/links",r).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function St(e){return await O.get("/links/chapter/"+e).then(e=>e.data.map(e=>Dt(e))).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}const Tt={class:"link-popup"},Nt=Object(s["k"])("h2",{class:"link-popup__field-title"},"Type of target",-1),Ut={key:0,class:"link-popup__search-field"},zt=Object(s["k"])("h2",{class:"link-popup__field-title"},"Target",-1),$t={class:"link-popup__buttons"};function Jt(e,t,n,i,a,r){const o=Object(s["J"])("lb-select"),c=Object(s["J"])("lb-search-bar"),l=Object(s["J"])("lb-select-list"),u=Object(s["J"])("lb-page-nav"),d=Object(s["J"])("lb-input"),p=Object(s["J"])("lb-button"),b=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(b,{isOpen:e.isLinkPopupOpen,title:"Create Link",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Tt,[Object(s["k"])("div",null,[Nt,Object(s["n"])(o,{items:a.categories,width:"100%",placeholder:"Select type of link target",loading:a.categoriesLoading,onHandleSelection:r.selectCategory},null,8,["items","loading","onHandleSelection"])]),null!==a.selectedCategory?(Object(s["D"])(),Object(s["j"])("div",Ut,[zt,Object(s["n"])(c,{placeholder:"Search target",onSearch:r.search,text:a.searchText},null,8,["onSearch","text"]),Object(s["n"])(l,{items:r.filteredElements,loading:a.areElementsLoading,selectedID:a.targetElementID,onOnSelect:r.selectTargetElement,maxHeight:"250px"},null,8,["items","loading","selectedID","onOnSelect"]),1!=a.totalPages?(Object(s["D"])(),Object(s["h"])(u,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage,class:"link-popup__page-nav"},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)])):Object(s["i"])("",!0),Object(s["n"])(d,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e),maxLength:250},null,8,["value"]),Object(s["k"])("div",$t,[Object(s["n"])(p,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(p,{variant:"positive",size:1.4,onClick:r.createNewLink,disabled:r.isCreateButtonDisabled,loading:a.createLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Create Link")]),_:1},8,["size","onClick","disabled","loading"])])])]),_:1},8,["isOpen","onClose"])}const Mt={class:"lb-input"},qt={class:"lb-input__header"},Bt=["type","maxlength"],Rt=["maxlength"];function Gt(e,t,n,i,a,r){const o=Object(s["J"])("lb-small-error");return Object(s["D"])(),Object(s["j"])("div",Mt,[Object(s["k"])("div",qt,[n.name?(Object(s["D"])(),Object(s["j"])("h2",{key:0,class:"lb-input__title",style:Object(s["x"])(r.setSize.title)},Object(s["M"])(n.name),5)):Object(s["i"])("",!0),n.error.length&&!a.isFocused?(Object(s["D"])(),Object(s["h"])(o,{key:1,text:n.error,size:1.5},null,8,["text","size"])):Object(s["i"])("",!0)]),"textarea"!==n.type?Object(s["U"])((Object(s["D"])(),Object(s["j"])("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),type:n.type,class:Object(s["w"])(r.fieldClass),maxlength:n.maxLength,style:Object(s["x"])(r.setSize.input),onInput:t[1]||(t[1]=t=>e.$emit("update:value",n.value)),onChange:t[2]||(t[2]=t=>e.$emit("change:value",n.value)),onFocus:t[3]||(t[3]=e=>a.isFocused=!0),onBlur:t[4]||(t[4]=e=>a.isFocused=!1)},null,46,Bt)),[[s["O"],n.value]]):Object(s["U"])((Object(s["D"])(),Object(s["j"])("textarea",{key:1,"onUpdate:modelValue":t[5]||(t[5]=e=>n.value=e),class:Object(s["w"])(r.fieldClass),maxlength:n.maxLength,style:Object(s["x"])(r.setSize.textarea),onInput:t[6]||(t[6]=t=>e.$emit("update:value",n.value)),onFocus:t[7]||(t[7]=e=>a.isFocused=!0),onBlur:t[8]||(t[8]=e=>a.isFocused=!1)},null,46,Rt)),[[s["P"],n.value]])])}const Vt={key:0,class:"lb-small-error"},Ft={class:"lb-small-error__container"},At={class:"lb-small-error__icon"};function Ht(e,t,n,i,a,r){const o=Object(s["J"])("icon");return r.haveText?(Object(s["D"])(),Object(s["j"])("div",Vt,[Object(s["k"])("div",Ft,[Object(s["k"])("div",At,[Object(s["n"])(o,{icon:"lb-warning-circle-fill",size:this.size},null,8,["size"])]),Object(s["k"])("div",{class:"lb-small-error__wrap-text",style:Object(s["x"])(`left: ${n.size}rem; min-width: ${10*n.size}rem;`)},[Object(s["k"])("div",{class:"lb-small-error__content",style:Object(s["x"])(`font-size: ${.5*n.size}rem;`)},Object(s["M"])(n.text),5)],4)])])):Object(s["i"])("",!0)}var Yt={name:"LbSmallError",props:{size:{type:Number,default:1},text:{type:String,default:""}},computed:{haveText(){return""!=this.text}}};n("5a24");const Kt=k()(Yt,[["render",Ht]]);var Wt=Kt,Qt={components:{LbSmallError:Wt},name:"LbInput",emits:["update:value","change:value"],props:{name:{type:String},type:{type:String,default:"text"},value:{type:[String,Number],required:!0},error:{type:String,default:""},maxLength:{type:Number},minHeight:{type:Number,default:150},fontSize:{type:Number,default:1.2}},data(){return{isFocused:!1}},computed:{fieldClass(){return this.error.length&&!this.isFocused?"lb-input__field lb-input__field--invalid":"lb-input__field"},setSize(){return{title:`font-size: ${this.fontSize+.2}rem;`,input:`font-size: ${this.fontSize}rem;`,textarea:`font-size: ${this.fontSize}rem; min-height: ${this.minHeight}px;`}}}};n("7267");const Xt=k()(Qt,[["render",Gt]]);var Zt=Xt;const en={class:"lb-select__text-field"},tn={class:"lb-select__button"},nn={class:"lb-select__dropdown"},sn={key:0,class:"lb-select__dropdown-content"},an=["onClick"],rn={class:"lb-select__item-text"},on={key:1,class:"lb-select__no-content"};function cn(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",{class:"lb-select",style:Object(s["x"])(r.setWidth)},[Object(s["k"])("div",{class:Object(s["w"])(["lb-select__control",r.setClass]),onClick:t[0]||(t[0]=(...e)=>r.toggleOpen&&r.toggleOpen(...e))},[Object(s["k"])("div",en,Object(s["M"])(r.setSelectText),1),Object(s["k"])("div",tn,[Object(s["n"])(o,{icon:r.setIcon},null,8,["icon"])]),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0,variant:"dark",size:"25px"})):Object(s["i"])("",!0)],2),Object(s["U"])(Object(s["k"])("div",nn,[a.itemsToSelect.length>0?(Object(s["D"])(),Object(s["j"])("div",sn,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.itemsToSelect,(e,t)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-select__item",key:t,onClick:e=>r.selectItem(t)},[Object(s["k"])("span",rn,Object(s["M"])(e.name),1),Object(s["k"])("div",{class:"lb-select__item-icon",style:Object(s["x"])(e.selected?"visibility: visible;":"visibility: hidden;")},[Object(s["n"])(o,{icon:"lb-ok"})],4)],8,an))),128))])):(Object(s["D"])(),Object(s["j"])("div",on," No items "))],512),[[s["Q"],a.isOpen]])],4)}var ln={name:"LbSelect",props:{items:{type:Array,default:[]},multiselect:{type:Boolean,default:!1},placeholder:{type:String,default:""},width:{type:String,default:"150px"},loading:{type:Boolean,default:!1}},emits:["handleSelection"],data(){return{isOpen:!1,itemsToSelect:this.items,selectedItems:[]}},computed:{setClass(){return this.loading?"lb-select__control--loading":""},setIcon(){return this.isOpen?"lb-up":"lb-down"},setSelectText(){return 0===this.selectedItems.length?this.placeholder:1==this.selectedItems.length?this.selectedItems[0].name:this.selectedItems.length+" selected options"},setWidth(){return`width: ${this.width};`}},methods:{toggleOpen(){this.loading||(this.isOpen=!this.isOpen)},selectItem(e){if(this.multiselect)this.itemsToSelect[e].selected=!this.itemsToSelect[e].selected,this.selectedItems=this.itemsToSelect.filter(e=>e.selected),this.$emit("handleSelection",this.selectedItems);else{this.itemsToSelect[e].selected=!this.itemsToSelect[e].selected;for(let t=0;t<this.itemsToSelect.length;t++)t!=e&&(this.itemsToSelect[t].selected=!1);this.selectedItems=this.itemsToSelect[e].selected?[this.itemsToSelect[e]]:[],this.$emit("handleSelection",this.selectedItems),this.isOpen=!1}}}};n("a853");const un=k()(ln,[["render",cn]]);var dn=un;const pn={class:"lb-select-list"},bn={class:"lb-select-list__header"},hn=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),mn=["onClick"],gn={class:"lb-select-list__item-name"},On={key:1,class:"lb-select-list__no-items"};function vn(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",pn,[Object(s["k"])("div",bn,[Object(s["k"])("h2",{class:"lb-select-list__header-text",style:Object(s["x"])(`font-size: ${n.size+.3}rem`)},Object(s["M"])(n.headText),5),hn]),n.items.length?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:"lb-select-list__items",style:Object(s["x"])(r.itemsStyle)},[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.items,(e,t)=>(Object(s["D"])(),Object(s["j"])("div",{class:Object(s["w"])(["lb-select-list__item",r.itemChecked(e.id).listItem]),key:t,onClick:t=>r.selectItem(e.id)},[Object(s["k"])("div",{class:"lb-select-list__item-content",style:Object(s["x"])(`font-size: ${n.size}rem`)},[Object(s["k"])("span",gn,Object(s["M"])(e.name),1),Object(s["n"])(o,{icon:"lb-ok",class:"lb-select-list__check-icon",size:n.size},null,8,["size"])],4),Object(s["k"])("div",{class:Object(s["w"])(r.itemChecked(e.id).line)},null,2)],10,mn))),128))],4)):Object(s["i"])("",!0),0==n.items.length?(Object(s["D"])(),Object(s["j"])("div",On,Object(s["M"])(n.noItemsText),1)):Object(s["i"])("",!0),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:2})):Object(s["i"])("",!0)])}var jn={name:"LbSelectList",emits:["onSelect"],props:{headText:{type:String,default:"Name"},selectedID:{type:Number,default:null},items:{type:Array,default:[]},noItemsText:{type:String,default:"No Elements"},loading:{type:Boolean,default:!1},size:{type:Number,default:1},maxHeight:{type:String}},computed:{itemsStyle(){const e=this.maxHeight?`max-height: ${this.maxHeight};`:"",t=this.loading?"visibility: hidden;":"visibility: visible;";return`${e} ${t}`}},methods:{itemChecked(e){return this.selectedID==e?{listItem:"lb-select-list__item--checked",line:"util__horizontal-line--green"}:{listItem:"",line:"util__horizontal-line--white"}},selectItem(e){this.loading||this.$emit("onSelect",e)}}};n("6b23");const yn=k()(jn,[["render",vn]]);var fn=yn;const _n=["placeholder"];function kn(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",{class:"lb-search-bar",style:Object(s["x"])(`width: ${n.width};`)},[Object(s["U"])(Object(s["k"])("input",{class:"lb-search-bar__input",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:n.placeholder,onKeydown:t[1]||(t[1]=(...e)=>r.handleEnterPress&&r.handleEnterPress(...e))},null,40,_n),[[s["P"],a.value]]),Object(s["k"])("button",{class:"lb-search-bar__button",onClick:t[2]||(t[2]=t=>e.$emit("search",a.value))},[Object(s["n"])(o,{icon:"lb-search"})])],4)}var wn={name:"LbSearchBar",emits:["search"],props:{placeholder:{type:String,default:"Search..."},width:{type:String,default:"100%"},text:{type:String,default:""}},data(){return{value:this.text}},methods:{handleEnterPress(e){"Enter"==e.key&&(e.preventDefault(),this.$emit("search",this.value))}},watch:{text(e){this.value=e}}};n("10f6");const Dn=k()(wn,[["render",kn]]);var Cn=Dn;const En={class:"lb-page-nav"},Ln={class:"lb-page-nav__pages"},In=["max"],xn=Object(s["k"])("span",null,"of",-1),Pn={class:"lb-page-nav__total-pages"};function Sn(e,t,n,i,a,r){const o=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",En,[Object(s["n"])(o,{icon:"lb-left",size:1.4,disabled:r.prevButtonState,onClick:t[0]||(t[0]=e=>this.$emit("go",this.currentPage-1))},null,8,["size","disabled"]),Object(s["k"])("div",Ln,[Object(s["U"])(Object(s["k"])("input",{class:"lb-page-nav__input",type:"number",min:1,max:n.totalPages,"onUpdate:modelValue":t[1]||(t[1]=e=>a.pageNumber=e),onKeydown:t[2]||(t[2]=(...e)=>r.submitOnKey&&r.submitOnKey(...e))},null,40,In),[[s["P"],a.pageNumber]]),xn,Object(s["k"])("span",Pn,Object(s["M"])(n.totalPages),1)]),Object(s["n"])(o,{icon:"lb-right",size:1.4,disabled:r.nextButtonState,onClick:t[3]||(t[3]=e=>this.$emit("go",this.currentPage+1))},null,8,["size","disabled"]),Object(s["n"])(o,{size:1.1,onClick:r.submitPageNumber,class:"lb-page-nav__go-button"},{default:Object(s["T"])(()=>[Object(s["m"])(" Go ")]),_:1},8,["size","onClick"])])}var Tn={name:"LbPageNav",props:{currentPage:{type:Number,default:1},totalPages:{type:Number,required:!0}},emits:["go"],data(){return{pageNumber:this.currentPage}},computed:{prevButtonState(){return this.currentPage-1<1},nextButtonState(){return this.currentPage+1>this.totalPages}},methods:{submitPageNumber(){this.pageNumber<1?(this.$emit("go",1),this.pageNumber=1):this.pageNumber>this.totalPages?(this.$emit("go",this.totalPages),this.pageNumber=this.totalPages):this.$emit("go",this.pageNumber)},submitOnKey(e){13===e.keyCode&&(e.preventDefault(),this.submitPageNumber())}},watch:{currentPage(e){this.pageNumber=e}}};n("85c8");const Nn=k()(Tn,[["render",Sn]]);var Un=Nn;async function zn(e){return await O.get("/categories/universe/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function $n(e){return await O.get("/categories/universe/list/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Jn({name:e,universeID:t}){return await O.post("/categories",{name:e,universeID:t}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Mn(e,t){return await O.patch("/categories/"+e,{name:t}).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function qn(e){return await O.delete("/categories/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Bn(e){return await O.get("/categories/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}class Rn extends Error{constructor(e){super(e),this.name="NotFoundException"}}async function Gn(e){return await O.get("/characters/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Rn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Vn(e,t){return await O.patch("/characters/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Fn(e,t,n){return await O.post("/characters",{name:e,description:t,universeID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function An(e,t,n,s){const i=encodeURIComponent(t);return await O.get(`/characters/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Hn(e){return await O.delete("/characters/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Yn(e){return await O.get("/entries/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Rn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Kn(e,t){return await O.patch("/entries/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Wn(e,t,n){return await O.post("/entries",{name:e,description:t,categoryID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Qn(e,t,n,s){const i=encodeURIComponent(t);return await O.get(`/entries/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Xn(e){return await O.delete("/entries/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}function Zn(e){return{id:e.id,name:e.name,description:e.description,parentID:e.Location_id,Universe_id:e.Universe_id,parentName:e.parentName}}async function es(e){return await O.get("/locations/"+e).then(e=>Zn(e.data)).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Rn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ts(e,t){return await O.patch("/locations/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ns(e,t,n,s){return await O.post("/locations",{name:e,description:t,universeID:n,locationID:s}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ss(e){return await O.get("/locations/universe/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function is(e,t,n,s){const i=encodeURIComponent(t);return await O.get(`/locations/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function as(e){return await O.delete("/locations/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function rs(e){return await O.get("/events/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new Rn(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function os(e,t){return await O.patch("/events/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function cs(e,t,n,s){return await O.post("/events",{name:e,description:t,date:n,universeID:s}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ls(e,t,n,s){const i=encodeURIComponent(t);return await O.get(`/events/search/${e}?q=${i}&limit=${n}&offset=${s}`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function us(e){return await O.delete("/events/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ds(e,t){let n=null;return n="Characters"==t?await Gn(e):"Locations"==t?await es(e):"Events"==t?await rs(e):await Yn(e),n}async function ps(e,t,n){"Characters"==n?await Vn(e,t):"Locations"==n?await ts(e,t):"Events"==n?await os(e,t):await Kn(e,t)}async function bs(e,t,n,s,i){let a=null;switch(i){case"Locations":a=await is(e,t,n,s);break;case"Characters":a=await An(e,t,n,s);break;case"Events":a=await ls(e,t,n,s);break;default:a=await Qn(i,t,n,s);break}const r={elements:a.rows,elementCount:a.count,totalPages:Math.ceil(a.count/n)};return r}async function hs(e,t){"Characters"==t?await Hn(e):"Locations"==t?await as(e):"Events"==t?await us(e):await Xn(e)}var ms={name:"LinkPopup",emits:["onResult"],components:{LbInput:Zt,LbSelect:dn,LbSelectList:fn,LbSearchBar:Cn,LbPageNav:Un},props:{chapterID:{type:Number,default:null},linkGroupID:{type:Number,default:null},elementID:{type:Number,default:null},elementCategoryID:{type:String,default:null}},data(){return{createLoading:!1,description:"",categories:[],selectedCategory:null,categoriesLoading:!1,elements:[],targetElementID:null,areElementsLoading:!1,searchText:"",currentPage:1,totalPages:1}},computed:{...Object(b["c"])("popups",["isLinkPopupOpen"]),...Object(b["c"])("universe",["universeID"]),isCreateButtonDisabled(){return null===this.selectedCategory||null===this.targetElementID},filteredElements(){return this.selectedCategory==this.elementCategoryID?this.elements.filter(e=>e.id!=this.elementID):this.elements}},methods:{...Object(b["d"])("popups",["closeLinkPopup"]),...Object(b["d"])("notifications",["notify"]),close(){this.closeLinkPopup()},async fetchCategories(){try{this.categoriesLoading=!0;const e=[{id:"Characters",name:"Characters"},{id:"Locations",name:"Locations"},{id:"Events",name:"Events"}],t=await zn(this.universeID);this.categories.push(...e,...t)}catch(error){this.notify({type:"negative",message:error.message})}finally{this.categoriesLoading=!1}},async fetchElements(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=25;this.areElementsLoading=!0;try{const t=0!==n?n*s-s:0,i=await bs(this.universeID,e,s,t,this.selectedCategory);this.elementCount=i.elementCount,this.elements=i.elements,this.totalPages=i.totalPages}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.areElementsLoading=!1}},async selectCategory(e){this.selectedCategory=e.length?e[0].id:null,null!==this.selectedCategory&&(this.targetElementID=null,this.searchText="",this.currentPage=1,await this.search(this.searchText))},async selectTargetElement(e){this.targetElementID=this.targetElementID!==e?e:null},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchElements(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},async createNewLink(){try{if(this.chapterID&&this.linkGroupID)throw new Error("Only one of this must be defined (chapterID or linkGroupID)");this.createLoading=!0;const e=this.categories.find(e=>e.id==this.selectedCategory),t=this.elements.find(e=>e.id==this.targetElementID),n=this.description,s=await Pt(this.targetElementID,this.selectedCategory,n,this.linkGroupID,this.chapterID);this.$emit("onResult",{id:s.id,description:n,targetID:t.id,targetName:t.name,categoryID:e.id,categoryName:e.name}),this.closeLinkPopup()}catch(error){this.notify({type:"negative",message:error.message})}finally{this.createLoading=!1}}},async mounted(){await this.fetchCategories()},unmounted(){this.closeLinkPopup()}};n("8c74");const gs=k()(ms,[["render",Jt]]);var Os=gs;const vs={class:"lb-chapter-link"},js={class:"lb-chapter-link__content"},ys={class:"lb-chapter-link__category"},fs={class:"lb-chapter-link__button"};function _s(e,t,n,i,a,r){const o=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",vs,[Object(s["k"])("div",js,[Object(s["k"])("div",ys,Object(s["M"])(n.categoryName),1),Object(s["k"])("div",{class:"lb-chapter-link__name",onClick:t[0]||(t[0]=(...e)=>r.navigateToElement&&r.navigateToElement(...e))},Object(s["M"])(n.targetName),1)]),Object(s["k"])("div",fs,[Object(s["n"])(o,{size:1.1,icon:"lb-info-circle",class:"lb-chapter-link__button-icon",onClick:r.showLink},null,8,["size","onClick"])])])}var ks={name:"LbChapterLink",emits:["showLink"],props:{chapterID:{type:Number,required:!0},id:{type:Number,required:!0},description:{type:String},targetID:{type:Number,required:!0},targetName:{type:String,rquired:!0},categoryID:{type:[Number,String],required:!0},categoryName:{type:String,required:!0}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{navigateToElement(){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.categoryID,elementID:this.targetID}})},showLink(){this.$emit("showLink",this.id)}}};n("9bb8");const ws=k()(ks,[["render",_s]]);var Ds=ws;const Cs={class:"chapter-link-popup"},Es={class:"chapter-link-popup__header"},Ls={class:"chapter-link-popup__category-name"},Is={class:"chapter-link-popup__target-name"},xs=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),Ps={class:"chapter-link-popup__content"},Ss=Object(s["k"])("label",{class:"chapter-link-popup__description-label"}," Description ",-1),Ts={class:"chapter-link-popup__delete-btn"};function Ns(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(l,{isOpen:n.isOpen,title:"Link in Chapter",onClose:t[0]||(t[0]=t=>e.$emit("close"))},{default:Object(s["T"])(()=>[Object(s["k"])("div",Cs,[Object(s["k"])("div",Es,[Object(s["k"])("div",Ls,Object(s["M"])(n.categoryName),1),Object(s["k"])("div",Is,Object(s["M"])(n.targetName),1),xs]),Object(s["k"])("div",Ps,[Ss,Object(s["n"])(o,{value:a.editableDescription,maxLength:250,type:"textarea",class:"chapter-link-popup__description-container",customClass:"chapter-link-popup__description",onOnSave:r.changeChapterDescription,noContent:"No description"},null,8,["value","onOnSave"]),Object(s["k"])("div",Ts,[Object(s["n"])(c,{icon:"lb-unlink",variant:"negative",onClick:r.deleteChapterLink,size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Remove link from chapter")]),_:1},8,["onClick","size"])])])])]),_:1},8,["isOpen"])}var Us={name:"ChapterLinkPopup",components:{LbEditableText:qe},emits:["changeDescription","deleteLink","close"],props:{isOpen:{type:Boolean,default:!1},id:{type:Number,required:!0},description:{type:String},targetID:{type:Number,required:!0},targetName:{type:String,rquired:!0},categoryID:{type:[Number,String],required:!0},categoryName:{type:String,required:!0}},data(){return{editableDescription:this.description,removeLinkLoading:!0}},methods:{...Object(b["d"])("notifications",["notify"]),async changeChapterDescription(e){try{await Et(this.id,{description:e}),this.editableDescription=e,this.$emit("changeDescription",{id:this.id,newValue:this.editableDescription})}catch(error){this.notify({type:"negative",message:error.message})}},async deleteChapterLink(){try{this.removeLinkLoading=!0,await xt(this.id),this.$emit("deleteLink",this.id),this.$emit("close")}catch(error){this.notify({type:"negative",message:error.message})}finally{this.removeLinkLoading=!1}}}};n("3edc");const zs=k()(Us,[["render",Ns]]);var $s=zs,Js={name:"App",components:{RichEditor:bt,LbEditableText:qe,LinkPopup:Os,LbChapterLink:Ds,ChapterLinkPopup:$s},props:{chapterID:{type:String},storyID:{type:String}},data(){return{title:"",description:"",chapterText:{type:"doc",content:[{type:"paragraph"}]},oldChapterText:{type:"doc",content:[{type:"paragraph"}]},saveLoading:!1,linksLoading:!1,links:[],linkInPopup:null,isChapterLinkPopupOpen:!1,chapterRemoveLoading:!1}},computed:{...Object(b["c"])("popups",["isLinkPopupOpen"]),...Object(b["c"])("universe",["universeID"]),sidePanelVisibility(){return this.linksLoading?"visibility: hidden;":"visibility: visible;"}},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("popups",["openLinkPopup"]),updateChapterText(e){this.chapterText=e},async saveChapterText(){this.saveLoading=!0;const e=Object(ht["createPatch"])("newText",JSON.stringify(this.oldChapterText),JSON.stringify(this.chapterText));try{await ft(this.chapterID,{textPatch:e}),this.oldChapterText=this.chapterText}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.saveLoading=!1}},async fetchChapter(){try{const e=await vt(this.chapterID);this.chapterText=e.text,this.title=e.title,this.description=e.description,this.oldChapterText=this.chapterText}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async fetchChapterLinks(){try{this.linksLoading=!0,this.links=await St(this.chapterID)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.linksLoading=!1}},async changeChapterTitle(e){try{await ft(this.chapterID,{title:e}),this.title=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async changeChapterDescription(e){try{await ft(this.chapterID,{description:e}),this.description=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},addNewLink(e){this.links.push(e)},openChapterLinkPopup(e){this.linkInPopup=this.links.find(t=>t.id===e),this.isChapterLinkPopupOpen=!0},closeChapterLinkPopup(){this.isChapterLinkPopupOpen=!1,this.linkInPopup=null},changeLinkDescription(e){try{const{id:t,newValue:n}=e,s=this.links.find(e=>e.id===t);s.description=n}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},deleteLink(e){try{this.links=this.links.filter(t=>t.id!==e)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async removeChapter(){try{this.chapterRemoveLoading=!0,await kt(this.chapterID),this.$router.replace({name:"StoryChaptersPage",params:{universeID:this.universeID,storyID:this.storyID}})}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.chapterRemoveLoading=!1}}},async mounted(){await this.fetchChapter(),await this.fetchChapterLinks()}};n("7a10");const Ms=k()(Js,[["render",it]]);var qs=Ms;const Bs={class:"register-page"},Rs={class:"register-page__form"},Gs=Object(s["k"])("h1",{class:"register-page__header"},"Create new account",-1),Vs=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Fs={class:"register-page__inputs"},As={class:"register-page__bottom"};function Hs(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("router-link"),l=Object(s["J"])("lb-button"),u=Object(s["J"])("lb-spinner"),d=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["j"])("div",Bs,[Object(s["k"])("div",Rs,[Object(s["k"])("div",{style:Object(s["x"])(r.isFormVisible)},[Gs,Vs,Object(s["k"])("div",Fs,[Object(s["n"])(o,{name:"Username",value:a.username.value,"onUpdate:value":r.setUsername,maxLength:45,error:a.username.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Email address",type:"email",value:a.email.value,"onUpdate:value":r.setEmail,maxLength:45,error:a.email.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Password",type:"password",value:a.password.value,"onUpdate:value":r.setPassword,maxLength:60,error:a.password.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Confirm Password",type:"password",value:a.passwordConfirm.value,"onUpdate:value":r.setPasswordConfirm,maxLength:60,error:a.passwordConfirm.errorMsg},null,8,["value","onUpdate:value","error"])]),Object(s["k"])("div",As,[Object(s["n"])(c,{to:"/login",class:"register-page__link"},{default:Object(s["T"])(()=>[Object(s["m"])("Already have an account? Log In")]),_:1}),Object(s["n"])(l,{onClick:r.register,size:1.2,disabled:r.isButtonDisabled},{default:Object(s["T"])(()=>[Object(s["m"])("Register")]),_:1},8,["onClick","size","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(u,{key:0,size:"70px",thickness:"10px"})):Object(s["i"])("",!0),Object(s["n"])(d,{isOpen:a.isPopupOpen,title:a.resultTitle,message:a.resultMessage,onClose:r.closePopup},null,8,["isOpen","title","message","onClose"])])])}const Ys={class:"lb-popup-box__header"},Ks={class:"lb-popup-box__title"},Ws={class:"lb-popup-box__close-window-block"},Qs={class:"lb-popup-box__content"},Xs={class:"lb-popup-box__message"};function Zs(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-popper");return Object(s["D"])(),Object(s["h"])(c,{isOpen:n.isOpen},{default:Object(s["T"])(()=>[n.isOpen?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:Object(s["w"])(r.setVariantClass)},[Object(s["k"])("div",Ys,[Object(s["k"])("div",Ks,Object(s["M"])(n.title),1),Object(s["k"])("div",Ws,[Object(s["n"])(o,{id:"lb-popup-box__close-button",onClick:t[0]||(t[0]=t=>e.$emit("close")),icon:"lb-cancel-circled",size:1.5},null,8,["size"])])]),Object(s["k"])("div",Qs,[Object(s["I"])(e.$slots,"default",{},()=>[Object(s["k"])("span",Xs,Object(s["M"])(n.message),1)])])],2)):Object(s["i"])("",!0)]),_:3},8,["isOpen"])}const ei={key:0,class:"lb-popper",tabindex:-1},ti={class:"lb-popper__content"};function ni(e,t,n,i,a,r){const o=Object(s["J"])("focus-trap");return Object(s["D"])(),Object(s["h"])(o,{active:n.isOpen},{default:Object(s["T"])(()=>[this.isOpen?(Object(s["D"])(),Object(s["j"])("div",ei,[Object(s["k"])("div",ti,[Object(s["I"])(e.$slots,"default")])])):Object(s["i"])("",!0)]),_:3},8,["active"])}var si=n("164c"),ii={name:"LbPopper",components:{FocusTrap:si["a"]},props:{isOpen:{type:Boolean,default:!1}}};n("8815");const ai=k()(ii,[["render",ni]]);var ri=ai,oi={components:{LbPopper:ri},name:"LbPopupBox",emits:["close"],props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Title"},message:{type:String,default:"Message text"},variant:{type:String,default:"default",validator(e){return["negative","positive","default"].includes(e)}}},computed:{setVariantClass(){return"lb-popup-box lb-popup-box--"+this.variant}}};n("b10b");const ci=k()(oi,[["render",Zs]]);var li=ci;async function ui(e,t,n){return await O.post("/users",{username:e,password:t,email:n}).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t.path=e.response.data.path,t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var di={name:"RegisterPage",components:{LbInput:Zt,LbPopupBox:li},data(){return{username:{value:"",errorMsg:""},email:{value:"",errorMsg:""},password:{value:"",errorMsg:""},passwordConfirm:{value:"",errorMsg:""},loading:!1,isPopupOpen:!1,resultTitle:"",resultMessage:"",resultType:""}},computed:{isButtonDisabled(){return 0===this.username.value.length||0===this.email.value.length||0===this.password.value.length||0===this.passwordConfirm.value.length},isFormVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"}},methods:{...Object(b["d"])("notifications",["notify"]),setUsername(e){this.username.errorMsg="",this.username.value=e},setEmail(e){this.email.value=e,!this.email.value.includes("@")&&this.email.value.length>0?this.email.errorMsg='Email should contain "@"':this.email.errorMsg=""},setPassword(e){this.password.value=e,this.password.errorMsg="",this.passwordConfirm.value.length>0&&this.passwordConfirm.value!=this.password.value?this.passwordConfirm.errorMsg="Passwords do not match":this.passwordConfirm.errorMsg=""},setPasswordConfirm(e){this.passwordConfirm.value=e,this.passwordConfirm.value!=this.password.value?this.passwordConfirm.errorMsg="Passwords do not match":this.passwordConfirm.errorMsg=""},formValidation(){return""==this.username.errorMsg&&""==this.password.errorMsg&&""==this.passwordConfirm.errorMsg&&""==this.email.errorMsg&&this.username.value.length>0&&this.password.value.length>0&&this.passwordConfirm.value.length>0&&this.email.value.length>0},closePopup(){this.isPopupOpen=!1,this.resultMessage="",this.resultTitle="",this.resultType=""},async register(){if(this.formValidation()){let e=null;this.loading=!0;try{e=await ui(this.username.value,this.password.value,this.email.value)}catch(err){switch(err.path){case"password":this.password.errorMsg=err.message;break;case"email":this.email.errorMsg=err.message;break;case"username":this.username.errorMsg=err.message;break;default:this.resultTitle="Error",this.resultMessage=err.message,this.resultType="negative",this.isPopupOpen=!0;break}}e&&this.notify({type:"positive",message:"User Created"}),this.loading=!1}}}};n("4759");const pi=k()(di,[["render",Hs]]);var bi=pi;const hi={class:"login-page"},mi={class:"login-page__form"},gi=Object(s["k"])("h1",{class:"login-page__header"},"Log In",-1),Oi=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),vi={class:"login-page__inputs"},ji={class:"login-page__bottom"};function yi(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("router-link"),l=Object(s["J"])("lb-button"),u=Object(s["J"])("lb-spinner"),d=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["j"])("div",hi,[Object(s["k"])("div",mi,[Object(s["k"])("div",{style:Object(s["x"])(r.isFormVisible)},[gi,Oi,Object(s["k"])("div",vi,[Object(s["n"])(o,{name:"Username",value:a.username.value,"onUpdate:value":r.setUsername,maxLength:45,error:a.username.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Password",type:"password",value:a.password.value,"onUpdate:value":r.setPassword,maxLength:60,error:a.password.errorMsg},null,8,["value","onUpdate:value","error"])]),Object(s["k"])("div",ji,[Object(s["n"])(c,{to:"/register",class:"login-page__link"},{default:Object(s["T"])(()=>[Object(s["m"])("Don't have an account? Sign Up")]),_:1}),Object(s["n"])(l,{onClick:r.logIn,size:1.2,disabled:r.isButtonDisabled},{default:Object(s["T"])(()=>[Object(s["m"])("Log In")]),_:1},8,["onClick","size","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(u,{key:0,size:"70px",thickness:"10px"})):Object(s["i"])("",!0),a.isErrorOpen?(Object(s["D"])(),Object(s["h"])(d,{key:1,isOpen:a.isErrorOpen,title:"Error",message:a.resultMessage,variant:a.resultType,onClose:r.closeError},null,8,["isOpen","message","variant","onClose"])):Object(s["i"])("",!0)])])}const fi={class:"lb-search-select"},_i={class:"lb-search-select__control"},ki={key:0,class:"lb-search-select__selection"},wi=["placeholder","disabled"],Di={class:"lb-search-select__dropdown"},Ci={key:0,class:"lb-search-select__dropdown-content"},Ei=["onClick"],Li={class:"lb-search-select__item-text"},Ii={key:1,class:"lb-search-select__no-content"};function xi(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",fi,[Object(s["k"])("div",_i,[Object(s["k"])("div",{style:Object(s["x"])(r.isControlVisible),class:"lb-search-select__control-content"},[null!==a.selectedItem?(Object(s["D"])(),Object(s["j"])("div",ki,[Object(s["k"])("span",null,Object(s["M"])(a.selectedItem.name),1),Object(s["n"])(o,{icon:"lb-cancel",onClick:r.removeSelection,class:"lb-search-select__remove-button",size:1.2},null,8,["onClick","size"])])):Object(s["i"])("",!0),null===a.selectedItem?Object(s["U"])((Object(s["D"])(),Object(s["j"])("input",{key:1,type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:n.placeholder,class:"lb-search-select__input",disabled:n.loading},null,8,wi)),[[s["P"],a.value]]):Object(s["i"])("",!0)],4),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0,size:"1.3rem"})):Object(s["i"])("",!0)]),Object(s["U"])(Object(s["k"])("div",Di,[r.filteredItems.length>0?(Object(s["D"])(),Object(s["j"])("div",Ci,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(r.filteredItems,(e,t)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-search-select__item",key:t,onClick:e=>r.selectItem(t)},[Object(s["k"])("span",Li,Object(s["M"])(e.name),1)],8,Ei))),128))])):Object(s["i"])("",!0),0==r.filteredItems.length?(Object(s["D"])(),Object(s["j"])("div",Ii," No items ")):Object(s["i"])("",!0)],512),[[s["Q"],r.isDropdownOpen]])])}var Pi={name:"LbSearchSelect",props:{items:{type:Array,default:[]},placeholder:{type:String,default:""},loading:{type:Boolean,default:!1}},emits:["onSelection"],data(){return{selectedItem:null,value:""}},computed:{filteredItems(){return this.value.length>0?this.items.filter(e=>e.name.toLowerCase().includes(this.value.toLowerCase())):this.items},isDropdownOpen(){return null===this.selectedItem&&!this.loading},isControlVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"}},methods:{selectItem(e){this.selectedItem=this.filteredItems[e],this.$emit("onSelection",this.selectedItem.id),this.value=""},removeSelection(){this.selectedItem=null,this.$emit("onSelection",null),this.value=""}}};n("b199");const Si=k()(Pi,[["render",xi]]);var Ti=Si,Ni={name:"LoginPage",components:{LbInput:Zt,LbPopupBox:li,LbSearchSelect:Ti},data(){return{username:{value:"",errorMsg:""},password:{value:"",errorMsg:""},loading:!1,isErrorOpen:!1,resultMessage:"",resultType:"negative"}},computed:{isButtonDisabled(){return 0===this.username.value.length||0===this.password.value.length},isFormVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"}},methods:{...Object(b["d"])(["setUser"]),...Object(b["b"])("universe",["fetchUserUniverses"]),setUsername(e){this.username.value=e,this.username.errorMsg=""},setPassword(e){this.password.value=e,this.password.errorMsg=""},formValidation(){return""==this.password.errorMsg&&""==this.username.errorMsg&&this.password.value.length>0&&this.username.value.length>0},closeError(){this.isErrorOpen=!1,this.resultMessage=""},async logIn(){this.loading=!0;let e=Date.now(),t=null;if(this.formValidation()){try{t=await v(this.username.value,this.password.value)}catch(err){this.loading=!1,this.isErrorOpen=!0,this.resultMessage=err.message}if(t){let n=Date.now()-e;n<500?setTimeout(async()=>{this.loading=!1,this.setUser(t),await this.fetchUserUniverses(t.id),this.$router.push("/user")},500-n):(this.loading=!1,this.setUser(t),await this.fetchUserUniverses(t.id),this.$router.push("/user"))}}this.loading=!1}}};n("c9fa");const Ui=k()(Ni,[["render",yi]]);var zi=Ui;const $i={class:"user-page"},Ji={class:"user-page__account-section"},Mi=Object(s["k"])("div",{class:"account-section__header"},[Object(s["k"])("h2",{class:"account-section__header-text"},"Your Account"),Object(s["k"])("div",{class:"util__horizontal-line--white"})],-1),qi={class:"account-section__account-data"},Bi={class:"account-section__data-row"},Ri=Object(s["k"])("span",{class:"account-section__data-name"},"Email address: ",-1),Gi={class:"account-section__data-value"},Vi={class:"account-section__data-row"},Fi=Object(s["k"])("span",{class:"account-section__data-name"},"Username: ",-1),Ai={class:"account-section__data-value"},Hi={class:"account-section__data-row"},Yi={class:"user-page__universe-section"},Ki={class:"universe-section__header"},Wi=Object(s["k"])("div",{class:"universe-section__header-part"},null,-1),Qi=Object(s["k"])("div",{class:"universe-section__header-title-part"},[Object(s["k"])("h2",null,"Your Universes")],-1),Xi={class:"universe-section__header-part"},Zi={class:"universe-section__universes-table"},ea=Object(s["k"])("tr",{class:"universes-table__row universes-table__row--header"},[Object(s["k"])("th",{class:"universes-table__cell"},"Universe"),Object(s["k"])("th",{class:"universes-table__cell"},"Elements"),Object(s["k"])("th",{class:"universes-table__cell"})],-1),ta={class:"universes-table__cell"},na={class:"universes-table__cell"},sa={class:"universes-table__cell universes-table__cell--button"};function ia(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("router-link"),l=Object(s["J"])("create-universe-popup");return Object(s["D"])(),Object(s["j"])("div",$i,[Object(s["k"])("section",Ji,[Mi,Object(s["k"])("div",qi,[Object(s["k"])("div",Bi,[Ri,Object(s["k"])("span",Gi,Object(s["M"])(e.email),1)]),Object(s["k"])("div",Vi,[Fi,Object(s["k"])("span",Ai,Object(s["M"])(e.username),1),Object(s["n"])(o,{icon:"lb-edit",size:1.2},null,8,["size"])]),Object(s["k"])("div",Hi,[Object(s["n"])(o,{icon:"lb-edit",size:1.3},{default:Object(s["T"])(()=>[Object(s["m"])("Change password")]),_:1},8,["size"])])])]),Object(s["k"])("section",Yi,[Object(s["k"])("div",Ki,[Wi,Qi,Object(s["k"])("div",Xi,[Object(s["n"])(o,{class:"universe-section__create-button",onClick:r.openUniverseCreator,icon:"lb-plus",size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Create New Universe")]),_:1},8,["onClick","size"])])]),Object(s["k"])("table",Zi,[ea,(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.universes,e=>(Object(s["D"])(),Object(s["j"])("tr",{class:"universes-table__row",key:e.id},[Object(s["k"])("td",ta,[Object(s["n"])(c,{class:"universes-table__link",to:"/universe/"+e.id},{default:Object(s["T"])(()=>[Object(s["m"])(Object(s["M"])(e.name),1)]),_:2},1032,["to"])]),Object(s["k"])("td",na,[Object(s["k"])("span",null,Object(s["M"])(e.elementCount),1)]),Object(s["k"])("td",sa,[Object(s["n"])(o,{variant:"negative",icon:"lb-trash",onClick:t=>r.deleteUniverse(e.id,e.name)},null,8,["onClick"])])]))),128))])]),a.isCreateUniverseOpen?(Object(s["D"])(),Object(s["h"])(l,{key:0,isOpen:a.isCreateUniverseOpen,onClose:r.closeUniverseCreator,onOnResult:r.onCreateUniverse},null,8,["isOpen","onClose","onOnResult"])):Object(s["i"])("",!0)])}const aa={class:"create-universe-popup__form"},ra={class:"create-universe-popup__buttons"};function oa(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(u,{isOpen:n.isOpen,title:"Create New Universe",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",{class:"create-universe-popup",style:Object(s["x"])(r.setVisibilityOnLoading)},[Object(s["k"])("div",aa,[Object(s["n"])(o,{name:"Title of universe",maxLength:45,value:a.title.value,"onUpdate:value":r.setTitle,error:a.title.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e)},null,8,["value"])]),Object(s["k"])("div",ra,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.create,disabled:!r.isFormValid},{default:Object(s["T"])(()=>[Object(s["m"])("Create")]),_:1},8,["size","onClick","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0,size:"50px"})):Object(s["i"])("",!0)]),_:1},8,["isOpen","onClose"])}var ca={components:{LbInput:Zt},name:"CreateUniversePopup",props:{isOpen:{type:Boolean,default:!1}},emits:["close","onResult"],data(){return{title:{value:"",errorMsg:""},description:"",loading:!1}},computed:{...Object(b["c"])(["userID"]),setVisibilityOnLoading(){return this.loading?"visibility: hidden;":"visibility: visible;"},isFormValid(){return""==this.title.errorMsg&&this.title.value.length>0}},methods:{...Object(b["d"])("notifications",["notify"]),setTitle(e){this.title.errorMsg="",this.title.value=e,e.length<1&&(this.title.errorMsg="Title cannot be empty!")},async create(){this.loading=!0;try{const e=await M({name:this.title.value,description:this.description,userID:this.userID});this.$emit("onResult",e),this.close()}catch(error){this.notify({type:"negative",message:error.message}),this.$emit("onResult",!1)}finally{this.loading=!1}},close(){this.title={value:"",errorMsg:""},this.description="",this.$emit("close")}}};n("3ac6");const la=k()(ca,[["render",oa]]);var ua=la,da={name:"UserPage",components:{CreateUniversePopup:ua},data(){return{isCreateUniverseOpen:!1,universes:[]}},computed:{...Object(b["c"])(["username","email","userID"]),...Object(b["c"])("universe",["userUniverses"])},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("universe",["setUniverse","setUserUniverses","pushUserUniverse","removerUserUniverse"]),openUniverseCreator(){this.isCreateUniverseOpen=!0},closeUniverseCreator(){this.isCreateUniverseOpen=!1},async fetchUserUniverseList(){try{this.universes=await J(this.userID)}catch(error){console.error(error.message)}},async deleteUniverse(e,t){try{if(confirm(`Are you sure that you want delete ${t} universe?`)){const t=await q(e);t&&(this.universes=this.universes.filter(t=>t.id!==e),this.removerUserUniverse(e))}}catch(err){this.notify({type:"negative",message:"Error: "+err.message})}},onCreateUniverse(e){if(e){this.notify({type:"positive",message:"Universe Created"});let t=e;this.pushUserUniverse({id:t.id,name:t.name}),t.elementCount=0,this.universes.push(t),this.isCreateUniverseOpen=!1}}},async mounted(){await this.fetchUserUniverseList()}};n("285e");const pa=k()(da,[["render",ia]]);var ba=pa;const ha={class:"universe-page"};function ma(e,t,n,i,a,r){const o=Object(s["J"])("router-view"),c=Object(s["J"])("lb-spinner"),l=Object(s["J"])("categories-popup"),u=Object(s["J"])("universe-element-popup"),d=Object(s["J"])("tags-popup");return Object(s["D"])(),Object(s["j"])("div",ha,[a.loading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(o,{key:0,universeDescriptionProp:a.universeDescription},null,8,["universeDescriptionProp"])),a.loading?(Object(s["D"])(),Object(s["h"])(c,{key:1,size:"40px"})):Object(s["i"])("",!0),e.isCategoriesPopupOpen?(Object(s["D"])(),Object(s["h"])(l,{key:2})):Object(s["i"])("",!0),e.isUniverseElementPopupOpen?(Object(s["D"])(),Object(s["h"])(u,{key:3})):Object(s["i"])("",!0),e.isTagsPopupOpen?(Object(s["D"])(),Object(s["h"])(d,{key:4})):Object(s["i"])("",!0)])}const ga={class:"categories-popup"},Oa={class:"categories-popup__form"},va={class:"categories-popup__categories-table"},ja={class:"categories-table"},ya=Object(s["k"])("thead",null,[Object(s["k"])("tr",{class:"categories-table__row categories-table__row--header"},[Object(s["k"])("th",{class:"categories-table__cell categories-table__cell--header"},"Category"),Object(s["k"])("th",{class:"categories-table__cell categories-table__cell--header"},"Elements"),Object(s["k"])("th",{class:"categories-table__cell categories-table__cell--header"})])],-1),fa={class:"categories-table__cell"},_a=["onClick"],ka={class:"categories-table__cell"},wa={class:"categories-table__cell"},Da={key:0,class:"categories-table__buttons"};function Ca(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(l,{isOpen:e.isCategoriesPopupOpen,title:"Categories in current universe",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",ga,[Object(s["k"])("div",Oa,[Object(s["n"])(o,{name:"Name",value:a.categoryName,"onUpdate:value":r.setName,error:a.categoryNameError,maxLength:45},null,8,["value","onUpdate:value","error"]),Object(s["k"])("div",{class:Object(s["w"])(["categories-popup__buttons",r.setButtonsClass])},[null===a.selectedCategory?(Object(s["D"])(),Object(s["h"])(c,{key:0,size:1.2,variant:"positive",icon:"lb-plus",onClick:r.addCategory,disabled:r.disableFormButtons,loading:a.isAddCategoryLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Add new category")]),_:1},8,["size","onClick","disabled","loading"])):Object(s["i"])("",!0),null!==a.selectedCategory?(Object(s["D"])(),Object(s["h"])(c,{key:1,size:1.2,variant:"outline",onClick:r.cancelEdit},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"])):Object(s["i"])("",!0),null!==a.selectedCategory?(Object(s["D"])(),Object(s["h"])(c,{key:2,size:1.2,icon:"lb-edit",onClick:r.renameCategory,disabled:r.disableFormButtons},{default:Object(s["T"])(()=>[Object(s["m"])("Rename")]),_:1},8,["size","onClick","disabled"])):Object(s["i"])("",!0)],2)]),Object(s["k"])("div",va,[Object(s["k"])("table",ja,[ya,Object(s["k"])("tbody",null,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.categoriesList,e=>(Object(s["D"])(),Object(s["j"])("tr",{class:Object(s["w"])(["categories-table__row",r.isRowEdited(e.id)]),key:e.id},[Object(s["k"])("td",fa,[Object(s["k"])("span",{class:"categories-table__link",onClick:t=>r.navigateToCategory(e.id)},Object(s["M"])(e.name),9,_a)]),Object(s["k"])("td",ka,Object(s["M"])(e.elementCount),1),Object(s["k"])("td",wa,[r.isCategoryMutable(e.id)?(Object(s["D"])(),Object(s["j"])("div",Da,[Object(s["n"])(c,{size:1.2,icon:"lb-edit",onClick:t=>r.editCategory(e.id)},null,8,["size","onClick"]),Object(s["n"])(c,{size:1.2,icon:"lb-trash",variant:"negative",onClick:t=>r.deleteCategory(e.id),disabled:this.selectedCategory==e.id},null,8,["size","onClick","disabled"])])):Object(s["i"])("",!0)])],2))),128))])])])])]),_:1},8,["isOpen","onClose"])}var Ea={name:"CategoriesPopup",components:{LbInput:Zt},props:{},emits:["onResult"],data(){return{categoryName:"",categoryNameError:"",loading:!1,selectedCategory:null,categoriesList:[],isAddCategoryLoading:!1}},computed:{...Object(b["c"])("popups",["isCategoriesPopupOpen"]),...Object(b["c"])("universe",["universeID"]),setButtonsClass(){return null!==this.selectedCategory?"categories-popup__buttons--rename-mode":""},disableFormButtons(){return this.categoryName.length<1||this.categoryNameError.length>0},isCategoryNameValid(){return this.categoryName.length>0&&!this.categoriesList.find(e=>e.name===this.categoryName)}},methods:{...Object(b["d"])("popups",["closeCategoriesPopup"]),...Object(b["d"])("notifications",["notify"]),close(){this.closeCategoriesPopup()},setName(e){this.categoryNameError="",this.categoryName=e},isCategoryMutable(e){return!["Locations","Characters","Events"].includes(e)},isRowEdited(e){return this.selectedCategory==e?"categories-table__row--edited":""},navigateToCategory(e){const t={name:"CategoryElements",params:{categoryID:e}};this.$router.push(t),this.close()},editCategory(e){this.selectedCategory==e?(this.selectedCategory=null,this.categoryName=""):(this.selectedCategory=e,this.categoryName=this.categoriesList.find(t=>t.id==e).name)},cancelEdit(){this.selectedCategory=null,this.categoryName=""},async addCategory(){if(this.isCategoryNameValid){this.isAddCategoryLoading=!0;try{const e=await Jn({name:this.categoryName,universeID:this.universeID});this.categoriesList.push({id:e.id,name:this.categoryName,elementCount:0}),this.categoryName=""}catch(error){this.notify({type:"negative",message:error.message})}finally{this.isAddCategoryLoading=!1}}else this.categoryNameError="Category with that name already exists"},async renameCategory(){if(this.isCategoryNameValid)try{await Mn(this.selectedCategory,this.categoryName),this.categoriesList.find(e=>e.id==this.selectedCategory).name=this.categoryName,this.selectedCategory=null,this.categoryName=""}catch(error){this.notify({type:"negative",message:error.message})}else this.categoryNameError="Category with that name already exists"},async deleteCategory(e){if(confirm("Do you really want to delete this category? You will lose all elements belonging in this category. It cannot be undone!"))try{await qn(e),this.categoriesList=this.categoriesList.filter(t=>t.id!==e),this.$route.params.categoryID&&this.$route.params.categoryID==e&&(this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}}),this.close())}catch(error){this.notify({type:"negative",message:error.message})}}},async mounted(){try{this.categoriesList=await $n(this.universeID)}catch(error){this.notify({type:"negative",message:error.message})}}};n("5c88");const La=k()(Ea,[["render",Ca]]);var Ia=La;const xa={class:"universe-element-popup"},Pa=Object(s["k"])("h2",{class:"universe-element-popup__field-title"},"Type of element",-1),Sa={key:0,class:"universe-element-popup__specific-row universe-element-popup__specific-row--events"},Ta={key:1,class:"universe-element-popup__specific-row"},Na=Object(s["k"])("h2",{class:"universe-element-popup__field-title"},"Parent Location",-1),Ua={class:"universe-element-popup__buttons"};function za(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-select"),l=Object(s["J"])("lb-search-select"),u=Object(s["J"])("lb-button"),d=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(d,{isOpen:e.isUniverseElementPopupOpen,title:"Create new element in Universe",onClose:e.closeUniverseElementPopup},{default:Object(s["T"])(()=>[Object(s["k"])("div",xa,[Object(s["n"])(o,{name:"Title",value:a.name,"onUpdate:value":t[0]||(t[0]=e=>a.name=e),maxLength:60},null,8,["value"]),Object(s["k"])("div",null,[Pa,Object(s["n"])(c,{items:a.categories,width:"100%",placeholder:"Select type of new element",onHandleSelection:r.selectCategory},null,8,["items","onHandleSelection"])]),"Events"==a.selectedCategory?(Object(s["D"])(),Object(s["j"])("div",Sa,[Object(s["n"])(o,{name:"Year",type:"number",value:a.eventDate.year,"onUpdate:value":t[1]||(t[1]=e=>a.eventDate.year=e)},null,8,["value"]),Object(s["n"])(o,{name:"Month",type:"number","onChange:value":r.setEventMonth,value:a.eventDate.month,"onUpdate:value":t[2]||(t[2]=e=>a.eventDate.month=e)},null,8,["onChange:value","value"]),Object(s["n"])(o,{name:"Day",type:"number","onChange:value":r.setEventDay,value:a.eventDate.day,"onUpdate:value":t[3]||(t[3]=e=>a.eventDate.day=e)},null,8,["onChange:value","value"])])):Object(s["i"])("",!0),"Locations"==a.selectedCategory?(Object(s["D"])(),Object(s["j"])("div",Ta,[Na,Object(s["n"])(l,{placeholder:"Select parent locations...",items:a.locations,loading:a.areLocationsLoading,onOnSelection:r.selectLocation},null,8,["items","loading","onOnSelection"])])):Object(s["i"])("",!0),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[4]||(t[4]=e=>a.description=e),maxLength:250},null,8,["value"]),Object(s["k"])("div",Ua,[Object(s["n"])(u,{variant:"outline",size:1.4,onClick:e.closeUniverseElementPopup},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(u,{variant:"positive",size:1.4,onClick:r.createElement,disabled:r.isCreateButtonDisabled,loading:a.createLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Create Element")]),_:1},8,["size","onClick","disabled","loading"])])])]),_:1},8,["isOpen","onClose"])}var $a={name:"UniverseElementPopup",components:{LbPopupBox:li,LbInput:Zt,LbSelect:dn,LbSearchSelect:Ti},emits:["onResult"],data(){return{name:"",description:"",selectedCategory:null,categories:[],createLoading:!1,eventDate:{year:0,month:1,day:1},locations:[],parentLocation:null,areLocationsLoading:!1,fetchLocationsFlag:!1}},computed:{...Object(b["c"])("popups",["isUniverseElementPopupOpen"]),...Object(b["c"])("universe",["universeID"]),isCreateButtonDisabled(){return null==this.selectedCategory||this.name.length<1}},methods:{...Object(b["d"])("popups",["closeUniverseElementPopup"]),...Object(b["d"])("notifications",["notify"]),resetForm(){this.name="",this.description="",this.selectedCategory=null,this.eventDate={year:0,month:1,day:1},this.parentLocation=null},async selectCategory(e){this.selectedCategory=e.length?e[0].id:null,"Locations"==this.selectedCategory?(this.parentLocation=null,this.fetchLocationsFlag||(await this.fetchLocations(),this.fetchLocationsFlag=!0)):"Events"==this.selectedCategory&&(this.eventDate={year:0,month:1,day:1})},async createElement(){this.createLoading=!0;try{let e=null;e="Events"==this.selectedCategory?await cs(this.name,this.description,this.eventDate,this.universeID):"Locations"==this.selectedCategory?await ns(this.name,this.description,this.universeID,this.parentLocation):"Characters"==this.selectedCategory?await Fn(this.name,this.description,this.universeID):await Wn(this.name,this.description,this.selectedCategory),e&&(this.notify({type:"positive",message:"Successfully created "+e.name}),this.$emit("onResult",{result:e,type:this.selectedCategory}),this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.selectedCategory,elementID:e.id}}),this.closeUniverseElementPopup())}catch(error){this.notify({type:"negative",message:error.message})}finally{this.createLoading=!1}},setEventMonth(e){this.eventDate.month=e>12?12:e<1?1:e},setEventDay(e){this.eventDate.day=e>31?31:e<1?1:e},async fetchLocations(){this.areLocationsLoading=!0;try{this.locations=await ss(this.universeID)}catch(error){this.notify({type:"negative",message:error.message})}finally{this.areLocationsLoading=!1}},selectLocation(e){this.parentLocation=e}},async mounted(){try{const e=[{id:"Characters",name:"Characters"},{id:"Locations",name:"Locations"},{id:"Events",name:"Events"}],t=await zn(this.universeID);this.categories.push(...e,...t)}catch(error){this.notify({type:"negative",message:error.message})}}};n("c975");const Ja=k()($a,[["render",za]]);var Ma=Ja;const qa={class:"tags-popup"},Ba={class:"tags-popup__row"},Ra={key:0,class:"tags-popup__edit-form"},Ga={class:"tags-popup__form-buttons"},Va={key:0,class:"tags-popup__row"},Fa={class:"tags-popup__tag-table"},Aa={class:"tag-table"},Ha=Object(s["k"])("thead",null,[Object(s["k"])("tr",{class:"tag-table__row tag-table__row--header"},[Object(s["k"])("th",{class:"tag-table__cell tag-table__cell--header"},"Tag Name"),Object(s["k"])("th",{class:"tag-table__cell tag-table__cell--header"},"Tagged Elements"),Object(s["k"])("th",{class:"tag-table__cell tag-table__cell--header"})])],-1),Ya={class:"tag-table__cell"},Ka={class:"tag-table__tag-name"},Wa={class:"tag-table__cell"},Qa={class:"tag-table__cell"},Xa={class:"tag-table__buttons"},Za={key:1,class:"tags-popup__no-content"},er=Object(s["k"])("h3",{class:"tags-popup__no-content-header"},"No results",-1),tr=Object(s["k"])("span",null,"If you want to see searched tags here, you should add them to universe elements",-1),nr=[er,tr],sr={key:2,class:"tags-popup__row"};function ir(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-search-bar"),u=Object(s["J"])("lb-page-nav"),d=Object(s["J"])("lb-spinner"),p=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(p,{isOpen:e.isTagsPopupOpen,title:"Tags in current universe",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",qa,[Object(s["k"])("div",{class:"tags-popup__content",style:Object(s["x"])(r.tagsLoadingVisibility)},[Object(s["k"])("div",Ba,[a.selectedTag?(Object(s["D"])(),Object(s["j"])("div",Ra,[Object(s["n"])(o,{name:"Tag Name",value:a.tagName,"onUpdate:value":r.setTagName,error:a.tagNameError,maxLength:60},null,8,["value","onUpdate:value","error"]),Object(s["k"])("div",Ga,[Object(s["n"])(c,{size:1.2,variant:"outline",onClick:r.cancelEdit},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{size:1.2,icon:"lb-edit",onClick:r.renameTag,loading:a.renameLoading,disabled:r.disableRenameButton},{default:Object(s["T"])(()=>[Object(s["m"])("Rename Tag")]),_:1},8,["size","onClick","loading","disabled"])])])):Object(s["i"])("",!0),a.selectedTag?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(l,{key:1,placeholder:"Search tag by name...",onSearch:r.search,text:a.searchText},null,8,["onSearch","text"]))]),0!==a.tagList.length?(Object(s["D"])(),Object(s["j"])("div",Va,[Object(s["k"])("div",Fa,[Object(s["k"])("table",Aa,[Ha,Object(s["k"])("tbody",null,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.tagList,e=>(Object(s["D"])(),Object(s["j"])("tr",{class:Object(s["w"])(["tag-table__row",r.isRowEdited(e.id)]),key:e.id},[Object(s["k"])("td",Ya,[Object(s["k"])("span",Ka,Object(s["M"])(e.name),1)]),Object(s["k"])("td",Wa,Object(s["M"])(e.elementCount),1),Object(s["k"])("td",Qa,[Object(s["k"])("div",Xa,[Object(s["n"])(c,{size:1.2,icon:"lb-edit",onClick:t=>r.editTag(e.id)},null,8,["size","onClick"]),Object(s["n"])(c,{size:1.2,icon:"lb-trash",variant:"negative",onClick:t=>r.removeTag(e.id),disabled:a.selectedTag==e.id},null,8,["size","onClick","disabled"])])])],2))),128))])])])])):Object(s["i"])("",!0),0==a.tagList.length?(Object(s["D"])(),Object(s["j"])("div",Za,nr)):Object(s["i"])("",!0),null===a.selectedTag?(Object(s["D"])(),Object(s["j"])("div",sr,[Object(s["n"])(u,{currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage,class:"tags-popup__page-nav"},null,8,["currentPage","totalPages","onGo"])])):Object(s["i"])("",!0)],4),a.tagsLoading?(Object(s["D"])(),Object(s["h"])(d,{key:0})):Object(s["i"])("",!0)])]),_:1},8,["isOpen","onClose"])}async function ar(e,t,n){return await O.post("/tags/content",{name:e,contentID:t,universeID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function rr(e){return await O.delete("/tags/"+e).then(e=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function or(e,t){return await O.delete(`/tags/${e}/content/${t}`).then(e=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function cr(e,t,n,s){const i=encodeURIComponent(t);return await O.get(`/tags/search/list/${e}/?q=${i}&limit=${n}&offset=${s}`).then(e=>{const t={elements:e.data.rows,totalPages:Math.ceil(e.data.count/n)};return t}).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function lr(e,t){return await O.patch("/tags/"+e,{name:t}).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var ur={name:"TagsPopup",components:{LbSearchBar:Cn,LbInput:Zt,LbPageNav:Un},data(){return{tagList:[],tagsLoading:!1,renameLoading:!1,searchText:"",tagName:"",tagNameError:"",selectedTag:null,currentPage:1,totalPages:2}},computed:{...Object(b["c"])("popups",["isTagsPopupOpen"]),...Object(b["c"])("universe",["universeID"]),tagsLoadingVisibility(){return this.tagsLoading?"visibility: hidden;":"visibility: visible"},disableRenameButton(){return this.tagName.length<1||this.tagNameError.length>0}},methods:{...Object(b["d"])("popups",["closeTagsPopup"]),...Object(b["d"])("notifications",["notify"]),close(){this.closeTagsPopup()},isRowEdited(e){return this.selectedTag==e?"tag-table__row--edited":""},editTag(e){this.selectedTag==e?(this.selectedTag=null,this.tagName=""):(this.selectedTag=e,this.tagName=this.tagList.find(t=>t.id==e).name)},async fetchTagList(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e,this.searchText=e;const s=25;this.tagsLoading=!0;try{const t=0!==n?n*s-s:0,i=await cr(this.universeID,e,s,t);this.tagList=i.elements,this.totalPages=i.totalPages}catch(error){this.notify({type:"negative",message:"Error: "+err.message})}finally{this.tagsLoading=!1}},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchTagList(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},setTagName(e){this.tagNameError="",this.tagName=e},cancelEdit(){this.tagName="",this.tagNameError="",this.selectedTag=null},async renameTag(){try{this.renameLoading=!0,await lr(this.selectedTag,this.tagName),this.tagList.find(e=>e.id==this.selectedTag).name=this.tagName,this.selectedTag=null,this.tagName=""}catch(e){this.tagNameError=error.message}finally{this.renameLoading=!1}},async removeTag(e){try{await rr(e),this.tagList=this.tagList.filter(t=>t.id!==e),await this.fetchTagList(this.searchText,this.currentPage)}catch(t){this.notify({type:"negative",message:error.message})}}},async mounted(){await this.fetchTagList("",1)}};n("1ba1");const dr=k()(ur,[["render",ir]]);var pr=dr,br={name:"UniversePage",components:{CategoriesPopup:Ia,UniverseElementPopup:Ma,TagsPopup:pr},data(){return{universeDescription:"",loading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),...Object(b["c"])("popups",["isCategoriesPopupOpen","isUniverseElementPopupOpen","isTagsPopupOpen"])},methods:{...Object(b["d"])("universe",["setUniverse","setUniverseName"]),...Object(b["d"])("notifications",["notify"])},async mounted(){const e=this.$route.params.universeID;this.loading=!0;try{const t=await B(e);this.setUniverse({id:t.id,name:t.name}),this.universeDescription=t.description}catch(err){this.notify({type:"negative",message:"Error: "+err.message}),this.$route.replace({name:"User"})}finally{this.loading=!1}}};n("6de2");const hr=k()(br,[["render",ma]]);var mr=hr;const gr={class:"universe-main-page"},Or={class:"universe-main-page__header"},vr=Object(s["k"])("label",{class:"universe-main-page__header-label"},"Description",-1),jr={class:"universe-main-page__content-swapper"},yr={key:0,class:"universe-main-page__dynamic-content"};function fr(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-content-swapper");return Object(s["D"])(),Object(s["j"])("div",gr,[Object(s["k"])("div",Or,[Object(s["n"])(o,{value:e.universeName,maxLength:45,customClass:"universe-main-page__title",onOnSave:r.changeUniverseTitle},null,8,["value","onOnSave"]),vr,Object(s["n"])(o,{value:a.universeDescription,maxLength:1e3,type:"textarea",customClass:"universe-main-page__description",onOnSave:r.changeDescription,noContent:"No description"},null,8,["value","onOnSave"])]),Object(s["k"])("div",jr,[Object(s["n"])(c,{options:a.contentOptions,activeOption:a.activeOption,onOnSelect:r.changeContent},null,8,["options","activeOption","onOnSelect"])]),e.universeID?(Object(s["D"])(),Object(s["j"])("div",yr,[(Object(s["D"])(),Object(s["h"])(Object(s["K"])(a.activeOption)))])):Object(s["i"])("",!0)])}const _r={class:"lb-content-swapper"},kr=["disabled","onClick"];function wr(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",_r,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.options,e=>(Object(s["D"])(),Object(s["j"])("button",{class:Object(s["w"])(["lb-content-swapper__option",r.setActiveClass(e.key)]),key:e.key,disabled:e.disabled||e.key==n.activeOption,onClick:t=>r.selectOption(e.key)},Object(s["M"])(e.name),11,kr))),128))])}var Dr={name:"LbContentSwapper",props:{options:{type:Array,required:!0},activeOption:{type:String,default:null}},emits:["onSelect"],methods:{selectOption(e){this.$emit("onSelect",e)},setActiveClass(e){return this.activeOption==e?"lb-content-swapper__option--active":""}}};n("ffae");const Cr=k()(Dr,[["render",wr]]);var Er=Cr;const Lr={class:"universe-elements"},Ir={class:"universe-elements__loading"},xr={key:0,class:"universe-elements__no-content"};function Pr(e,t,n,i,a,r){const o=Object(s["J"])("lb-spinner"),c=Object(s["J"])("lb-universe-element-list");return Object(s["D"])(),Object(s["j"])("div",Lr,[Object(s["k"])("div",Ir,[a.loading?(Object(s["D"])(),Object(s["h"])(o,{key:0})):Object(s["i"])("",!0)]),(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.elementLists,e=>(Object(s["D"])(),Object(s["j"])("div",{class:"universe-elements__list",key:e.id},[Object(s["n"])(c,{categoryID:e.id,title:e.name,elements:e.elements,elementCount:e.elementCount,footerLink:e.elementCount>3},null,8,["categoryID","title","elements","elementCount","footerLink"])]))),128)),0==a.elementLists.length?(Object(s["D"])(),Object(s["j"])("div",xr," No elements in this universe ")):Object(s["i"])("",!0)])}const Sr={class:"lb-universe-element-list"},Tr={class:"lb-universe-element-list__header"},Nr=Object(s["k"])("span",{class:"lb-universe-element-list__vertical-line"},null,-1),Ur={class:"lb-universe-element-list__count"},zr=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),$r={class:"lb-universe-element-list__element-header"},Jr=["onClick"],Mr={class:"lb-universe-element-list__element-date"},qr={key:0,class:"lb-universe-element-list__element-button"},Br=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Rr={key:0,class:"lb-universe-element-list__footer"};function Gr(e,t,n,i,a,r){const o=Object(s["J"])("router-link"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",Sr,[Object(s["k"])("div",{class:"lb-universe-element-list__body",style:Object(s["x"])(r.isContentVisible)},[Object(s["k"])("div",Tr,[Object(s["n"])(o,{to:r.categoryLink,class:"lb-universe-element-list__title"},{default:Object(s["T"])(()=>[Object(s["m"])(Object(s["M"])(n.title),1)]),_:1},8,["to"]),Nr,Object(s["k"])("span",Ur,Object(s["M"])(r.elementCountText),1)]),zr,(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.elements,e=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-universe-element-list__element",key:e.id},[Object(s["k"])("div",$r,[Object(s["k"])("h4",{onClick:t=>r.navigateToElement(e.id),class:"lb-universe-element-list__element-name"},Object(s["M"])(e.name),9,Jr),Object(s["k"])("span",Mr,Object(s["M"])(r.formatDate(e.last_modified)),1),n.interactive?(Object(s["D"])(),Object(s["j"])("div",qr,[Object(s["n"])(c,{variant:"negative",icon:"lb-trash",size:1,onClick:t=>r.deleteElement(e.id,e.catID)},null,8,["onClick"])])):Object(s["i"])("",!0)]),Object(s["k"])("p",{class:Object(s["w"])(["lb-universe-element-list__description",e.description.length?"":"lb-universe-element-list__description--empty"])},Object(s["M"])(e.description.length?e.description:"No description"),3),Br]))),128)),n.footerLink?(Object(s["D"])(),Object(s["j"])("div",Rr,[Object(s["n"])(o,{to:r.categoryLink,class:"lb-universe-element-list__link"},{default:Object(s["T"])(()=>[Object(s["m"])("see more elements...")]),_:1},8,["to"])])):Object(s["i"])("",!0)],4),n.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0})):Object(s["i"])("",!0)])}var Vr=n("b166"),Fr={name:"LbUniverseElementList",emits:["onDelete"],props:{categoryID:{type:String,required:!0},title:{type:String,required:!0},elements:{type:Array,default:[]},footerLink:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},elementCount:{type:Number},interactive:{type:Boolean}},computed:{...Object(b["c"])("universe",["universeID"]),elementCountText(){return 1==this.elementCount?this.elementCount+" element":this.elementCount+" elements"},isContentVisible(){return this.loading?"visibility: hidden;":"visibility: visible;"},categoryLink(){return{name:"CategoryElements",params:{categoryID:this.categoryID}}}},methods:{formatDate(e){const t=new Date(e),n=Object(Vr["a"])(t,"dd.MM.yyyy hh:mm");return"Last modified: "+n},deleteElement(e){this.$emit("onDelete",{id:e,categoryID:this.categoryID})},navigateToElement(e){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.categoryID,elementID:e}})}}};n("6677");const Ar=k()(Fr,[["render",Gr]]);var Hr=Ar;async function Yr(e){return await O.get("/search/shortLists/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}function Kr(e){return e.map(e=>({id:e.id,name:e.name,lastModified:e.last_modified,categoryID:e.Category_id,categoryName:e.categoryName}))}async function Wr(e,t,n,s,i,a){let r=[];if(n&&n.length>0){const e=n.map(e=>{const t=encodeURIComponent(e);return"&categories="+t});e.forEach(e=>r.push(e))}if(s&&s.length>0){const e=s.map(e=>{const t=encodeURIComponent(e);return"&tags="+t});e.forEach(e=>r.push(e))}let o="";r.length>0&&r.forEach(e=>{o=`${o}${e}`});const c=encodeURIComponent(t||"");return await O.get(`/search/${e}/?q=${c}${o}&limit=${i}&offset=${a}`).then(e=>{const t={elements:Kr(e.data.rows),totalPages:Math.ceil(e.data.count/i)};return t}).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var Qr={components:{LbUniverseElementList:Hr},name:"UniverseElements",data(){return{elementLists:[],loading:!1}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{...Object(b["d"])("notifications",["notify"]),async fetchElementLists(){this.loading=!0;try{this.elementLists=await Yr(this.universeID),this.elementLists=this.elementLists.filter(e=>e.elementCount).sort((e,t)=>t.elements[0].last_modified>e.elements[0].last_modified?1:t.elements[0].last_modified<e.elements[0].last_modified?-1:0)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}}},async mounted(){await this.fetchElementLists()}};n("8c2e");const Xr=k()(Qr,[["render",Pr]]);var Zr=Xr;const eo={class:"universe-stories"},to={class:"universe-stories__header"},no=Object(s["k"])("div",{class:"universe-stories__header-part"},null,-1),so=Object(s["k"])("div",{class:"universe-stories__header-part universe-stories__header-part--title"}," Your Stories ",-1),io={class:"universe-stories__header-part"},ao={class:"universe-stories__list"},ro=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),oo={key:0,class:"universe-stories__list--no-content"};function co(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-story-element"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("create-story-popup");return Object(s["D"])(),Object(s["j"])("div",eo,[Object(s["k"])("div",to,[no,so,Object(s["k"])("div",io,[Object(s["n"])(o,{icon:"lb-plus",size:1.2,onClick:r.openPopup},{default:Object(s["T"])(()=>[Object(s["m"])("Create new Story")]),_:1},8,["size","onClick"])])]),Object(s["k"])("div",ao,[ro,Object(s["k"])("div",{class:"universe-stories__list-elements",style:Object(s["x"])(r.storiesListVisibility)},[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.storiesList,(e,t)=>(Object(s["D"])(),Object(s["h"])(c,{key:t,id:e.id,title:e.title,initDescription:e.description,chapterCount:e.chapterCount,onOnDelete:r.removeStory},null,8,["id","title","initDescription","chapterCount","onOnDelete"]))),128)),0==a.storiesList.length?(Object(s["D"])(),Object(s["j"])("div",oo," No Stories in this Universe ")):Object(s["i"])("",!0)],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0})):Object(s["i"])("",!0)]),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(u,{key:0,isOpen:a.isPopupOpen,onClose:r.closePopup,onOnResult:r.addStory},null,8,["isOpen","onClose","onOnResult"])):Object(s["i"])("",!0)])}const lo={class:"create-story-popup__form"},uo={class:"create-story-popup__buttons"};function po(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(u,{isOpen:n.isOpen,title:"Create Story",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",{class:"create-story-popup",style:Object(s["x"])(r.setVisibilityOnLoading)},[Object(s["k"])("div",lo,[Object(s["n"])(o,{name:"Story Title",maxLength:80,value:a.title.value,"onUpdate:value":r.setTitle,error:a.title.errorMsg},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e),maxLength:500},null,8,["value"])]),Object(s["k"])("div",uo,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.create,disabled:!r.isFormValid},{default:Object(s["T"])(()=>[Object(s["m"])("Create")]),_:1},8,["size","onClick","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0,size:"50px"})):Object(s["i"])("",!0)]),_:1},8,["isOpen","onClose"])}async function bo(e){return await O.get("/stories/"+e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){if(404==e.response.status)throw new NotFoundException(""+e.response.data.message);throw new Error(""+e.response.data.message)}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ho({title:e,description:t,universeID:n}){return await O.post("/stories",{title:e,description:t,universeID:n}).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function mo(e){return await O.get(`/stories/universe/${e}/list`).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function go(e,t){return await O.patch("/stories/"+e,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Oo(e){return await O.delete("/stories/"+e).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var vo={name:"CreateStoryPopup",components:{LbInput:Zt},props:{isOpen:{type:Boolean,default:!1}},emits:["close","onResult"],data(){return{title:{value:"",errorMsg:""},description:"",loading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),setVisibilityOnLoading(){return this.loading?"visibility: hidden;":"visibility: visible;"},isFormValid(){return""==this.title.errorMsg&&this.title.value.length>0}},methods:{...Object(b["d"])("notifications",["notify"]),setTitle(e){this.title.errorMsg="",this.title.value=e,e.length<1&&(this.title.errorMsg="Title cannot be empty!")},async create(){this.loading=!0;try{const e=await ho({title:this.title.value,description:this.description,universeID:this.universeID});this.$emit("onResult",e),this.close()}catch(error){this.notify({type:"negative",message:error.message})}finally{this.loading=!1}},close(){this.title={value:"",errorMsg:""},this.description="",this.$emit("close")}}};n("6516");const jo=k()(vo,[["render",po]]);var yo=jo;const fo={class:"lb-story-element"},_o={class:"lb-story-element__header"},ko={class:"lb-story-element__header-part"},wo=Object(s["k"])("span",{class:"lb-story-element__vertical-line"},null,-1),Do={class:"lb-story-element__count"},Co={class:"lb-story-element__header-part"},Eo=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),Lo={class:"lb-story-element__content"},Io=Object(s["k"])("label",{class:"lb-story-element__description-label"}," Description ",-1);function xo(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-editable-text");return Object(s["D"])(),Object(s["j"])("div",fo,[Object(s["k"])("div",_o,[Object(s["k"])("div",ko,[Object(s["k"])("span",{class:"lb-story-element__link",onClick:t[0]||(t[0]=(...e)=>r.navigateToStory&&r.navigateToStory(...e))},Object(s["M"])(n.title),1),wo,Object(s["k"])("span",Do,Object(s["M"])(r.chapterCountText),1)]),Object(s["k"])("div",Co,[Object(s["n"])(o,{variant:"negative",icon:"lb-trash",size:1.05,onClick:r.deleteStory,class:"lb-story-element__delete-btn"},null,8,["size","onClick"])])]),Eo,Object(s["k"])("div",Lo,[Io,Object(s["n"])(c,{maxLength:500,noContent:"No Description",type:"textarea",width:"100%",value:a.description,onOnSave:r.changeDescription},null,8,["value","onOnSave"])])])}var Po={name:"LbStoryElement",components:{LbEditableText:qe},emits:["onDelete"],props:{id:{type:Number,required:!0},title:{type:String,required:!0},initDescription:{type:String,default:""},chapterCount:{type:Number,default:0}},data(){return{description:this.initDescription}},computed:{...Object(b["c"])("universe",["universeID"]),navigateToStory(){this.$router.push({name:"StoryChaptersPage",params:{universeID:this.universeID,storyID:this.id}})},chapterCountText(){return this.chapterCount+" Chapters"}},methods:{...Object(b["d"])("notifications",["notify"]),async changeDescription(e){try{await go(this.id,{description:e}),this.description=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},deleteStory(){this.$emit("onDelete",this.id)}}};n("c446");const So=k()(Po,[["render",xo]]);var To=So,No={name:"UniverseStories",components:{CreateStoryPopup:yo,LbStoryElement:To},data(){return{loading:!1,storiesList:[],isPopupOpen:!1}},computed:{...Object(b["c"])("universe",["universeID"]),storiesListVisibility(){return this.loading?"visibility: hidden;":""}},methods:{...Object(b["d"])("notifications",["notify"]),openPopup(){this.isPopupOpen=!0},closePopup(){this.isPopupOpen=!1},addStory(e){const t={...e};t.chapterCount=0,this.storiesList.push(t)},async removeStory(e){const t=this.storiesList.find(t=>t.id===e).chapterCount;try{t>0?confirm("Do you really want delete this story? This cannot be undone.")&&(await Oo(e),this.storiesList=this.storiesList.filter(t=>t.id!==e)):(await Oo(e),this.storiesList=this.storiesList.filter(t=>t.id!==e))}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async fetchListOfStories(){try{this.loading=!0,this.storiesList=await mo(this.universeID)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}}},async mounted(){await this.fetchListOfStories()}};n("f9d1");const Uo=k()(No,[["render",co]]);var zo=Uo,$o={name:"UnivereseMainPage",components:{LbContentSwapper:Er,LbEditableText:qe,UniverseElements:Zr,UniverseStories:zo},props:{universeDescriptionProp:{type:String}},data(){return{universeDescription:this.universeDescriptionProp,contentOptions:[{name:"Elements",key:"universe-elements"},{name:"Stories",key:"universe-stories"}],activeOption:"universe-elements"}},computed:{...Object(b["c"])("universe",["universeName","universeID"])},methods:{...Object(b["d"])("universe",["setUniverse","setUniverseName"]),...Object(b["d"])("notifications",["notify"]),changeContent(e){this.activeOption=e},async changeUniverseTitle(e){try{await R(this.universeID,{name:e}).then(()=>{this.setUniverseName(e)})}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async changeDescription(e){try{await R(this.universeID,{description:e}).then(()=>{this.universeDescription=e})}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}}}};n("ccbd");const Jo=k()($o,[["render",fr]]);var Mo=Jo;const qo={class:"lb-universe-nav"},Bo=Object(s["k"])("div",{class:"lb-universe-nav__universe-button-header"},[Object(s["k"])("span",null,"Universe"),Object(s["k"])("div",{class:"util__horizontal-line--white"})],-1),Ro={class:"lb-universe-nav__universe-link"},Go=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Create Element",-1),Vo=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Categories",-1),Fo=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Tags",-1),Ao=Object(s["k"])("span",{class:"lb-universe-nav__button-text"},"Search",-1);function Ho(e,t,n,i,a,r){const o=Object(s["J"])("router-link"),c=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",qo,[Object(s["n"])(o,{class:"lb-universe-nav__universe-button",to:"/universe/"+e.universeID},{default:Object(s["T"])(()=>[Bo,Object(s["k"])("span",Ro,Object(s["M"])(e.universeName),1)]),_:1},8,["to"]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[0]||(t[0]=(...t)=>e.openUniverseElementPopup&&e.openUniverseElementPopup(...t))},[Object(s["n"])(c,{icon:"lb-plus-square"}),Go]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[1]||(t[1]=(...t)=>e.openCategoriesPopup&&e.openCategoriesPopup(...t))},[Object(s["n"])(c,{icon:"lb-folder"}),Vo]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[2]||(t[2]=(...t)=>e.openTagsPopup&&e.openTagsPopup(...t))},[Object(s["n"])(c,{icon:"lb-tags"}),Fo]),Object(s["k"])("button",{class:"lb-universe-nav__button",onClick:t[3]||(t[3]=(...e)=>r.navigateToSearch&&r.navigateToSearch(...e))},[Object(s["n"])(c,{icon:"lb-search"}),Ao])])}var Yo={name:"LbUniverseNav",computed:{...Object(b["c"])("universe",["universeName","universeID"])},methods:{...Object(b["d"])("popups",["openCategoriesPopup","openUniverseElementPopup","openTagsPopup"]),navigateToSearch(){this.$router.push({name:"SearchPage",params:{universeID:this.universeID}})}}};n("5376");const Ko=k()(Yo,[["render",Ho]]);var Wo=Ko;const Qo={class:"category-page"};function Xo(e,t,n,i,a,r){const o=Object(s["J"])("router-view");return Object(s["D"])(),Object(s["j"])("div",Qo,[this.loading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(o,{key:0,categoryName:a.categoryName},null,8,["categoryName"]))])}function Zo(e){return["Locations","Characters","Events"].includes(e)}var ec={name:"CategoryPage",props:{universeID:String},data(){return{loading:!0,categoryName:""}},methods:{...Object(b["d"])("notifications",["notify"]),async fetchCategory(e){this.loading=!0;try{if(Zo(e))this.categoryName=e;else{const t=await Bn(e);if(this.universeID!=t.Universe_id)throw new Error("This category does not belong to this universe");this.categoryName=t.name}this.loading=!1}catch(err){this.notify({type:"negative",message:"Error: "+err.message}),this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}})}}},async mounted(){await this.fetchCategory(this.$route.params.categoryID)},async beforeRouteUpdate(e,t){await this.fetchCategory(e.params.categoryID)}};n("0b1d");const tc=k()(ec,[["render",Xo]]);var nc=tc;const sc={class:"category-elements-page"},ic={class:"category-elements-page__search-section"},ac={class:"category-elements-page__results"};function rc(e,t,n,i,a,r){const o=Object(s["J"])("lb-search-bar"),c=Object(s["J"])("lb-universe-element-list"),l=Object(s["J"])("lb-page-nav");return Object(s["D"])(),Object(s["j"])("div",sc,[Object(s["k"])("div",ic,[Object(s["n"])(o,{placeholder:"Search elements in "+n.categoryName,onSearch:r.search,text:a.searchText},null,8,["placeholder","onSearch","text"])]),Object(s["k"])("div",ac,[Object(s["n"])(c,{categoryID:n.categoryID,title:n.categoryName,elements:a.elements,elementCount:a.elementCount,footerLink:!1,interactive:!0,loading:a.loading,onOnDelete:r.deleteElement},null,8,["categoryID","title","elements","elementCount","loading","onOnDelete"]),r.isPageNavNeeded?(Object(s["D"])(),Object(s["h"])(l,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)])])}var oc={components:{LbSearchBar:Cn,LbUniverseElementList:Hr,LbPageNav:Un},name:"CategoryElementsPage",props:{categoryID:{type:String},categoryName:{type:String}},data(){return{elements:[],elementCount:0,currentPage:1,totalPages:1,loading:!1,searchText:""}},computed:{...Object(b["c"])("universe",["universeID"]),isPageNavNeeded(){return!this.loading&&this.totalPages>1}},methods:{...Object(b["d"])("notifications",["notify"]),async fetchElements(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=50;this.loading=!0;try{const t=0!==n?n*s-s:0,i=await bs(this.universeID,e,s,t,this.categoryID);this.elementCount=i.elementCount,this.elements=i.elements,this.totalPages=i.totalPages}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchElements(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},async deleteElement({id:e,categoryID:t}){if(confirm("Are yo sure that you want delete this element?")){this.loading=!0;try{let n=null;switch(t){case"Locations":n=await as(e);break;case"Characters":n=await Hn(e);break;case"Events":n=await us(e);break;default:n=await Xn(e);break}n&&(this.notify({type:"positive",message:"Successfully deleted element"}),await this.search(this.searchText))}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}}}},watch:{async categoryID(){this.searchText="",this.currentPage=1,await this.fetchElements("",0)}},async mounted(){await this.fetchElements("",0)}};n("cfe2");const cc=k()(oc,[["render",rc]]);var lc=cc;const uc={class:"element-page"},dc={class:"element-page__side-panel"},pc={class:"side-panel__info"},bc=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),hc={class:"side-panel__header-text"},mc={class:"side-panel__bottom-button"},gc={class:"element-page__content"};function Oc(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("icon"),l=Object(s["J"])("lb-tag-container"),u=Object(s["J"])("lb-spinner"),d=Object(s["J"])("lb-button"),p=Object(s["J"])("lb-content");return Object(s["D"])(),Object(s["j"])("div",uc,[Object(s["k"])("div",dc,[Object(s["k"])("div",pc,[Object(s["k"])("div",{class:"side-panel__info-content",style:Object(s["x"])(r.sideInfoVisibility)},[Object(s["n"])(o,{value:a.name,maxLength:60,width:"100%",onOnSave:r.saveName,customClass:"side-panel__title"},null,8,["value","onOnSave"]),bc,Object(s["n"])(o,{value:a.description,maxLength:250,width:"100%",type:"textarea",onOnSave:r.saveDescription,customClass:"side-panel__description",noContent:"No description"},null,8,["value","onOnSave"]),null!==a.element?(Object(s["D"])(),Object(s["h"])(Object(s["K"])(r.specificElement),{key:0,element:a.element},null,8,["element"])):Object(s["i"])("",!0),Object(s["k"])("h3",hc,[Object(s["n"])(c,{icon:"lb-tags"}),Object(s["m"])(" Tags ")]),Object(s["n"])(l,{tags:a.tags,onAddTag:r.addTag,onRemoveTag:r.removeTag,loading:a.contentLoading,buttonLoading:a.tagLoading},null,8,["tags","onAddTag","onRemoveTag","loading","buttonLoading"])],4),a.elementLoading?(Object(s["D"])(),Object(s["h"])(u,{key:0})):Object(s["i"])("",!0)]),Object(s["k"])("div",mc,[Object(s["n"])(d,{variant:"negative",icon:"lb-trash",size:1.2,onClick:r.deleteCurrentElement,loading:a.deleteLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Delete Element")]),_:1},8,["size","onClick","loading"])])]),Object(s["k"])("div",gc,[a.contentLoading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["h"])(p,{key:0,elementID:parseInt(n.elementID),categoryID:n.categoryID},null,8,["elementID","categoryID"])),a.contentLoading?(Object(s["D"])(),Object(s["h"])(u,{key:1})):Object(s["i"])("",!0)])])}const vc={class:"lb-content"},jc={class:"lb-content__menu"},yc={key:0,class:"lb-content__elements"},fc={key:1,class:"lb-content__empty"};function _c(e,t,n,i,a,r){const o=Object(s["J"])("lb-menu-button");return Object(s["D"])(),Object(s["j"])("div",vc,[Object(s["k"])("div",jc,[Object(s["n"])(o,{icon:"lb-plus",size:1.2,options:a.options,loading:a.createLoading,onClick:r.clickOnMenuBtn,class:"lb-content__button-btn"},null,8,["size","options","loading","onClick"])]),e.contentElements.length?(Object(s["D"])(),Object(s["j"])("div",yc,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(e.contentElements,(t,i)=>(Object(s["D"])(),Object(s["h"])(Object(s["K"])(r.componentType(t.type)),Object(s["u"])({key:{id:t.id,type:t.type},position:i,isLast:r.isLast(i),contentID:e.contentID,buttonsLoading:a.elementButtonsLoading,elementID:n.elementID,categoryID:n.categoryID},t,{onMoveElement:r.moveElement,onDeleteElement:r.removeElement}),null,16,["position","isLast","contentID","buttonsLoading","elementID","categoryID","onMoveElement","onDeleteElement"]))),128))])):Object(s["i"])("",!0),0==e.contentElements.length?(Object(s["D"])(),Object(s["j"])("div",fc," No content elements yet ")):Object(s["i"])("",!0)])}const kc={class:"lb-menu-button"},wc={class:"lb-menu-button__activator"},Dc={key:0,class:"lb-menu-button__dropdown"},Cc={class:"lb-menu-button__options"},Ec=["onClick"];function Lc(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("icon");return Object(s["D"])(),Object(s["j"])("div",kc,[Object(s["k"])("div",wc,[Object(s["n"])(o,{size:n.size,icon:n.icon,disabled:n.disabled,loading:n.loading,onClick:r.clickActivator},{default:Object(s["T"])(()=>[Object(s["I"])(e.$slots,"default")]),_:3},8,["size","icon","disabled","loading","onClick"])]),n.disabled||n.loading||!a.isOpen?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Dc,[Object(s["k"])("div",Cc,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.options,e=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-menu-button__option",key:e.id,onClick:t=>r.clickOption(e.id),style:Object(s["x"])(r.optionSize)},[e.icon?(Object(s["D"])(),Object(s["h"])(c,{key:0,icon:e.icon,class:"lb-menu-button__option-icon"},null,8,["icon"])):Object(s["i"])("",!0),Object(s["k"])("span",null,Object(s["M"])(e.name),1)],12,Ec))),128))])]))])}var Ic={name:"LbMenuButton",emits:["click"],props:{size:{type:Number,required:!1,default:null},icon:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},loading:{type:Boolean,default:!1},options:{type:Array,default:[],required:!0}},data(){return{isOpen:!1}},computed:{optionSize(){return`font-size: ${this.size}rem;`}},methods:{clickActivator(){this.isOpen=!this.isOpen},clickOption(e){this.$emit("click",e),this.isOpen=!1}}};n("5ea1");const xc=k()(Ic,[["render",Lc]]);var Pc=xc;const Sc={class:"lb-text-element"};function Tc(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(c,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["k"])("div",Sc,[Object(s["n"])(o,{value:n.text,type:"textarea",width:"100%",onOnSave:r.saveText},null,8,["value","onOnSave"])])]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}const Nc={class:"lb-content-element"},Uc={class:"lb-content-element__header"},zc={class:"lb-content-element__header-buttons"},$c=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),Jc={class:"lb-content-element__body"},Mc={class:"lb-content-element__footer"},qc={class:"lb-content-element__footer-buttons"};function Bc(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",Nc,[Object(s["k"])("div",Uc,[Object(s["n"])(o,{value:n.title,maxLength:60,width:"100%",onOnSave:r.changeTitle,customClass:"lb-content-element__title"},null,8,["value","onOnSave"]),Object(s["k"])("div",zc,[Object(s["n"])(c,{variant:"negative",icon:"lb-trash",onClick:t[0]||(t[0]=t=>e.$emit("removeElement")),size:1.2,loading:n.buttonsLoading},null,8,["size","loading"])])]),$c,Object(s["k"])("div",Jc,[Object(s["I"])(e.$slots,"default")]),Object(s["k"])("div",Mc,[Object(s["k"])("div",qc,[Object(s["n"])(c,{icon:"lb-up",disabled:r.isUpBtnDisabled,onClick:t[1]||(t[1]=e=>r.moveContentElement(-1)),size:1.1,loading:n.buttonsLoading},null,8,["disabled","size","loading"]),Object(s["n"])(c,{icon:"lb-down",disabled:n.isLast,onClick:t[2]||(t[2]=e=>r.moveContentElement(1)),size:1.1,loading:n.buttonsLoading},null,8,["disabled","size","loading"])])])])}var Rc={name:"LbContentElement",components:{LbEditableText:qe},emits:["moveElement","removeElement","changeTitle"],props:{position:{type:Number,required:!0},isLast:{type:Boolean,default:!1},title:{type:String,default:"Title"},buttonsLoading:{type:Boolean,default:!1}},computed:{isUpBtnDisabled(){return this.position-1<0}},methods:{moveContentElement(e){this.$emit("moveElement",this.position+e)},changeTitle(e){this.$emit("changeTitle",e)}}};n("776c");const Gc=k()(Rc,[["render",Bc]]);var Vc=Gc;const Fc={emits:["moveElement","deleteElement"],props:{id:{type:Number,required:!0},contentID:{type:Number,required:!0},position:{type:Number,required:!0},isLast:{type:Boolean,default:!1},title:{type:String,default:"Title"},buttonsLoading:{type:Boolean,default:!1}},methods:{moveContentElement(e){this.$emit("moveElement",{oldPosition:this.position,newPosition:e})}}};var Ac=Fc;async function Hc(e,t){let n=e;return n.contentID=t,await O.post("/texts/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Yc(e,t,n){return await O.patch(`/texts/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function Kc(e,t){return await O.delete(`/texts/${e}/content/${t}`).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}var Wc={name:"LbTextElement",mixins:[Ac],components:{LbContentElement:Vc,LbEditableText:qe},props:{text:{type:String,default:""}},data(){return{elementType:Y.text}},computed:{...Object(b["c"])("element",["getElementById"])},methods:{...Object(b["d"])("notifications",["notify"]),deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await Yc(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async saveText(e){try{await Yc(this.id,{text:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.text=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}}}};n("8931");const Qc=k()(Wc,[["render",Tc]]);var Xc=Qc;const Zc={class:"lb-list-element"},el={key:0,class:"lb-list-element__items"},tl=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),nl={key:1,class:"lb-list-element__no-content"},sl={class:"lb-list-element__button"};function il(e,t,n,i,a,r){const o=Object(s["J"])("lb-list-item"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(l,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["k"])("div",Zc,[n.items.length>0?(Object(s["D"])(),Object(s["j"])("div",el,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(r.sortedItems,(t,n)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-list-element__item",key:t.id},[Object(s["n"])(o,{id:t.id,title:t.title,text:t.text,ordinalNumber:t.ordinalNumber,isLast:r.isItemLast(n),contentID:e.contentID,listID:e.id,onMoveItem:r.moveItem,onRemoveListItem:r.deleteItem},null,8,["id","title","text","ordinalNumber","isLast","contentID","listID","onMoveItem","onRemoveListItem"]),tl]))),128))])):Object(s["i"])("",!0),n.items.length?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",nl," No items ")),Object(s["k"])("div",sl,[Object(s["n"])(c,{icon:"lb-plus",onClick:r.addListItem,size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Add list item")]),_:1},8,["onClick","size"])])])]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}const al={class:"lb-list-item"},rl={class:"lb-list-item__header"},ol={class:"lb-list-item__header-buttons"},cl={class:"lb-list-item__body"};function ll(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",al,[Object(s["k"])("div",rl,[Object(s["n"])(o,{value:n.title,maxLength:45,width:"100%",onOnSave:r.saveTitle,customClass:"lb-list-item__title"},null,8,["value","onOnSave"]),Object(s["k"])("div",ol,[Object(s["n"])(c,{icon:"lb-up",disabled:r.isUpBtnDisabled,onClick:t[0]||(t[0]=e=>r.moveListItem(-1)),size:1},null,8,["disabled"]),Object(s["n"])(c,{icon:"lb-down",disabled:n.isLast,onClick:t[1]||(t[1]=e=>r.moveListItem(1)),size:1},null,8,["disabled"]),Object(s["n"])(c,{variant:"negative",icon:"lb-trash",onClick:t[2]||(t[2]=t=>e.$emit("removeListItem",n.id)),size:1})])]),Object(s["k"])("div",cl,[Object(s["n"])(o,{value:n.text,type:"textarea",width:"100%",onOnSave:r.saveText},null,8,["value","onOnSave"])])])}async function ul(e,t){let n=e;return n.contentID=t,await O.post("/lists/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function dl(e,t,n){return await O.patch(`/lists/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function pl(e,t){return await O.delete(`/lists/${e}/content/${t}`).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function bl(e){return await O.post("/list_items/",e).then(e=>e.data).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function hl(e,t){return await O.delete(`/list_items/${e}/content/${t}`).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function ml(e,t,n){return await O.patch(`/list_items/${e}/content/${n}`,t).then(()=>!0).catch(e=>{if(e.response&&e.response.data.message){const t=new Error(""+e.response.data.message);throw t}throw e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function gl(e,t,n){return await O.patch(`/list_items/position/${e}/content/${n}`,t).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}var Ol={name:"LbListItem",components:{LbEditableText:qe},emits:["removeListItem","moveItem"],props:{id:{type:Number,required:!0},listID:{type:Number,required:!0},ordinalNumber:{type:Number,required:!0},contentID:{type:Number,required:!0},title:{type:String},text:{type:String},isLast:{type:Boolean,default:!1}},computed:{...Object(b["c"])("element",["getElementById","getListItemById"]),isUpBtnDisabled(){return 0==this.ordinalNumber}},methods:{...Object(b["d"])("notifications",["notify"]),moveListItem(e){this.$emit("moveItem",{oldOrdinalNumber:this.ordinalNumber,newOrdinalNumber:this.ordinalNumber+e})},async saveText(e){try{await ml(this.id,{text:e},this.contentID);const t=this.getListItemById(this.listID,this.id);t.text=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async saveTitle(e){try{await ml(this.id,{title:e},this.contentID);const t=this.getListItemById(this.listID,this.id);t.title=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}}}};n("8641");const vl=k()(Ol,[["render",ll]]);var jl=vl,yl={name:"LbListElement",mixins:[Ac],components:{LbContentElement:Vc,LbListItem:jl},props:{items:{type:Array,default:[]}},data(){return{elementType:Y.list}},computed:{...Object(b["c"])("element",["getElementById","getListItemByOrder"]),sortedItems(){return this.items.sort((e,t)=>e.ordinalNumber>t.ordinalNumber?1:e.ordinalNumber==t.ordinalNumber?0:e.ordinalNumber<t.ordinalNumber?-1:void 0)}},methods:{...Object(b["d"])("notifications",["notify"]),isItemLast(e){return this.items.length-1==e},deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await dl(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async addListItem(){let e={title:"Title",text:"",ordinalNumber:this.items.length?this.sortedItems[this.items.length-1].ordinalNumber+1:0,listID:this.id,contentID:this.contentID};const t=await bl(e);e={id:t.id,title:e.title,text:e.text,ordinalNumber:e.ordinalNumber};const n=this.getElementById(this.id,this.elementType);n.items.push(e)},async moveItem(e){const t=this.getListItemByOrder(this.id,e.oldOrdinalNumber),n=this.getListItemByOrder(this.id,e.newOrdinalNumber);await gl(t.id,{listID:this.id,oldOrdinalNumber:e.oldOrdinalNumber,newOrdinalNumber:e.newOrdinalNumber},this.contentID),t.ordinalNumber=e.newOrdinalNumber,n.ordinalNumber=e.oldOrdinalNumber},async deleteItem(e){try{await hl(e,this.contentID);const t=this.getElementById(this.id,this.elementType),n=t.items.find(t=>t.id==e).ordinalNumber;t.items=this.items.filter(t=>t.id!==e),t.items.filter(e=>e.ordinalNumber>n).forEach(e=>{e.ordinalNumber=e.ordinalNumber-1})}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}}}};n("9e63");const fl=k()(yl,[["render",il]]);var _l=fl;const kl={class:"lb-link-group-element"},wl={key:0,class:"lb-link-group-element__items"},Dl=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1),Cl={key:1,class:"lb-link-group-element__no-content"},El={class:"lb-link-group-element__button"};function Ll(e,t,n,i,a,r){const o=Object(s["J"])("lb-content-link"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("link-popup"),u=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(u,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["k"])("div",kl,[n.links.length>0?(Object(s["D"])(),Object(s["j"])("div",wl,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.links,t=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-link-group-element__item",key:t.id},[Object(s["n"])(o,{id:t.id,contentID:e.contentID,description:t.description,targetID:t.targetID,targetName:t.targetName,categoryID:t.categoryID,categoryName:t.categoryName,linkGroupID:e.id,onRemoveLink:r.deleteContentLink},null,8,["id","contentID","description","targetID","targetName","categoryID","categoryName","linkGroupID","onRemoveLink"]),Dl]))),128))])):Object(s["i"])("",!0),n.links.length?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Cl," No links ")),Object(s["k"])("div",El,[Object(s["n"])(c,{icon:"lb-link",onClick:e.openLinkPopup,size:1.2},{default:Object(s["T"])(()=>[Object(s["m"])("Add new link")]),_:1},8,["onClick","size"])])]),e.isLinkPopupOpen?(Object(s["D"])(),Object(s["h"])(l,{key:0,linkGroupID:e.id,elementID:n.elementID,elementCategoryID:n.categoryID,onOnResult:r.addNewLink},null,8,["linkGroupID","elementID","elementCategoryID","onOnResult"])):Object(s["i"])("",!0)]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}const Il={class:"lb-content-link"},xl={class:"lb-content-link__header"},Pl={class:"lb-content-link__header-main"},Sl={class:"lb-content-link__title-text"},Tl={class:"lb-content-link__category"},Nl={class:"lb-content-link__header-buttons"},Ul={class:"lb-content-link__body"};function zl(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-editable-text");return Object(s["D"])(),Object(s["j"])("div",Il,[Object(s["k"])("div",xl,[Object(s["k"])("div",Pl,[Object(s["k"])("div",{onClick:t[0]||(t[0]=(...e)=>r.navigateToElement&&r.navigateToElement(...e)),class:"lb-content-link__title"},[Object(s["n"])(o,{icon:"lb-link",class:"lb-content-link__title-icon"}),Object(s["k"])("span",Sl,Object(s["M"])(n.targetName),1)]),Object(s["k"])("div",Tl,[Object(s["n"])(o,{icon:"lb-folder"}),Object(s["m"])(" "+Object(s["M"])(n.categoryName),1)])]),Object(s["k"])("div",Nl,[Object(s["n"])(c,{variant:"negative",icon:"lb-unlink",onClick:t[1]||(t[1]=t=>e.$emit("removeLink",n.id)),size:1})])]),Object(s["k"])("div",Ul,[Object(s["n"])(l,{value:n.description,type:"textarea",maxLength:250,width:"100%",onOnSave:r.saveDescription},null,8,["value","onOnSave"])])])}var $l={name:"LbContentLink",components:{LbEditableText:qe},emits:["removeLink"],props:{contentID:{type:Number,required:!0},id:{type:Number,required:!0},linkGroupID:{type:Number,required:!0},description:{type:String},targetID:{type:Number,required:!0},targetName:{type:String,rquired:!0},categoryID:{type:[Number,String],required:!0},categoryName:{type:String,required:!0}},computed:{...Object(b["c"])("universe",["universeID"]),...Object(b["c"])("element",["getLinkById"])},methods:{...Object(b["d"])("notifications",["notify"]),async saveDescription(e){try{await Et(this.id,{description:e},this.contentID);const t=this.getLinkById(this.linkGroupID,this.id);t.description=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},navigateToElement(){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:this.categoryID,elementID:this.targetID}})}}};n("58e7");const Jl=k()($l,[["render",zl]]);var Ml=Jl,ql={name:"LbLinkGroupElement",mixins:[Ac],components:{LbContentElement:Vc,LbContentLink:Ml,LinkPopup:Os},props:{links:{type:Array,default:[]},elementID:{type:Number},categoryID:{type:String}},data(){return{elementType:Y.linkGroup}},computed:{...Object(b["c"])("element",["getElementById"]),...Object(b["c"])("popups",["isLinkPopupOpen"])},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("popups",["openLinkPopup"]),deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){try{await Lt(this.id,{title:e},this.contentID);const t=this.getElementById(this.id,this.elementType);t.title=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},addNewLink(e){const t=this.getElementById(this.id,this.elementType);t.links.push(e)},async deleteContentLink(e){try{await xt(e,this.contentID);const t=this.getElementById(this.id,this.elementType);t.links=t.links.filter(t=>t.id!=e)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}}}};n("2155");const Bl=k()(ql,[["render",Ll]]);var Rl=Bl;function Gl(e,t,n,i,a,r){const o=Object(s["J"])("lb-content-element");return Object(s["D"])(),Object(s["h"])(o,{title:e.title,isLast:e.isLast,position:e.position,onChangeTitle:r.changeTitle,onMoveElement:e.moveContentElement,onRemoveElement:r.deleteElement,buttonsLoading:e.buttonsLoading},{default:Object(s["T"])(()=>[Object(s["m"])(" Image Group ")]),_:1},8,["title","isLast","position","onChangeTitle","onMoveElement","onRemoveElement","buttonsLoading"])}var Vl={name:"LbImageGroupElement",mixins:[Ac],components:{LbContentElement:Vc},data(){return{elementType:Y.imageGroup}},methods:{deleteElement(){this.$emit("deleteElement",{id:this.id,type:this.elementType})},async changeTitle(e){}}};const Fl=k()(Vl,[["render",Gl]]);var Al=Fl;const Hl={entry:"Entry",event:"Event",location:"Location",character:"Character"};function Yl(e){return e.Character_id?e.Character_id:e.Location_id?e.Location_id:e.Event_id?e.Event_id:e.Entry_id?e.Entry_id:void 0}function Kl(e){return{id:e.id,description:e.description,targetName:e.target.name,targetID:Yl(e),categoryName:e.target.Category.name,categoryID:e.target.Category.id}}function Wl(e,t){return e.map(e=>({id:e.id,title:e.title,links:t.filter(t=>t.Link_group_id==e.id).map(e=>Kl(e)),type:Y.linkGroup}))}function Ql(e){return{id:e.id,title:e.title,text:e.text,ordinalNumber:e.ordinal_number}}function Xl(e){return e.map(e=>({id:e.id,title:e.title,items:e.ListItems.map(e=>Ql(e)),type:Y.list}))}function Zl(e){return e.map(e=>({id:e.id,title:e.title,text:e.text,type:Y.text}))}function eu(e){return e.map(e=>({id:e.id,title:e.title,type:Y.imageGroup}))}async function tu(e,t){let n;return n="Characters"==t?Hl.character:"Locations"==t?Hl.location:"Events"==t?Hl.event:Hl.entry,await O.get(`/contents/${n}/${e}`).then(e=>{const t={contentID:e.data.content.id,configuration:e.data.content.configuration,texts:Zl(e.data.texts),lists:Xl(e.data.lists),linkGroups:Wl(e.data.linkGroups,e.data.links),imageGroups:eu(e.data.imageGroups),tags:e.data.tags};return t}).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function nu(e,t){const n={config:t};return await O.patch("/contents/"+e,n).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function su(e,t){let n=e;return n.contentID=t,await O.post("/image_groups/",n).then(e=>e.data).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function iu(e,t){return await O.delete(`/image_groups/${e}/content/${t}`).then(()=>!0).catch(e=>{throw e.response&&e.response.data.message?new Error(""+e.response.data.message):e.request?new Error("Service refused connection"):new Error("Undefined error")})}async function au(e,t,n){let s=null;try{n==Y.text?s=await Hc(e,t):n==Y.list?s=await ul(e,t):n==Y.linkGroup?s=await Ct(e,t):n==Y.imageGroup&&(s=await su(e,t))}catch(error){throw new Error(error.message)}return s}async function ru(e,t,n){n==Y.text?await Kc(e,t):n==Y.list?await pl(e,t):n==Y.linkGroup?await It(e,t):n==Y.imageGroup&&await iu(e,t)}var ou={name:"LbContent",components:{LbMenuButton:Pc,LbTextElement:Xc,LbListElement:_l,LbLinkGroupElement:Rl,LbImageGroupElement:Al},props:{elementID:Number,categoryID:String},data(){return{options:[{id:1,name:"Text",type:Y.text,icon:"lb-edit"},{id:2,name:"List",type:Y.list,icon:"lb-list"},{id:3,name:"Link Group",type:Y.linkGroup,icon:"lb-link"},{id:4,name:"Image Group",type:Y.imageGroup,icon:"lb-picture"}],createLoading:!1,elementButtonsLoading:!1}},computed:{...Object(b["c"])("element",["config","contentID","contentElements"])},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("element",["removeContentElement"]),async moveElement(e){this.elementButtonsLoading=!0;const t=this.contentElements.splice(e.oldPosition,1)[0];this.contentElements.splice(e.newPosition,0,t);try{await nu(this.contentID,this.config)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.elementButtonsLoading=!1}},async removeElement(e){try{this.elementButtonsLoading=!0,await ru(e.id,this.contentID,e.type),this.removeContentElement(e)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.elementButtonsLoading=!1}},async clickOnMenuBtn(e){const t=this.options.find(t=>t.id==e).type;try{this.createLoading=!0;let e={title:"Title of "+t};t==Y.text&&(e.text="");const n=await au(e,this.contentID,t);e.id=n.id,e.type=t,t==Y.list&&(e.items=[]),t==Y.linkGroup&&(e.links=[]),this.contentElements.push(e)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.createLoading=!1}},componentType(e){return e==Y.text?"LbTextElement":e==Y.list?"LbListElement":e==Y.linkGroup?"LbLinkGroupElement":e==Y.imageGroup?"LbImageGroupElement":void 0},isLast(e){return this.contentElements.length-1==e}}};n("9ca3");const cu=k()(ou,[["render",_c]]);var lu=cu;const uu={class:"lb-tag-container"},du={key:0,class:"lb-tag-container__tags"},pu={class:"lb-tag-container__tag-name"},bu={key:1,class:"lb-tag-container__no-content"},hu={key:1,class:"lb-tage-container__input-field"};function mu(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner"),l=Object(s["J"])("lb-input"),u=Object(s["J"])("lb-button");return Object(s["D"])(),Object(s["j"])("div",uu,[Object(s["k"])("div",{class:"lb-tag-container__content",style:Object(s["x"])(r.visibility)},[n.tags.length?(Object(s["D"])(),Object(s["j"])("div",du,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(n.tags,(t,n)=>(Object(s["D"])(),Object(s["j"])("div",{class:"lb-tag-container__tag",key:n},[Object(s["k"])("span",pu,Object(s["M"])(t.name),1),Object(s["n"])(o,{icon:"lb-cancel-circled",class:"lb-tag-container__icon",onClick:n=>e.$emit("removeTag",t.id)},null,8,["onClick"])]))),128))])):Object(s["i"])("",!0),n.tags.length<1?(Object(s["D"])(),Object(s["j"])("div",bu," No tags ")):Object(s["i"])("",!0)],4),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0})):Object(s["i"])("",!0),n.loading?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",hu,[Object(s["n"])(l,{maxLength:60,value:a.name,"onUpdate:value":t[0]||(t[0]=e=>a.name=e),fontSize:1,onKeydown:r.handleEnterPress},null,8,["value","onKeydown"]),Object(s["n"])(u,{variant:"positive",icon:"lb-plus",size:1,onClick:r.addTag,loading:n.buttonLoading},null,8,["onClick","loading"])]))])}var gu={name:"LbTagContainer",components:{LbInput:Zt},emits:["addTag","removeTag"],props:{tags:{type:Array,default:[]},loading:{type:Boolean,default:!1},buttonLoading:{type:Boolean,default:!1}},computed:{visibility(){return this.loading?"visibility: hidden;":"visibility: visible;"}},data(){return{name:""}},methods:{addTag(){if(0!==this.name.length){const e=this.tags.find(e=>e.name===this.name);void 0==e&&this.$emit("addTag",this.name),this.name=""}},handleEnterPress(e){"Enter"==e.key&&(e.preventDefault(),this.addTag())}}};n("91d4");const Ou=k()(gu,[["render",mu]]);var vu=Ou;const ju={class:"event-date-section"},yu={class:"event-date-section__header"},fu=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),_u={class:"event-date-section__date"},ku={class:"event-date-section__date-part"},wu=Object(s["k"])("span",{class:"event-date-section__date-part-name"},"Year: ",-1),Du={class:"event-date-section__date-part-value"},Cu={class:"event-date-section__date-part"},Eu=Object(s["k"])("span",{class:"event-date-section__date-part-name"},"Month: ",-1),Lu={class:"event-date-section__date-part-value"},Iu={class:"event-date-section__date-part"},xu=Object(s["k"])("span",{class:"event-date-section__date-part-name"},"Day: ",-1),Pu={class:"event-date-section__date-part-value"};function Su(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("event-date-popup");return Object(s["D"])(),Object(s["j"])("div",ju,[Object(s["k"])("h3",yu,[Object(s["m"])(" Date "),Object(s["n"])(o,{icon:"lb-edit",size:.8,onClick:r.openPopup},null,8,["size","onClick"])]),fu,Object(s["k"])("div",_u,[Object(s["k"])("div",ku,[wu,Object(s["k"])("span",Du,Object(s["M"])(a.year),1)]),Object(s["k"])("div",Cu,[Eu,Object(s["k"])("span",Lu,Object(s["M"])(a.month),1)]),Object(s["k"])("div",Iu,[xu,Object(s["k"])("span",Pu,Object(s["M"])(a.day),1)])]),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(c,{key:0,isOpen:a.isPopupOpen,onClose:r.closePopup,year:a.year,month:a.month,day:a.day,eventID:a.eventID,onOnResult:r.changeDate},null,8,["isOpen","onClose","year","month","day","eventID","onOnResult"])):Object(s["i"])("",!0)])}const Tu={class:"event-date-popup"},Nu={class:"event-date-popup__inputs"},Uu={class:"event-date-popup__buttons"};function zu(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(l,{isOpen:n.isOpen,title:"Change event date",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Tu,[Object(s["k"])("div",Nu,[Object(s["n"])(o,{name:"Year",type:"number",value:a.eventDate.year,"onUpdate:value":t[0]||(t[0]=e=>a.eventDate.year=e)},null,8,["value"]),Object(s["n"])(o,{name:"Month",type:"number","onChange:value":r.setEventMonth,value:a.eventDate.month,"onUpdate:value":t[1]||(t[1]=e=>a.eventDate.month=e)},null,8,["onChange:value","value"]),Object(s["n"])(o,{name:"Day",type:"number","onChange:value":r.setEventDay,value:a.eventDate.day,"onUpdate:value":t[2]||(t[2]=e=>a.eventDate.day=e)},null,8,["onChange:value","value"])]),Object(s["k"])("div",Uu,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.changeDate,loading:a.loading},{default:Object(s["T"])(()=>[Object(s["m"])("Save date")]),_:1},8,["size","onClick","loading"])])])]),_:1},8,["isOpen","onClose"])}var $u={name:"EventDatePopup",components:{LbInput:Zt},emits:["close","onResult"],props:{isOpen:{type:Boolean,default:!1},year:{type:Number},month:{type:Number},day:{type:Number},eventID:{type:Number,required:!0}},data(){return{eventDate:{year:this.year,month:this.month,day:this.day},loading:!1}},methods:{...Object(b["d"])("notifications",["notify"]),close(){this.$emit("close")},setEventMonth(e){this.eventDate.month=e>12?12:e<1?1:e},setEventDay(e){this.eventDate.day=e>31?31:e<1?1:e},async changeDate(){try{this.loading=!0,await os(this.eventID,this.eventDate),this.$emit("onResult",this.eventDate),this.close()}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}}}};n("1417");const Ju=k()($u,[["render",zu]]);var Mu=Ju,qu={name:"EventDateSection",components:{EventDatePopup:Mu},props:{element:{type:Object,required:!0,validator:e=>null!==e.year&&void 0!==e.year&&(null!==e.month&&void 0!==e.month&&(null!==e.day&&void 0!==e.day))}},data(){return{year:this.element.year,month:this.element.month,day:this.element.day,eventID:this.element.id,isPopupOpen:!1}},methods:{closePopup(){this.isPopupOpen=!1},openPopup(){this.isPopupOpen=!0},changeDate(e){this.year=e.year,this.month=e.month,this.day=e.day}}};n("c8be");const Bu=k()(qu,[["render",Su]]);var Ru=Bu;const Gu={class:"location-parent-section"},Vu={class:"location-parent-section__header"},Fu={key:1,class:"location-parent-section__no-content"};function Au(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("icon"),l=Object(s["J"])("location-parent-popup");return Object(s["D"])(),Object(s["j"])("div",Gu,[Object(s["k"])("h3",Vu,[Object(s["m"])(" Parent Location "),Object(s["n"])(o,{icon:"lb-edit",size:.8,onClick:r.openPopup},null,8,["size","onClick"])]),a.parentName?(Object(s["D"])(),Object(s["j"])("div",{key:0,class:"location-parent-section__parent",onClick:t[0]||(t[0]=(...e)=>r.navigateToParent&&r.navigateToParent(...e))},[Object(s["n"])(c,{icon:"lb-link"}),Object(s["k"])("span",null,Object(s["M"])(a.parentName),1)])):Object(s["i"])("",!0),a.parentName?Object(s["i"])("",!0):(Object(s["D"])(),Object(s["j"])("div",Fu," No Parent Location ")),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(l,{key:2,isOpen:a.isPopupOpen,locationID:a.id,currentParentID:a.parentID,currentParentName:a.parentName,onClose:r.closePopup,onOnResult:r.setParent},null,8,["isOpen","locationID","currentParentID","currentParentName","onClose","onOnResult"])):Object(s["i"])("",!0)])}const Hu={class:"location-parent-popup"},Yu={class:"location-parent-popup__field"},Ku={class:"location-parent-popup__name"},Wu={class:"location-parent-popup__name-value"},Qu={class:"location-parent-popup__field"},Xu={class:"location-parent-popup__field"},Zu={class:"location-parent-popup__field"},ed={class:"location-parent-popup__buttons"};function td(e,t,n,i,a,r){const o=Object(s["J"])("lb-search-bar"),c=Object(s["J"])("lb-select-list"),l=Object(s["J"])("lb-page-nav"),u=Object(s["J"])("lb-button"),d=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(d,{isOpen:n.isOpen,title:"Set Parent Location",onClose:r.close},{default:Object(s["T"])(()=>[Object(s["k"])("div",Hu,[Object(s["k"])("div",Yu,[Object(s["k"])("div",Ku,[Object(s["m"])(" Current Parent: "),Object(s["k"])("span",Wu,Object(s["M"])(n.currentParentName),1)])]),Object(s["k"])("div",Qu,[Object(s["n"])(o,{placeholder:"Search location...",onSearch:r.search,text:a.searchText},null,8,["placeholder","onSearch","text"])]),Object(s["k"])("div",Xu,[Object(s["n"])(c,{items:r.filteredLocations,loading:a.locationsLoading,selectedID:a.parentID,onOnSelect:r.selectParent,maxHeight:"250px"},null,8,["items","loading","selectedID","onOnSelect"])]),Object(s["k"])("div",Zu,[1!=a.totalPages?(Object(s["D"])(),Object(s["h"])(l,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage,class:"location-parent-popup__page-nav"},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)]),Object(s["k"])("div",ed,[Object(s["n"])(u,{variant:"outline",size:1.4,onClick:r.close},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size","onClick"]),Object(s["n"])(u,{variant:"positive",size:1.4,onClick:r.setParent,loading:a.setParentLoading},{default:Object(s["T"])(()=>[Object(s["m"])("Set Parent")]),_:1},8,["size","onClick","loading"])])])]),_:1},8,["isOpen","onClose"])}var nd={name:"LocationParentPopup",components:{LbSearchBar:Cn,LbSelectList:fn,LbPageNav:Un},emits:["close","onResult"],props:{isOpen:{type:Boolean,default:!1},locationID:{type:Number},currentParentID:{type:Number},currentParentName:{type:String}},data(){return{parentID:this.currentParentID,parentName:this.currentParentName,searchText:"",locationsLoading:!1,locations:[],currentPage:1,totalPages:2,setParentLoading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),filteredLocations(){return this.locations.filter(e=>e.id!==this.locationID&&e.Location_id!==this.locationID)}},methods:{...Object(b["d"])("notifications",["notify"]),close(){this.$emit("close")},async fetchLocations(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=25;this.locationsLoading=!0;try{const t=0!==n?n*s-s:0,i=await bs(this.universeID,e,s,t,"Locations");this.locations=i.elements,this.totalPages=i.totalPages}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.locationsLoading=!1}},selectParent(e){this.parentID=this.parentID!==e?e:null,null!==this.parentID?this.parentName=this.filteredLocations.find(e=>e.id==this.parentID).name:this.parentName=null},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchLocations(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},async setParent(){try{this.setParentLoading=!0,await ts(this.locationID,{Location_id:this.parentID}),this.$emit("onResult",{id:this.parentID,name:this.parentName}),this.close()}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.setParentLoading=!1}}},async mounted(){await this.fetchLocations("",1)}};n("6f37");const sd=k()(nd,[["render",td]]);var id=sd,ad={name:"LocationParentSection",components:{LocationParentPopup:id},props:{element:{type:Object,required:!0}},data(){return{id:this.element.id,parentName:this.element.parentName,parentID:this.element.parentID,isPopupOpen:!1}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{closePopup(){this.isPopupOpen=!1},openPopup(){this.isPopupOpen=!0},navigateToParent(){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:"Locations",elementID:this.parentID}})},setParent(e){this.parentID=e.id,this.parentName=e.name}}};n("29ed");const rd=k()(ad,[["render",Au]]);var od=rd;function cd(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div")}var ld={name:"DummyComponent"};const ud=k()(ld,[["render",cd]]);var dd=ud,pd={name:"ElementPage",components:{LbEditableText:qe,LbContent:lu,LbTagContainer:vu,EventDateSection:Ru,DummyComponent:dd,LocationParentSection:od},props:{elementID:{type:String,required:!0},categoryID:{type:String,required:!0}},data(){return{name:"",description:"",element:null,elementLoading:!1,contentLoading:!0,deleteLoading:!1,tags:[],tagLoading:!1}},computed:{...Object(b["c"])("universe",["universeID"]),...Object(b["c"])("element",["contentID"]),sideInfoVisibility(){return this.elementLoading?"visibility: hidden;":"visibility: visible;"},specificElement(){return"Events"==this.categoryID?"EventDateSection":"Locations"==this.categoryID?"LocationParentSection":"DummyComponent"}},methods:{...Object(b["d"])("notifications",["notify"]),...Object(b["d"])("element",["setContent","setContentID","clearContent"]),async fetchElement(e,t){this.element=null;const n=e||this.categoryID,s=t||this.elementID;this.elementLoading=!0;try{const e=await ds(s,n);if(e){if(null!=e.Universe_id&&e.Universe_id!=this.universeID)throw new Rn("This element does not belong to this universe!");return this.name=e.name,this.description=e.description,this.element=e,!0}}catch(error){return this.notify({type:"negative",message:"Error: "+error.message}),error instanceof Rn&&this.$router.replace({name:"ElementNotFoundPage",params:{universeID:this.universeID}}),!1}finally{this.elementLoading=!1}},async fetchFullContent(){this.contentLoading=!0;try{this.clearContent();const e=await tu(this.elementID,this.categoryID);this.setContentID(e.contentID);const t=e.configuration.map(t=>t.type==Y.text?e.texts.find(e=>e.id==t.id):t.type==Y.list?e.lists.find(e=>e.id==t.id):t.type==Y.linkGroup?e.linkGroups.find(e=>e.id==t.id):t.type==Y.imageGroup?e.imageGroups.find(e=>e.id==t.id):void 0);this.tags=e.tags,this.setContent(t)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.contentLoading=!1}},async saveName(e){try{if(e.length<1)throw new Error("Cannot save Name: It should have at least 1 character");await ps(this.elementID,{name:e},this.categoryID),this.name=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async saveDescription(e){try{await ps(this.elementID,{description:e},this.categoryID),this.description=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async addTag(e){try{this.tagLoading=!0;const t=await ar(e,this.contentID,this.universeID);this.tags.push({id:t.id,name:e})}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.tagLoading=!1}},async removeTag(e){try{this.tagLoading=!0,await or(e,this.contentID),this.tags=this.tags.filter(t=>t.id!==e)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.tagLoading=!1}},async deleteCurrentElement(){try{this.deleteLoading=!0,confirm("Do you want delete this element? It cannot be undone!")&&(await hs(this.elementID,this.categoryID),this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}}),this.clearContent())}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.deleteLoading=!1}},async init(e,t){const n=await this.fetchElement(e,t);n&&this.fetchFullContent(e,t)}},watch:{async $route(e){"ElementPage"===e.name&&await this.init(e.params.categoryID,e.params.elementID)}},async mounted(){await this.init()},beforeRouteLeave(e,t){this.clearContent()}};n("7c9b");const bd=k()(pd,[["render",Oc]]);var hd=bd;const md={class:"element-not-found-page"},gd=Object(s["k"])("div",{class:"element-not-found-page__title"}," Page Not Found ",-1),Od=[gd];function vd(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",md,Od)}var jd={name:"ElementNotFoundPage"};n("c485");const yd=k()(jd,[["render",vd]]);var fd=yd;const _d={class:"search-page"},kd={class:"search-page__filter-section"},wd={class:"search-page__filters"},Dd=Object(s["k"])("h2",{class:"search-page__result-section-header"},"Results",-1),Cd={class:"search-page__element-table"},Ed={class:"element-table__row element-table__row--header"},Ld={class:"element-table__cell"},Id={class:"element-table__cell-content"},xd=Object(s["k"])("span",null," Name ",-1),Pd={class:"element-table__cell"},Sd={class:"element-table__cell-content"},Td=Object(s["k"])("span",null," Category ",-1),Nd=Object(s["k"])("th",{class:"element-table__cell element-table__cell--shrink"}," Last modified ",-1),Ud={class:"element-table__cell"},zd=["onClick"],$d={class:"element-table__cell"},Jd={class:"element-table__cell element-table__cell--shrink"};function Md(e,t,n,i,a,r){const o=Object(s["J"])("lb-search-bar"),c=Object(s["J"])("lb-select"),l=Object(s["J"])("lb-tag-container"),u=Object(s["J"])("icon"),d=Object(s["J"])("lb-page-nav"),p=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("div",_d,[Object(s["k"])("div",kd,[Object(s["n"])(o,{placeholder:"Search elements by name...",onSearch:r.search,text:a.searchText},null,8,["placeholder","onSearch","text"]),Object(s["k"])("div",wd,[Object(s["n"])(c,{placeholder:"All categories",items:a.categories,loading:a.categoriesLoading,multiselect:!0,width:"50%"},null,8,["items","loading"]),Object(s["n"])(l,{tags:a.tags,onAddTag:r.addTag,onRemoveTag:r.removeTag},null,8,["tags","onAddTag","onRemoveTag"])])]),Object(s["k"])("div",{class:"search-page__result-section",style:Object(s["x"])(r.loadingVisibility)},[Dd,Object(s["k"])("table",Cd,[Object(s["k"])("tr",Ed,[Object(s["k"])("th",Ld,[Object(s["k"])("div",Id,[Object(s["n"])(u,{icon:"lb-link"}),xd])]),Object(s["k"])("th",Pd,[Object(s["k"])("div",Sd,[Object(s["n"])(u,{icon:"lb-folder"}),Td])]),Nd]),(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(a.elements,(e,t)=>(Object(s["D"])(),Object(s["j"])("tr",{class:"element-table__row",key:t},[Object(s["k"])("td",Ud,[Object(s["k"])("span",{class:"element-table__link",onClick:t=>r.navigateToElement(e.id,e.categoryID)},Object(s["M"])(e.name),9,zd)]),Object(s["k"])("td",$d,[Object(s["k"])("span",null,Object(s["M"])(e.categoryName),1)]),Object(s["k"])("td",Jd,Object(s["M"])(r.formatDate(e.lastModified)),1)]))),128))]),r.isPageNavNeeded?(Object(s["D"])(),Object(s["h"])(d,{key:0,currentPage:a.currentPage,totalPages:a.totalPages,onGo:r.changePage},null,8,["currentPage","totalPages","onGo"])):Object(s["i"])("",!0)],4),a.elementsLoading?(Object(s["D"])(),Object(s["h"])(p,{key:0})):Object(s["i"])("",!0)])}var qd=n("11c1"),Bd={name:"SearchPage",components:{LbSearchBar:Cn,LbSelect:dn,LbTagContainer:vu,LbPageNav:Un},data(){return{searchText:"",tags:[],categories:[],categoriesLoading:!1,elementsLoading:!1,elements:[],currentPage:1,totalPages:1}},computed:{...Object(b["c"])("universe",["universeID"]),selectedCategories(){return this.categories.filter(e=>e.selected).map(e=>e.id)},loadingVisibility(){return this.elementsLoading?"visibility: hidden;":"visibility: visible;"},isPageNavNeeded(){return this.totalPages>1}},methods:{...Object(b["d"])("notifications",["notify"]),formatDate(e){const t=new Date(e),n=Object(Vr["a"])(t,"dd.MM.yyyy hh:mm");return n},navigateToElement(e,t){this.$router.push({name:"ElementPage",params:{universeID:this.universeID,categoryID:t,elementID:e}})},async search(e){const t=1==this.currentPage?0:this.currentPage;await this.fetchElements(e,t)},async changePage(e){this.currentPage=e,await this.search(this.searchText)},addTag(e){this.tags.push({id:Object(qd["v4"])(),name:e})},removeTag(e){this.tags=this.tags.filter(t=>t.id!==e)},async fetchElements(e,t){let n=t;this.searchText!==e&&(this.currentPage=1,n=1),this.searchText=e;const s=50;this.loading=!0;try{const t=0!==n?n*s-s:0,i=this.tags.map(e=>e.name),a=await Wr(this.universeID,e,this.selectedCategories,i,s,t);this.elements=a.elements,this.totalPages=a.totalPages}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}},async fetchCategories(){try{this.categoriesLoading=!0;const e=[{id:"Characters",name:"Characters"},{id:"Locations",name:"Locations"},{id:"Events",name:"Events"}],t=await zn(this.universeID);this.categories.push(...e,...t)}catch(error){this.notify({type:"negative",message:error.message})}finally{this.categoriesLoading=!1}}},async mounted(){this.fetchCategories()}};n("8fb3");const Rd=k()(Bd,[["render",Md]]);var Gd=Rd;const Vd={class:"story-page"};function Fd(e,t,n,i,a,r){const o=Object(s["J"])("router-view");return Object(s["D"])(),Object(s["j"])("div",Vd,[n.storyID?(Object(s["D"])(),Object(s["h"])(o,{key:0,storyID:n.storyID,universeID:n.universeID},null,8,["storyID","universeID"])):Object(s["i"])("",!0)])}var Ad={name:"StoryPage",props:{storyID:{type:String},universeID:{type:String}},data(){return{}}};n("3319");const Hd=k()(Ad,[["render",Fd]]);var Yd=Hd;const Kd={class:"story-chapters-page"},Wd=Object(s["k"])("label",{class:"story-chapters-page__header-label"},"Description",-1),Qd={class:"story-chapters-page__chapter-list"},Xd=Object(s["k"])("div",{class:"story-chapters-page__chapter-list-header"}," List of Chapters ",-1),Zd=Object(s["k"])("div",{class:"util__horizontal-line--black"},null,-1);function ep(e,t,n,i,a,r){const o=Object(s["J"])("lb-editable-text"),c=Object(s["J"])("lb-spinner"),l=Object(s["J"])("story-chapters");return Object(s["D"])(),Object(s["j"])("div",Kd,[Object(s["k"])("div",{class:"story-chapters-page__header",style:Object(s["x"])(r.storyLoadingVisibility)},[Object(s["n"])(o,{value:a.storyTitle,maxLength:80,customClass:"story-chapters-page__title",onOnSave:r.changeStoryTitle},null,8,["value","onOnSave"]),Wd,Object(s["n"])(o,{value:a.storyDescription,maxLength:500,type:"textarea",customClass:"story-chapters-page__description",onOnSave:r.changeStoryDescription,noContent:"No description"},null,8,["value","onOnSave"])],4),a.storyLoading?(Object(s["D"])(),Object(s["h"])(c,{key:0})):Object(s["i"])("",!0),Object(s["k"])("div",Qd,[Xd,Zd,a.canShowChapters?(Object(s["D"])(),Object(s["h"])(l,{key:0,storyID:n.storyID},null,8,["storyID"])):Object(s["i"])("",!0)])])}const tp={class:"story-chapters"},np={key:0,class:"story-chapters__content"},sp={key:1,class:"story-chapters__no-content"},ip={class:"story-chapters__create-button"};function ap(e,t,n,i,a,r){const o=Object(s["J"])("lb-chapter-element"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("create-chapter-popup");return Object(s["D"])(),Object(s["j"])("div",tp,[a.chapters.length?(Object(s["D"])(),Object(s["j"])("div",np,[(Object(s["D"])(!0),Object(s["j"])(s["b"],null,Object(s["H"])(r.sortedChapters,(e,t)=>(Object(s["D"])(),Object(s["h"])(o,{key:t,id:e.id,title:e.title,description:e.description,ordinalNumber:e.ordinalNumber,isLast:e.ordinalNumber==a.chapters.length-1,storyID:n.storyID,onChangeDescription:r.changeDescription,onDeleteChapter:r.removeChapter,onMoveChapter:r.moveChapter},null,8,["id","title","description","ordinalNumber","isLast","storyID","onChangeDescription","onDeleteChapter","onMoveChapter"]))),128))])):Object(s["i"])("",!0),0==a.chapters.length?(Object(s["D"])(),Object(s["j"])("div",sp," No chapters ")):Object(s["i"])("",!0),Object(s["k"])("div",ip,[Object(s["n"])(c,{onClick:r.openPopup,size:1.2,icon:"lb-plus"},{default:Object(s["T"])(()=>[Object(s["m"])("Create new chapter")]),_:1},8,["onClick","size"])]),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:2})):Object(s["i"])("",!0),a.isPopupOpen?(Object(s["D"])(),Object(s["h"])(u,{key:3,isOpen:a.isPopupOpen,onClose:r.closePopup,storyID:n.storyID,ordinalNumber:r.newChapterOrdinalNumber,onOnResult:r.addNewChapter},null,8,["isOpen","onClose","storyID","ordinalNumber","onOnResult"])):Object(s["i"])("",!0)])}const rp={class:"create-chapter-popup__form"},op={class:"create-chapter-popup__buttons"};function cp(e,t,n,i,a,r){const o=Object(s["J"])("lb-input"),c=Object(s["J"])("lb-button"),l=Object(s["J"])("lb-spinner"),u=Object(s["J"])("lb-popup-box");return Object(s["D"])(),Object(s["h"])(u,{isOpen:n.isOpen,title:"Create Chapter",onClose:t[2]||(t[2]=t=>e.$emit("close"))},{default:Object(s["T"])(()=>[Object(s["k"])("div",{class:"create-chapter-popup",style:Object(s["x"])(r.setVisibilityOnLoading)},[Object(s["k"])("div",rp,[Object(s["n"])(o,{name:"Chapter Title",maxLength:80,value:a.title,"onUpdate:value":r.setTitle,error:a.titleError},null,8,["value","onUpdate:value","error"]),Object(s["n"])(o,{name:"Description",type:"textarea",value:a.description,"onUpdate:value":t[0]||(t[0]=e=>a.description=e),maxLength:500},null,8,["value"])]),Object(s["k"])("div",op,[Object(s["n"])(c,{variant:"outline",size:1.4,onClick:t[1]||(t[1]=t=>e.$emit("close"))},{default:Object(s["T"])(()=>[Object(s["m"])("Cancel")]),_:1},8,["size"]),Object(s["n"])(c,{variant:"positive",size:1.4,onClick:r.create,disabled:!r.isFormValid},{default:Object(s["T"])(()=>[Object(s["m"])("Create")]),_:1},8,["size","onClick","disabled"])])],4),a.loading?(Object(s["D"])(),Object(s["h"])(l,{key:0,size:"50px"})):Object(s["i"])("",!0)]),_:1},8,["isOpen"])}var lp={name:"CreateChapterPopup",components:{LbInput:Zt},props:{isOpen:{type:Boolean,default:!1},storyID:{type:String,required:!0},ordinalNumber:{type:Number,required:!0}},emits:["close","onResult"],data(){return{loading:!1,title:"",titleError:"",description:""}},computed:{setVisibilityOnLoading(){return this.loading?"visibility: hidden;":"visibility: visible;"},isFormValid(){return""==this.titleError&&this.title.length>0}},methods:{...Object(b["d"])("notifications",["notify"]),setTitle(e){this.titleError="",this.title=e,this.title.length<1&&(this.titleError="Title cannot be empty!")},async create(){try{this.loading=!0;const e=await yt(this.title,this.description,this.ordinalNumber,this.storyID);e.ordinalNumber=e.ordinal_number,delete e.ordinal_number,this.$emit("onResult",e),this.$emit("close")}catch(error){this.notify({type:"negative",message:error.message})}finally{this.loading=!1}}}};n("f194");const up=k()(lp,[["render",cp]]);var dp=up;const pp={class:"lb-chapter-element"},bp={class:"lb-chapter-element__header"},hp={class:"lb-chapter-element__header-part"},mp={class:"lb-chapter-element__header-part"},gp={class:"lb-chapter-element__buttons"},Op={class:"lb-chapter-element__position-buttons"},vp=Object(s["k"])("div",{class:"util__horizontal-line--white"},null,-1),jp={class:"lb-chapter-element__content"},yp=Object(s["k"])("label",{class:"lb-chapter-element__description-label"}," Description ",-1);function fp(e,t,n,i,a,r){const o=Object(s["J"])("lb-button"),c=Object(s["J"])("lb-editable-text");return Object(s["D"])(),Object(s["j"])("div",pp,[Object(s["k"])("div",bp,[Object(s["k"])("div",hp,[Object(s["k"])("div",{class:"lb-chapter-element__title",onClick:t[0]||(t[0]=(...e)=>r.navigateToChapter&&r.navigateToChapter(...e))},Object(s["M"])(n.title),1)]),Object(s["k"])("div",mp,[Object(s["k"])("div",gp,[Object(s["k"])("div",Op,[Object(s["n"])(o,{icon:"lb-up",size:1.05,disabled:0==n.ordinalNumber,onClick:t[1]||(t[1]=e=>r.moveChapter(-1))},null,8,["size","disabled"]),Object(s["n"])(o,{icon:"lb-down",size:1.05,disabled:n.isLast,onClick:t[2]||(t[2]=e=>r.moveChapter(1))},null,8,["size","disabled"])]),Object(s["n"])(o,{icon:"lb-trash",variant:"negative",size:1.05,onClick:r.deleteChapter},null,8,["size","onClick"])])])]),vp,Object(s["k"])("div",jp,[yp,Object(s["n"])(c,{maxLength:500,noContent:"No Description",type:"textarea",width:"100%",value:n.description,onOnSave:r.changeDescription},null,8,["value","onOnSave"])])])}var _p={name:"LbChapterElement",components:{LbEditableText:qe},emits:["changeDescription","moveChapter","deleteChapter"],props:{id:{type:Number,require:!0},storyID:{type:String},title:{type:String},ordinalNumber:{type:Number},description:{type:String},isLast:{type:Boolean,default:!1}},computed:{...Object(b["c"])("universe",["universeID"])},methods:{changeDescription(e){this.$emit("changeDescription",{id:this.id,newValue:e})},moveChapter(e){this.$emit("moveChapter",{oldOrdinalNumber:this.ordinalNumber,newOrdinalNumber:this.ordinalNumber+e})},deleteChapter(){this.$emit("deleteChapter",this.id)},navigateToChapter(){this.$router.push({name:"ChapterPage",params:{chapterID:this.id,storyID:this.storyID,universeID:this.universeID}})}}};n("1d2a");const kp=k()(_p,[["render",fp]]);var wp=kp,Dp={name:"StoryChapters",components:{CreateChapterPopup:dp,LbChapterElement:wp},props:{storyID:{type:String}},data(){return{isPopupOpen:!1,chapters:[],loading:!1}},computed:{newChapterOrdinalNumber(){return this.chapters.length},sortedChapters(){return this.chapters.sort((e,t)=>e.ordinalNumber>t.ordinalNumber?1:e.ordinalNumber==t.ordinalNumber?0:e.ordinalNumber<t.ordinalNumber?-1:void 0)}},methods:{...Object(b["d"])("notifications",["notify"]),closePopup(){this.isPopupOpen=!1},openPopup(){this.isPopupOpen=!0},async changeDescription(e){const{id:t,newValue:n}=e;try{const e=this.chapters.find(e=>e.id==t);await ft(e.id,{description:n}),e.description=n}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},addNewChapter(e){this.chapters.push(e)},async moveChapter(e){try{const t=this.chapters.find(t=>t.ordinalNumber==e.oldOrdinalNumber),n=this.chapters.find(t=>t.ordinalNumber==e.newOrdinalNumber);await _t(t.id,{storyID:this.storyID,oldOrdinalNumber:e.oldOrdinalNumber,newOrdinalNumber:e.newOrdinalNumber}),t.ordinalNumber=e.newOrdinalNumber,n.ordinalNumber=e.oldOrdinalNumber}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async removeChapter(e){try{const t=this.chapters.find(t=>t.id==e),n=t.ordinalNumber;await kt(t.id),this.chapters=this.chapters.filter(t=>t.id!==e),this.chapters.filter(e=>e.ordinalNumber>n).forEach(e=>{e.ordinalNumber=e.ordinalNumber-1})}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async fetchChapters(){this.loading=!0;try{this.chapters=await jt(this.storyID)}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}finally{this.loading=!1}}},async mounted(){await this.fetchChapters()}};n("5014");const Cp=k()(Dp,[["render",ap]]);var Ep=Cp,Lp={name:"StoryChaptersPage",components:{LbEditableText:qe,StoryChapters:Ep},props:{storyID:{type:String},universeID:{type:String}},data(){return{storyTitle:"",storyDescription:"",storyLoading:!0,canShowChapters:!1}},computed:{storyLoadingVisibility(){return this.storyLoading?"visibility: hiddden;":"visibility: visible"}},methods:{...Object(b["d"])("notifications",["notify"]),async changeStoryTitle(e){try{await go(this.storyID,{title:e}),this.storyTitle=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async changeStoryDescription(e){try{await go(this.storyID,{description:e}),this.storyDescription=e}catch(error){this.notify({type:"negative",message:"Error: "+error.message})}},async fetchStory(){try{this.storyLoading=!0;const e=await bo(this.storyID);if(this.universeID!=e.Universe_id)throw new Error("This story does not belong to this universe");return this.storyDescription=e.description,this.storyTitle=e.title,!0}catch(error){this.notify({type:"negative",message:"Error: "+error.message}),this.$router.replace({name:"UniverseMainPage",params:{universeID:this.universeID}})}finally{this.storyLoading=!1}}},async mounted(){this.canShowChapters=await this.fetchStory()}};n("5765");const Ip=k()(Lp,[["render",ep]]);var xp=Ip;const Pp={path:"category/:categoryID/",name:"Category",props:!0,components:{default:nc},children:[{path:"",name:"CategoryElements",component:lc,props:!0},{path:"element/:elementID",name:"ElementPage",component:hd,props:!0}]},Sp={path:"",name:"UniverseMainPage",component:Mo,props:!0},Tp={path:"not-found",name:"ElementNotFoundPage",component:fd},Np={path:"search/",name:"SearchPage",component:Gd},Up={path:"story/:storyID",name:"StoryPage",component:Yd,props:!0,children:[{path:"chapter/:chapterID",name:"ChapterPage",component:qs,props:!0},{path:"",name:"StoryChaptersPage",component:xp,props:!0}]},zp=[{path:"/",name:"Main",component:Ae},{path:"/register",name:"Register",component:bi,meta:{requiresUnAuth:!0}},{path:"/login",name:"Login",component:zi,meta:{requiresUnAuth:!0}},{path:"/user",name:"User",component:ba,meta:{requiresAuth:!0}},{path:"/universe/:universeID",name:"Universe",components:{default:mr,header:Wo},meta:{requiresAuth:!0,universeRelated:!0},async beforeEnter(e,t,n){X.getters["universe/universesFetchedFlag"]||await X.dispatch("universe/fetchUserUniverses"),X.getters["universe/checkIfUserOwnsUniverse"]({universeID:e.params.universeID})?n():n("/user")},children:[Pp,Sp,Tp,Np,Up]},{path:"/:notFound(.*)",redirect:"/"}],$p=Object(N["a"])({history:Object(N["b"])("/"),routes:zp});$p.beforeEach(async(e,t,n)=>{if(!X.getters.tokenRefreshedFlag){let e=await y();e&&e.data.name&&e.data.email&&e.data.id&&X.commit("setUser",e.data),X.commit("setTokenRefreshedFlag",!0)}e.meta.requiresAuth&&!X.getters.isAuth?n("/login"):e.meta.requiresUnAuth&&X.getters.isAuth?n("/user"):n()});var Jp=$p;function Mp(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",null,[Object(s["k"])("i",{class:Object(s["w"])(n.icon),style:Object(s["x"])(r.setSize)},null,6)])}var qp={name:"Icon",props:{icon:{type:String,required:!0},size:{type:Number}},computed:{setSize(){if(this.size)return`font-size: ${this.size}rem`}}};n("2a18");const Bp=k()(qp,[["render",Mp]]);var Rp=Bp;const Gp=["disabled","tabindex"],Vp={class:"button__content"};function Fp(e,t,n,i,a,r){const o=Object(s["J"])("icon"),c=Object(s["J"])("lb-spinner");return Object(s["D"])(),Object(s["j"])("button",{class:Object(s["w"])(r.setStyleClass),style:Object(s["x"])(`font-size: ${this.size}rem;`),disabled:n.disabled||n.loading,tabindex:n.disabled||n.loading?-1:1,onClick:t[0]||(t[0]=(...e)=>r.onClick&&r.onClick(...e))},[Object(s["k"])("div",Vp,[this.icon?(Object(s["D"])(),Object(s["h"])(o,{key:0,icon:this.icon,size:this.size},null,8,["icon","size"])):Object(s["i"])("",!0),Object(s["I"])(e.$slots,"default")]),n.loading?(Object(s["D"])(),Object(s["h"])(c,{key:0,size:"20px",thickness:"3px",variant:r.setSpinnerVariant},null,8,["variant"])):Object(s["i"])("",!0)],14,Gp)}var Ap={name:"LbButton",props:{variant:{type:String,default:"default",validator(e){return["default","positive","negative","outline"].includes(e)}},size:{type:Number,required:!1,default:null},icon:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},loading:{type:Boolean,default:!1}},emits:["click"],computed:{setStyleClass(){return this.disabled?"button button--disabled":this.loading?`button button--${this.variant} button--loading`:"button button--"+this.variant},setSpinnerVariant(){return"outline"===this.variant?"dark":""}},methods:{onClick(){this.loading||this.disabled||this.$emit("click")}}};n("a54b");const Hp=k()(Ap,[["render",Fp]]);var Yp=Hp;function Kp(e,t,n,i,a,r){return Object(s["D"])(),Object(s["j"])("div",{class:Object(s["w"])(["lb-spinner",r.setVariant])},[Object(s["k"])("div",{class:"lb-spinner__loader",style:Object(s["x"])(r.setStyle)},null,4)],2)}var Wp={name:"LbSpinner",props:{size:{type:String,default:"35px"},thickness:{type:String,default:"5px"},variant:{type:String,default:""}},computed:{setStyle(){return`width: ${this.size}; height: ${this.size}; border-width: ${this.thickness};`},setVariant(){return this.variant.length>0?"lb-spinner--"+this.variant:""}}};n("402b");const Qp=k()(Wp,[["render",Kp]]);var Xp=Qp;const Zp=Object(s["g"])(T).use(X).use(Jp);Zp.component("Icon",Rp),Zp.component("LbButton",Yp),Zp.component("LbPopupBox",li),Zp.component("LbSpinner",Xp),Zp.mount("#app")},5765:function(e,t,n){"use strict";n("391b")},5856:function(e,t,n){},"58e7":function(e,t,n){"use strict";n("6dfc")},"5a24":function(e,t,n){"use strict";n("435e")},"5c88":function(e,t,n){"use strict";n("e9ca")},"5d4e":function(e,t,n){},"5ea1":function(e,t,n){"use strict";n("7493")},"5fd2":function(e,t,n){},6516:function(e,t,n){"use strict";n("296d")},6677:function(e,t,n){"use strict";n("dbdb")},"67cd":function(e,t,n){},"683a":function(e,t,n){},"6b23":function(e,t,n){"use strict";n("bce0")},"6dd5":function(e,t,n){},"6de2":function(e,t,n){"use strict";n("2400")},"6dfc":function(e,t,n){},"6f37":function(e,t,n){"use strict";n("84ea")},7267:function(e,t,n){"use strict";n("b5db")},7493:function(e,t,n){},"776c":function(e,t,n){"use strict";n("67cd")},"7a10":function(e,t,n){"use strict";n("1484")},"7c9b":function(e,t,n){"use strict";n("fc9d")},"84ea":function(e,t,n){},"85c8":function(e,t,n){"use strict";n("f64e")},8641:function(e,t,n){"use strict";n("b423")},8815:function(e,t,n){"use strict";n("a595")},8931:function(e,t,n){"use strict";n("c249")},"8a35":function(e,t,n){},"8c2e":function(e,t,n){"use strict";n("e7b6")},"8c74":function(e,t,n){"use strict";n("2d83")},"8fb3":function(e,t,n){"use strict";n("ccaa")},"915e":function(e,t,n){},"91d4":function(e,t,n){"use strict";n("8a35")},"996a":function(e,t,n){},"9bb8":function(e,t,n){"use strict";n("3bdf")},"9be3":function(e,t,n){},"9ca3":function(e,t,n){"use strict";n("cadb")},"9e63":function(e,t,n){"use strict";n("23b8")},"9f73":function(e,t,n){},a2e7:function(e,t,n){"use strict";n("f8ca")},a3a9:function(e,t,n){},a54b:function(e,t,n){"use strict";n("1d96")},a595:function(e,t,n){},a674:function(e,t,n){e.exports=n.p+"img/edit-universe-title-1.44022736.jpg"},a7db:function(e,t,n){},a7f5:function(e,t,n){},a853:function(e,t,n){"use strict";n("33a6")},b10b:function(e,t,n){"use strict";n("a7f5")},b199:function(e,t,n){"use strict";n("f233")},b34f:function(e,t,n){e.exports=n.p+"img/edit-universe-title-2.a14da9dd.jpg"},b423:function(e,t,n){},b5db:function(e,t,n){},b649:function(e,t,n){"use strict";n("9be3")},bb9c:function(e,t,n){},bce0:function(e,t,n){},c178:function(e,t,n){e.exports=n.p+"img/search-elements-1.016ec7aa.jpg"},c20b:function(e,t,n){},c249:function(e,t,n){},c446:function(e,t,n){"use strict";n("4ac7")},c485:function(e,t,n){"use strict";n("e9cc")},c8be:function(e,t,n){"use strict";n("4650")},c922:function(e,t,n){},c975:function(e,t,n){"use strict";n("11d2")},c9fa:function(e,t,n){"use strict";n("f321")},cadb:function(e,t,n){},cbeb:function(e,t,n){},ccaa:function(e,t,n){},ccbd:function(e,t,n){"use strict";n("c20b")},cfe2:function(e,t,n){"use strict";n("a7db")},d541:function(e,t,n){},d987:function(e,t,n){"use strict";n("3402")},dab6:function(e,t,n){},dbdb:function(e,t,n){},e7b6:function(e,t,n){},e9ca:function(e,t,n){},e9cc:function(e,t,n){},ea33:function(e,t,n){},f194:function(e,t,n){"use strict";n("915e")},f233:function(e,t,n){},f321:function(e,t,n){},f64e:function(e,t,n){},f7bb:function(e,t,n){},f8ca:function(e,t,n){},f9d1:function(e,t,n){"use strict";n("4192")},fc9d:function(e,t,n){},ffae:function(e,t,n){"use strict";n("1cd1")}});
//# sourceMappingURL=app.9d5884d3.js.map